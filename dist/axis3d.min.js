!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).axis3d=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(a,u){if(!n[a]){if(!t[a]){var f="function"==typeof require&&require;if(!u&&f)return f(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){var n=t[a][1][e];return i(n||e)},s,s.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Camera=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,o),(0,a.Entity)(e,t,(0,i.CameraContext)(e,t))};var r=e("../utils"),i=e("./context"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),a=e("../core")},{"../core":49,"../utils":119,"./context":4,"./defaults":8}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CameraContext=function(e,t){return(0,i.assignDefaults)(t,c),(0,s.Entity)(e,t,(0,f.Object3DContext)(e,t),(0,o.CameraInfoContext)(e,t),(0,i.isolate)((0,a.CameraViewContext)(e,t)),(0,r.CameraInverseViewContext)(e,t),(0,u.CameraEyeContext)(e,t))};var r=e("./inverse-view"),i=e("../../utils"),o=e("./info"),a=e("./view"),u=e("./eye"),f=e("../../object3d"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),s=e("../../core")},{"../../core":49,"../../object3d":89,"../../utils":119,"../defaults":8,"./eye":3,"./info":5,"./inverse-view":6,"./view":7}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(e.length!=t.length)return!0;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!0;return!1}function o(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}Object.defineProperty(n,"__esModule",{value:!0}),n.CameraEyeContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.assignDefaults)(t,c);var n=new Float32Array(3),r=new Float32Array(16);return o(n,(0,f.default)(s)),(0,u.ScopedContext)(e,t,{eye:function(e,t){var a=e.view;return a&&i(r,a)&&(o(r,a),o(n,(0,f.default)(a))),n}})};var a=e("../../utils"),u=e("../../scope"),f=r(e("eye-vector")),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),s=r(e("gl-mat4")).default.identity([])},{"../../scope":92,"../../utils":119,"../defaults":8,"eye-vector":134,"gl-mat4":163}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./inverse-view");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./view");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./eye");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})})},{"./context":2,"./eye":3,"./info":5,"./inverse-view":6,"./view":7}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.CameraInfoContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,a),(0,o.ScopedContext)(e,t,{transform:function(){return c},matrix:function(){return c},projection:function(e,n){return(0,i.pick)("projection",[n,t])||c},aspect:function(e,t){return(0,i.pick)("viewportWidth",[t,e])/(0,i.pick)("viewportHeight",[t,e])},target:function(e,n){var r=(0,i.pick)("scale",[e,n,t]),o=(0,i.pick)("target",[n,e,t]);return f.default.multiply([],o,r)},up:function(e,n){return(0,i.pick)("up",[n,e,t])},viewport:function(e,n){var r=(0,i.pick)("viewport",[n,e,t]),o=(0,i.pick)("viewportHeight",[n,e,t]),a=(0,i.pick)("viewportWidth",[n,e,t]),u=(0,i.pick)("viewportLeft",[n,e,t]),f=(0,i.pick)("viewportTop",[n,e,t]);return r||[u||0,f||0,a||0,o||0]}})};var i=e("../../utils"),o=e("../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),u=r(e("gl-mat4")),f=r(e("gl-vec3")),c=u.default.identity([])},{"../../scope":92,"../../utils":119,"../defaults":8,"gl-mat4":163,"gl-vec3":245}],6:[function(e,t,n){"use strict";function r(e,t){if(e.length!=t.length)return!0;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!0;return!1}function i(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}Object.defineProperty(n,"__esModule",{value:!0}),n.CameraInverseViewContext=function(e,t){(0,o.assignDefaults)(t,u);var n=new Float32Array(16),c=new Float32Array(16);return f.default.identity(n),(0,a.ScopedContext)(e,t,{invertedView:function(e){var t=e.view;return t&&r(c,t)&&(i(c,t),f.default.invert(n,t)),n}})};var o=e("../../utils"),a=e("../../scope"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),f=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"));f.default.identity([])},{"../../scope":92,"../../utils":119,"../defaults":8,"gl-mat4":163}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(e.length!=t.length)return!0;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!0;return!1}function o(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}Object.defineProperty(n,"__esModule",{value:!0}),n.CameraViewContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.assignDefaults)(t,f);var n=new Float32Array(16),r=new Float32Array(3),m=new Float32Array(4),h=new Float32Array(3),v=new Float32Array(3),y=new Float32Array(3);return c.default.identity(n),(0,u.ScopedContext)(e,t,{view:function(e,t){var u=!1,f=(0,a.pick)("view",[e,t]);if(f)return f;var b=(0,a.pick)("position",[e,t]),g=(0,a.pick)("rotation",[e,t]),_=(0,a.pick)("target",[e,t]),x=(0,a.pick)("scale",[e,t]),S=(0,a.pick)("up",[e,t]);return b&&g&&_&&x?(i(r,b)&&(u=!0,c.default.identity(n),c.default.translate(n,n,b),o(r,b)),(u||i(h,_)||i(y,S))&&(c.default.lookAt(n,_,b,S),o(h,_),o(y,S)),(u||i(m,g))&&(s.default.normalize(l,g),c.default.fromQuat(d,l),c.default.multiply(n,n,d),o(m,g)),(u||i(v,x))&&(c.default.scale(n,n,x),o(v,x)),n):p}})};e("../../object3d/context");var a=e("../../utils"),u=e("../../scope"),f=(e("../../core"),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))),c=r(e("gl-mat4")),s=r(e("gl-quat")),l=s.default.identity([]),d=c.default.identity([]),p=c.default.identity([])},{"../../core":49,"../../object3d/context":85,"../../scope":92,"../../utils":119,"../defaults":8,"gl-mat4":163,"gl-quat":188}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../object3d/defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});n.uniformName="camera",n.direction=[0,0,-1],n.target=[0,0,0],n.up=[0,1,0]},{"../object3d/defaults":88}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./orthographic");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./perspective");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./uniforms");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./context");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./camera");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})})},{"./camera":1,"./context":4,"./orthographic":17,"./perspective":25,"./uniforms":27}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.lookAt=function(e,t,n,o){var a=[];if(r.default.subtract(a,t,n),r.default.normalize(a,a),a.every(Boolean)){var u=r.default.dot(a,o);Math.abs(u-1)<i?r.default.scale(o,e,-1):Math.abs(u+1)<i&&r.default.copy(o,e),r.default.copy(e,a),r.default.cross(a,e,o),r.default.normalize(a,a),r.default.cross(o,a,e),r.default.normalize(o,o)}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-vec3")),i=1e-9},{"gl-vec3":245}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.assignDefaults)(t,f),(0,c.Entity)(e,t,(0,u.Object3DContext)(e,t),(0,s.CameraInfoContext)(e,t),(0,i.OrthographicCameraInfoContext)(e,t),(0,a.isolate)((0,o.OrthographicCameraViewContext)(e,t)),(0,s.CameraInverseViewContext)(e,t),(0,r.OrthographicCameraProjectionContext)(e,t),(0,s.CameraEyeContext)(e,t))};var r=e("./projection"),i=e("./info"),o=e("./view"),a=e("../../../utils"),u=e("../../../object3d"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),c=e("../../../core"),s=e("../../context")},{"../../../core":49,"../../../object3d":89,"../../../utils":119,"../../context":4,"../defaults":16,"./info":13,"./projection":14,"./view":15}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./projection");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./info");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./view");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":11,"./info":13,"./projection":14,"./view":15}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraInfoContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,a),(0,u.Entity)(e,t,(0,r.PerspectiveCameraInfoContext)(e,t),(0,o.ScopedContext)(e,{viewport:function(e,n){var r=(0,i.pick)("viewport",[n,t]),o=((0,i.pick)("viewportHeight",[n,e,t]),(0,i.pick)("viewportWidth",[n,e,t]),(0,i.pick)("near",[n,e,t]),(0,i.pick)("far",[n,e,t]));return r||[-o,-o,o,o]}}))};var r=e("../../perspective"),i=e("../../../utils"),o=e("../../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),u=e("../../../core")},{"../../../core":49,"../../../scope":92,"../../../utils":119,"../../perspective":25,"../defaults":16}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraProjectionContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,o),(0,i.ScopedContext)(e,t,{projection:function(e,n){var i=a.default.identity(u),o=(0,r.pick)("viewport",[n,e,t]),f=(0,r.pick)("near",[n,e,t]),c=(0,r.pick)("far",[n,e,t]),s=o[0],l=o[1],d=o[2],p=o[3];return a.default.ortho(i,s,d,l,p,f,c),i}})};var r=e("../../../utils"),i=e("../../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),a=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4")),u=a.default.identity([])},{"../../../scope":92,"../../../utils":119,"../defaults":16,"gl-mat4":163}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraViewContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),(0,r.PerspectiveCameraViewContext)(e,t)};var r=e("../../perspective"),i=e("../../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../../utils":119,"../../perspective":25,"../defaults":16}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});n.near=.1,n.far=100},{"../defaults":8}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./orthographic");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./context":12,"./orthographic":18}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCamera=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),(0,r.OrthographicCameraContext)(e,t)};var r=e("./context"),i=e("../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../utils":119,"./context":12,"./defaults":16}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.assignDefaults)(t,f),(0,c.Entity)(e,t,(0,u.Object3DContext)(e,t),(0,s.CameraInfoContext)(e,t),(0,i.PerspectiveCameraInfoContext)(e,t),(0,a.isolate)((0,o.PerspectiveCameraViewContext)(e,t)),(0,s.CameraInverseViewContext)(e,t),(0,r.PerspectiveCameraProjectionContext)(e,t),(0,s.CameraEyeContext)(e,t))};var r=e("./projection"),i=e("./info"),o=e("./view"),a=e("../../../utils"),u=e("../../../object3d"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),c=e("../../../core"),s=e("../../context")},{"../../../core":49,"../../../object3d":89,"../../../utils":119,"../../context":4,"../defaults":24,"./info":21,"./projection":22,"./view":23}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./projection");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./view");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":19,"./info":21,"./projection":22,"./view":23}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraInfoContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,o),(0,i.ScopedContext)(e,{direction:function(e,n){return(0,r.pick)("direction",[n,t,e])},near:function(e,n){return(0,r.pick)("near",[n,t,e])},far:function(e,n){return(0,r.pick)("far",[n,t,e])},fov:function(e,n){return(0,r.pick)("fov",[n,t,e])},up:function(e,n){return(0,r.pick)("up",[n,t,e])}})};var r=e("../../../utils"),i=e("../../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../../scope":92,"../../../utils":119,"../defaults":24}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraProjectionContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,o);var n=new Float32Array(16),u=0,f=0,c=0,s=0;return(0,i.ScopedContext)(e,t,{projection:function(e,t){if("projection"in t&&t.projection)a.default.copy(n,t.projection);else{var i=(0,r.pick)("aspect",[t,e]),o=(0,r.pick)("near",[t,e]),l=(0,r.pick)("far",[t,e]),d=(0,r.pick)("fov",[t,e]);u==i&&f==o&&c==l&&s==d||(u=i,f=o,c=l,s=d,a.default.perspective(n,d,i,o,l))}return n}})};var r=e("../../../utils"),i=e("../../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),a=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"))},{"../../../scope":92,"../../../utils":119,"../defaults":24,"gl-mat4":163}],23:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraViewContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,a),(0,o.ScopedContext)(e,t,{view:function(e,t){var n=(0,i.pick)("view",[e,t]);if(n)return n;var r=f.default.identity([]),o=[0,0,0],a=(0,i.pick)("direction",[e,t]),m=(0,i.pick)("position",[e,t]),h=(0,i.pick)("rotation",[e,t]),v=(0,i.pick)("target",[e,t]),y=(0,i.pick)("scale",[e,t]),b=(0,i.pick)("up",[e,t]);return m&&h&&v&&y?((0,u.lookAt)(a,v,m,b),c.default.add(o,m,a),s.default.normalize(l,h),f.default.fromQuat(d,l),f.default.lookAt(r,m,o,b),f.default.multiply(r,r,d),f.default.scale(r,r,y),r):p}})};var i=e("../../../utils"),o=e("../../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),u=e("../../look-at"),f=r(e("gl-mat4")),c=r(e("gl-vec3")),s=r(e("gl-quat")),l=s.default.identity([]),d=f.default.identity([]),p=f.default.identity([])},{"../../../scope":92,"../../../utils":119,"../../look-at":10,"../defaults":24,"gl-mat4":163,"gl-quat":188,"gl-vec3":245}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});n.near=.01,n.far=1e3,n.fov=60*Math.PI/180},{"../defaults":8}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./perspective");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./context":20,"./perspective":26}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCamera=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),(0,r.PerspectiveCameraContext)(e,t)};var r=e("./context"),i=e("../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../utils":119,"./context":20,"./defaults":24}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.CameraShaderUniforms=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(t,a);var n=t.uniformName;return(0,o.ShaderUniforms)(e,r({prefix:n+"."},t),{invertedView:function(e){return e.invertedView},projection:function(e){return e.projection},aspect:function(e){return e.aspect},view:function(e){return e.view},eye:function(e){return e.eye}})};var i=e("../utils"),o=e("../shader"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../shader":95,"../utils":119,"./defaults":8}],28:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":f(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":f(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Context=void 0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s="function"==typeof Symbol&&"symbol"==f(Symbol.iterator)?function(e){return void 0===e?"undefined":f(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":f(e)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=e("events"),p=r(e("defined")),m=r(e("global/document")),h=r(e("regl-combine")),v=r(e("global/window")),y=r(e("dom-events")),b=r(e("@littlstar/regl"));n.Context=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.default;if(o(this,t),null!=e&&"object"!=(void 0===e?"undefined":s(e))||Array.isArray(e))throw new TypeError("Context(): expecting object as first argument.");if(null!=n&&"function"!=typeof n)throw new TypeError("Context(): expecting function as second argument.");null==e&&(e={}),"function"!=typeof n&&(n=b.default);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(r.setMaxListeners(1/0),r._isDestroyed=!1,r._hasFocus=!1,e.regl=(0,p.default)(e.regl,e.gl||{}),e.gl&&e.gl.context&&(e.regl.gl=e.gl.context,delete e.gl.context),e.element=(0,p.default)(e.element,e.domElement),e.canvas&&"object"==s(e.canvas)?e.regl.canvas=e.canvas:e.element&&"CANVAS"==e.element.nodeName?e.regl.canvas=e.element:e.element&&e.element.nodeName?e.regl.container=e.element:"string"==typeof e.element&&(e.regl.container=e.element),n(c({pixelRatio:e.pixelRatio||v.default.devicePixelRatio||1,profile:Boolean(e.profile)},e.regl,{attributes:c({},e.regl.attributes||{}),extensions:[].concat(i(e.regl.extensions||[])),optionalExtensions:[].concat(i(t.kDefaulOptionaltExtensions),i(e.regl.optionalExtensions||[])),onDone:function(e,t){if(e)return r.emit("error",e);r._regl=h.default.wrap(t),r._isDestroyed=!1,t._gl&&t._gl.canvas?r._domElement=r._regl._gl.canvas:r._domElement=null}})),null!=r._domElement&&"undefind"!=typeof v.default&&"undefind"!=typeof m.default){var u=function(e,t,n){y.default.on(e,t,n),r.once("beforedestroy",function(){return y.default.off(e,t,n)})},f=function(e){e.target==r._domElement?r.focus():r.blur()};u(r._domElement,"blur",function(){r.blur()}),u(r._domElement,"focus",function(){r.focus()}),u(v.default,"blur",function(){r.blur()}),u(m.default,"mousedown",f),u(m.default,"touchstart",f)}return r}return u(t,d.EventEmitter),l(t,null,[{key:"kDefaulOptionaltExtensions",get:function(){return["OES_vertex_array_object","OES_texture_float"]}}]),l(t,[{key:"off",value:function(){return 2==arguments.length?this.removeListener.apply(this,arguments):this.removeAllListeners.apply(this,arguments)}},{key:"focus",value:function(){return this._hasFocus=!0,this.domElement&&this.domElement.focus(),this.emit("focus"),this}},{key:"blur",value:function(){return this._hasFocus=!1,this.domElement&&this.domElement.blur(),this.emit("blur"),this}},{key:"destroy",value:function(){return this.emit("beforedestroy"),this._regl&&"function"==typeof this._regl.destroy&&(this._regl.destroy(),delete this._regl),this._domElement&&(this._domElement.parentElement&&this._domElement.parentElement.removeChild(this._domElement),delete this._domElement),this._hasFocus=!1,this._isDestroyed=!0,this.emit("destroy"),this}},{key:"refresh",value:function(){return this.regl&&"function"==typeof this.regl._refresh&&this.regl._refresh(),this}},{key:"flush",value:function(){return this.gl&&this.gl.flush(),this}},{key:"poll",value:function(){return this.regl&&this.regl&&"function"==typeof this.regl.poll&&this.regl.poll(),this}},{key:"isDestroyed",get:function(){return Boolean(this._isDestroyed)}},{key:"hasFocus",get:function(){return Boolean(this._hasFocus)}},{key:"domElement",get:function(){return this._domElement||null}},{key:"regl",get:function(){return this._regl||null}},{key:"gl",get:function(){return this._regl&&this._regl._gl||null}}]),t}()},{"@littlstar/regl":121,defined:130,"dom-events":131,events:132,"global/document":278,"global/window":279,"regl-combine":302}],29:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=e;if(null==e&&(t=void 0),e&&"object"==(void 0===e?"undefined":f(e))){var n="number"==typeof e.length,i="function"==typeof e[Symbol.iterator];t=n&&i?[].concat(r(e)):n?Array(e.length).fill(0).map(function(t,n){return e[n]}):Object.assign({},e)}return t}function a(e,t){if(!(t in e))return Object.defineProperty(e,t,{enumerable:!0,set:function(n){e.valueState[t]=n},get:function(){var n=e.valueState,r=e.initialState;return o((0,s.default)(n[t],r[t],null))}})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.DynamicValue=void 0;var f="function"==typeof Symbol&&"symbol"==u(Symbol.iterator)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":u(e)},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){return e&&e.__esModule?e:{default:e}}(e("defined")),l=(n.DynamicValue=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(i(this,e),!t||"object"!=(void 0===t?"undefined":f(t))||Array.isArray(t))throw new TypeError("DynamicValue(): Expecting context object.");if(r&&"object"!=(void 0===r?"undefined":f(r))||Array.isArray(r))throw new TypeError("DynamicValue(): Expecting initial state to be an object.");if(o&&"object"!=(void 0===o?"undefined":f(o))||Array.isArray(o))throw new TypeError("DynamicValue(): Expecting props to be an object.");var a=function(e,t,r){return Object.defineProperty(n,e,{enumerable:!1,get:function(){return t||r}})};a("ctx",t,{}),a("valueState",{},{}),a("initialState",r,{}),this.set(o)}return c(e,null,[{key:"createCounter",value:function(){return new l}}]),c(e,[{key:"set",value:function(e,t){if(e&&"object"==(void 0===e?"undefined":f(e))&&!Array.isArray(e)&&void 0===t){var n=!0,r=!1,i=void 0;try{for(var o,u=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var c=o.value;this.set(c,e[c])}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}}else{if("string"!=typeof e&&"number"!=typeof e)throw TypeError("DynamicValue(): Attempting to set invalid key value.");if(void 0===t)throw TypeError("DynamicValue(): Attempting to set undefined value.");a(this,e),this[e]=t}return this}},{key:"unset",value:function(e){return"string"==typeof e&&e in this.valueState&&delete this.valueState[e],this}}]),e}(),function(){function e(){i(this,e),Object.defineProperties(this,{contexts:{enumerable:!1,value:new Set},map:{enumerable:!1,value:new WeakMap}})}return c(e,[{key:"setContext",value:function(e){var t=this.map.get(e)||new Set;return this.map.set(e,t),0==this.contexts.has(e)&&this.contexts.add(e),this}},{key:"getSetForContext",value:function(e){return this.setContext(e),this.map.get(e)}},{key:"addValueForContext",value:function(e,t){var n=this.getSetForContext(e);return 0==n.has(t)&&n.add(t),this}},{key:"listSetForContext",value:function(e){return[].concat(r(this.getSetForContext(e)))}},{key:"list",value:function(){return[].concat(r(this.contexts))}}]),e}())},{defined:130}],30:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function o(){return++y}function a(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=Array.isArray(t[0])?t[0]:t,{initialState:r,components:t.filter(function(e){return"function"==typeof e}).map(function(e){return"entityId"in e&&Array.isArray(e.components)?(e.initialState&&"object"==l(e.initialState)&&(0,m.default)(!0,r,e.initialState),a(r,e.components).components):e}).reduce(function(e,t){return e.concat(t)},[])}}function u(e,t,n){return e&&"object"==(void 0===e?"undefined":l(e))&&(e=Object.assign({},e,t)),"function"==typeof t?"function"==typeof n?t=t():(n=t,t={}):t&&(Array.isArray(t)?t=Object.assign([],t):"object"==(void 0===t?"undefined":l(t))&&(t=Object.assign({},t))),null==t&&(t={}),null==n&&(n=v),t&&"object"==(void 0===t?"undefined":l(t))&&!Array.isArray(t)&&(t=Object.assign({},t,e)),[t,n]}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var c=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l="function"==typeof Symbol&&"symbol"==f(Symbol.iterator)?function(e){return void 0===e?"undefined":f(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":f(e)};n.Entity=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),f=2;f<n;f++)r[f-2]=arguments[f];if(void 0===e)throw new d.MissingContextError("Entity");if(null===e||"object"!=(void 0===e?"undefined":l(e))||Array.isArray(e))throw new d.BadArgumentError(0,"ctx",e,"object");if(t)if(Array.isArray(t))r=t,t={};else if("function"==typeof t)r.unshift(t);else if("object"!=(void 0===t?"undefined":l(t)))throw new d.BadArgumentError(1,"initialState",t,"object");Array.isArray(r[0])&&(r=r[0]),t=s({},t);var m=o(),v=e.regl({context:new h(m)}),y=a(t,r),b=(0,p.combine)(e.regl,y.components);return Object.assign(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=u.apply(void 0,[t].concat(n)),a=c(o,2),f=a[0],s=a[1];return v(f,function(e,t,n){return i(e),b(t,function(e,t){return s(e,t,n)})})},{combinedComponents:b,initialState:t,components:r,entityId:m})};var d=e("../errors"),p=(e("./context"),e("regl-combine")),m=function(e){return e&&e.__esModule?e:{default:e}}(e("extend")),h=function e(t){r(this,e),Object.assign(this,{entityId:function(){return t},batchId:function(e,t,n){return i(e),n}})},v=function(){},y=0},{"../errors":53,"./context":28,extend:133,"regl-combine":302}],31:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)u(3,i.value)}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}function a(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)u(2,i.value)}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}function u(e,t){for(var n=0;n<e;++n)null==t[n]&&(t[n]=0);return t.splice(e),t}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Geometry=void 0;var c="function"==typeof Symbol&&"symbol"==f(Symbol.iterator)?function(e){return void 0===e?"undefined":f(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":f(e)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=r(e("bound-points")),d=r(e("defined")),p=r(e("array-flatten")),m=r(e("mesh-reindex")),h=r(e("unindex-mesh")),v=r(e("normals")),y=r(e("gl-vec2"));n.Geometry=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,e),null!=t&&"object"!=(void 0===t?"undefined":c(t))||Array.isArray(t))throw new TypeError("Geometry(): Expecting object as first argument.");null==t&&(t={});var n={};t.positions?n=t:"complex"in t&&(n=t.complex);var r=(0,d.default)(t.flatten,n.flatten,!1);Object.defineProperty(this,"_complex",{enumerable:!1,value:{}}),this.flatten=Boolean(r),this.complex=n||null}return s(e,[{key:"computeBoundingBox",value:function(){return this.positions?(0,l.default)(this.positions):null}},{key:"complex",get:function(){return this._complex||null},set:function(e){if(null===e&&(this._complex=null),e.complex&&(e=e.complex),e){if(e.positions&&o(e.positions),e.normals&&o(e.normals),this.flatten&&e.cells){var t=e.cells.map(function(e){return e.slice()}),n=(0,m.default)((0,h.default)(e.positions,t));try{e.normals=v.default.vertexNormals(n.cells,n.positions)}catch(e){console.warn("Geometry(): Unable to compute vertex normals.")}Object.assign(e,n)}else e.positions&&!e.cells&&Object.assign(e,(0,m.default)((0,p.default)(e.positions)));if(null==e.normals&&e.positions&&e.cells)try{e.normals=v.default.vertexNormals(e.cells,e.positions)}catch(e){console.warn("Geometry(): Unable to compute vertex normals.")}Array.isArray(e.uvs)?a(e.uvs):Array.isArray(e.positions)&&(e.uvs=e.positions.map(function(e){return y.default.normalize([],e.slice(0,2))}))}return Object.assign(this._complex,e),e}},{key:"positions",get:function(){return this.complex&&this.complex.positions||null}},{key:"normals",get:function(){return this.complex&&this.complex.normals||null}},{key:"faces",get:function(){return this.cells}},{key:"cells",get:function(){return this.complex&&this.complex.cells||null}},{key:"uvs",get:function(){return this.complex&&this.complex.uvs||null}}]),e}()},{"array-flatten":122,"bound-points":125,defined:130,"gl-vec2":215,"mesh-reindex":293,normals:295,"unindex-mesh":309}],32:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLShaderInstancedAttributes=n.WebGLShaderAttributes=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../dynamic"),s=c.DynamicValue.createCounter(),l=n.WebGLShaderAttributes=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];r(this,t),null==o?(o=n,n={}):null==n&&null==o&&(n={},o={});var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));return s.addValueForContext(e,a),a}return o(t,c.DynamicValue),f(t,null,[{key:"counter",value:function(){return s}},{key:"getTotalUniformCount",value:function(){return t.counter().list().map(function(e){return t.getContextUniformCount(e)}).reduce(function(e,t){return e+t},0)}},{key:"getContextUniformCount",value:function(e){var n=t.counter().listSetForContext(e).reduce(function(e,t){return Object.assign(e,t)},{});return Object.keys(n).length}}]),t}();n.WebGLShaderInstancedAttributes=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];r(this,t),null==o&&"object"==(void 0===n?"undefined":u(n))?(o=n,n={}):null==n&&null==o&&(n={},o={});for(var a in o)o[a]&&"object"==u(o[a])&&("object"==u(o[a].buffer)?"number"!=typeof o[a].divisor&&(o[a].divisor=1):o[a]={buffer:o[a],divisor:1});return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o))}return o(t,l),t}()},{"../dynamic":29}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./attributes");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./uniforms");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./attributes":32,"./uniforms":34}],34:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLShaderUniforms=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../dynamic"),s=c.DynamicValue.createCounter();n.WebGLShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];r(this,t),null==o&&"object"==(void 0===n?"undefined":u(n))?(o=n,n={}):null==n&&null==o&&(n={},o={}),n=Object.assign({},n),o=Object.assign({},o);var a=n.prefix,f=void 0===a?"":a;delete n.prefix;for(var c in n)f+c!=c&&(n[f+c]=n[c],delete n[c]);for(var l in o)f+l!=l&&(o[f+l]=o[l],delete o[l]);var d=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));return s.addValueForContext(e,d),d}return o(t,c.DynamicValue),f(t,null,[{key:"counter",value:function(){return s}},{key:"getTotalUniformCount",value:function(){return t.counter().list().map(function(e){return t.getContextUniformCount(e)}).reduce(function(e,t){return e+t},0)}},{key:"getContextUniformCount",value:function(e){var n=t.counter().listSetForContext(e).reduce(function(e,t){return Object.assign(e,t)},{});return Object.keys(n).length}}]),t}()},{"../dynamic":29}],35:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_CAMERA_VARIABLES\n#define GLSL_CAMERA_VARIABLES\n\n#ifndef GLSL_CAMERA_UNIFORM_VARIABLE\n#define GLSL_CAMERA_UNIFORM_VARIABLE camera\n#endif\n\n#endif\n"),r(i,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_CAMERA_UNIFORMS\n#define GLSL_CAMERA_UNIFORMS\n\n#include "./variables"\n\n#ifdef GLSL_CAMERA\nuniform Camera GLSL_CAMERA_UNIFORM_VARIABLE;\n#endif\n\n#endif\n'),r(i,t+"/camera","#define GLSLIFY 1\n#ifndef GLSL_CAMERA\n#define GLSL_CAMERA\n\nstruct Camera {\n  mat4 invertedView;\n  mat4 projection;\n  mat4 view;\n  vec3 eye;\n};\n\n#endif\n"),i))}).call(this,"/lib/core/glsl/camera")},{glslify:291}],36:[function(e,t,n){(function(t){"use strict";!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/common","#define GLSLIFY 1\n#ifndef GLSL_COMMON\n#define GLSL_COMMON 1\n\n#ifndef M_PI\n#define M_PI 3.141592653589793\n#endif\n\n#ifndef M_E\n#define M_E 2.718281828459045\n#endif\n\n#endif\n"))}).call(this,"/lib/core/glsl/common")},{glslify:291}],37:[function(e,t,n){(function(t){"use strict";!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/main",'#define GLSLIFY 1\n#ifndef GLSL_FRAGMENT_MAIN\n#define GLSL_FRAGMENT_MAIN\n\n#include "../varying/data"\n#include "../varying/read"\n\nvoid InitVarying(inout VaryingData varyingData);\nvoid BeforeMain(inout vec4 fragColor, inout VaryingData varyingData);\nvoid Main(inout vec4 fragColor, inout VaryingData data);\nvoid TransformMain(inout vec4 fragColor, inout VaryingData varyingData);\nvoid AfterMain(inout vec4 fragColor, inout VaryingData varyingData);\n\nvoid main() {\n  VaryingData varyingData = ReadVaryingData();\n  InitVarying(varyingData);\n  BeforeMain(gl_FragColor, varyingData);\n  Main(gl_FragColor, varyingData);\n  TransformMain(gl_FragColor, varyingData);\n  AfterMain(gl_FragColor, varyingData);\n}\n\n#ifdef GLSL_FRAGMENT_MAIN_BEFORE\n  void GLSL_FRAGMENT_MAIN_BEFORE(inout vec4 fragColor,\n                                 inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_FRAGMENT_MAIN_TRANSFORM\n  void GLSL_FRAGMENT_MAIN_TRANSFORM(inout vec4 fragColor,\n                                    inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_FRAGMENT_MAIN_AFTER\n  void GLSL_FRAGMENT_MAIN_AFTER(inout vec4 fragColor,\n                                inout VaryingData varyingData);\n#endif\n\nvoid BeforeMain(inout vec4 fragColor,\n                inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_BEFORE\n  GLSL_FRAGMENT_MAIN_BEFORE(fragColor, varyingData);\n#endif\n}\n\nvoid TransformMain(inout vec4 fragColor,\n                   inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_TRANSFORM\n  GLSL_FRAGMENT_MAIN_TRANSFORM(fragColor, varyingData);\n#endif\n}\n\nvoid AfterMain(inout vec4 fragColor,\n               inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_AFTER\n  GLSL_FRAGMENT_MAIN_AFTER(fragColor, varyingData);\n#endif\n}\n\nvoid InitVarying(inout VaryingData varyingData) {\n  varyingData = ReadVaryingData();\n}\n\n#endif\n'))}).call(this,"/lib/core/glsl/fragment")},{glslify:291}],38:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_FRAME_VARIABLES\n#define GLSL_FRAME_VARIABLES\n\n#ifndef GLSL_FRAME_UNIFORM_VARIABLE\n#define GLSL_FRAME_UNIFORM_VARIABLE frame\n#endif\n\n#endif\n"),r(i,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_FRAME_UNIFORMS\n#define GLSL_FRAME_UNIFORMS\n\n#include "./variables"\n\n#ifdef GLSL_FRAME\nuniform Frame GLSL_FRAME_UNIFORM_VARIABLE;\n#endif\n\n#endif\n'),r(i,t+"/frame","#define GLSLIFY 1\n#ifndef GLSL_FRAME\n#define GLSL_FRAME\n\nstruct Frame {\n  float time;\n  float tick;\n  vec2 resolution;\n};\n\n#endif\n"),i))}).call(this,"/lib/core/glsl/frame")},{glslify:291}],39:[function(e,t,n){(function(t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.time=n.mesh=n.frame=n.common=n.camera=n.vertex=n.varying=n.texture=n.fragment=n.material=void 0;var i=r(e("./material")),o=r(e("./fragment")),a=r(e("./texture")),u=r(e("./varying")),f=r(e("./vertex")),c=r(e("./camera")),s=r(e("./common")),l=r(e("./frame")),d=r(e("./mesh")),p=r(e("./time"));n.material=i,n.fragment=o,n.texture=a,n.varying=u,n.vertex=f,n.camera=c,n.common=s,n.frame=l,n.mesh=d,n.time=p;for(var m in n)for(var h in n[m]){var v=h.replace(t+"/"+m,"");n[m][v]=n[m][h],delete n[m][h]}}).call(this,"/lib/core/glsl")},{"./camera":35,"./common":36,"./fragment":37,"./frame":38,"./material":40,"./mesh":41,"./texture":42,"./time":43,"./varying":45,"./vertex":48}],40:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/fragment/main",'#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_FRAGMENT_MAIN\n#define GLSL_MATERIAL_FRAGMENT_MAIN\n\n#include "../material"\n#include "../uniforms"\n#include "../variables"\n\n#include "../../mesh/fragment"\n#include "../../fragment/main"\n#include "../../varying/read"\n\nvoid Main(inout vec4 fragColor, inout VaryingData data) {\n  fragColor = MeshFragment(\n      GLSL_MATERIAL_UNIFORM_VARIABLE.color,\n      GLSL_MATERIAL_UNIFORM_VARIABLE.opacity);\n}\n\n#endif\n'),r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_VARIABLES\n#define GLSL_MATERIAL_VARIABLES\n\n#ifndef GLSL_MATERIAL_UNIFORM_VARIABLE\n#define GLSL_MATERIAL_UNIFORM_VARIABLE material\n#endif\n\n#endif\n"),r(i,t+"/material","#define GLSLIFY 1\n#ifndef GLSL_MATERIAL\n#define GLSL_MATERIAL\n\nstruct Material {\n  vec3 color;\n  float opacity;\n};\n\n#endif\n"),r(i,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_UNIFORMS\n#define GLSL_MATERIAL_UNIFORMS\n\n#include "./variables"\n#include "./material"\n\nuniform Material GLSL_MATERIAL_UNIFORM_VARIABLE;\n\n#endif\n'),i))}).call(this,"/lib/core/glsl/material")},{glslify:291}],41:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/fragment/main",'#define GLSLIFY 1\n#ifndef GLSL_MESH_FRAGMENT_MAIN\n#define GLSL_MESH_FRAGMENT_MAIN\n\n#include "../mesh"\n#include "../uniforms"\n#include "../variables"\n\n#ifdef GLSL_MESH_HAS_POSITION\n#include "../../varying/position"\n#endif\n\n#ifdef GLSL_MESH_HAS_NORMAL\n#include "../../varying/normal"\n#endif\n\n#include "../../mesh/fragment"\n#include "../../fragment/main"\n#include "../../varying/read"\n\nvoid Main(inout vec4 fragColor, inout VaryingData data) {\n#ifdef GLSL_MESH_HAS_POSITION\n  fragColor = MeshFragment(data.position);\n#endif\n\n#ifdef GLSL_MESH_HAS_NORMAL\n  fragColor = MeshFragment(data.normal);\n#endif\n\n}\n\n#endif\n'),r(i,t+"/vertex/main",'#define GLSLIFY 1\n#ifndef GLSL_MESH_VERTEX_MAIN\n#define GLSL_MESH_VERTEX_MAIN\n\n#include "../variables"\n#include "../uniforms"\n#include "../vertex"\n#include "../mesh"\n\n#include "../../camera/camera"\n#include "../../camera/uniforms"\n\n#ifdef GLSL_MESH_HAS_POSITION\n#include "../../vertex/attributes/position"\n#include "../../varying/position"\n#endif\n\n#ifdef GLSL_MESH_HAS_NORMAL\n#include "../../vertex/attributes/normal"\n#include "../../varying/normal"\n#endif\n\n#ifdef GLSL_MESH_HAS_UV\n#include "../../vertex/attributes/uv"\n#include "../../varying/uv"\n#endif\n\n#include "../../varying/emit"\n#include "../../vertex/main"\n\nvoid Main(inout vec4 vertexPosition, inout VaryingData data) {\n#ifdef GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE\n  vertexPosition = MeshVertex(\n      GLSL_CAMERA_UNIFORM_VARIABLE.projection,\n      GLSL_CAMERA_UNIFORM_VARIABLE.view,\n      GLSL_MESH_UNIFORM_VARIABLE.model,\n      GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE);\n#endif\n}\n\n#endif\n'),r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_MESH_VARIABLES\n#define GLSL_MESH_VARIABLES\n\n#ifndef GLSL_MESH_UNIFORM_VARIABLE\n#define GLSL_MESH_UNIFORM_VARIABLE mesh\n#endif\n\n#endif\n"),r(i,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_MESH_UNIFORMS\n#define GLSL_MESH_UNIFORMS\n\n#include "./variables"\n#include "./mesh"\n\nuniform Mesh GLSL_MESH_UNIFORM_VARIABLE;\n\n#endif\n'),r(i,t+"/fragment","#define GLSLIFY 1\n#ifndef GLSL_MESH_FRAGMENT\n#define GLSL_MESH_FRAGMENT\n\n#ifndef GLSL_MESH_FRAGMENT_DEFAULT_COLOR\n#define GLSL_MESH_FRAGMENT_DEFAULT_COLOR vec4(0.25882352941176473, 0.5254901960784314, 0.9568627450980393, 1.0)\n#endif\n\nvec4 MeshFragment(void) {\n  return vec4(GLSL_MESH_FRAGMENT_DEFAULT_COLOR);\n}\n\nvec4 MeshFragment(vec4 color) {\n  return color;\n}\n\nvec4 MeshFragment(float r, float g, float b, float a) {\n  return MeshFragment(vec4(r, g, b, a));\n}\n\nvec4 MeshFragment(float r, float g, float b) {\n  return MeshFragment(r, g, b, 1.0);\n}\n\nvec4 MeshFragment(float c) {\n  return MeshFragment(c, c, c, 1.0);\n}\n\nvec4 MeshFragment(vec3 color, float opacity) {\n  return MeshFragment(vec4(color, opacity));\n}\n\nvec4 MeshFragment(vec3 color) {\n  return MeshFragment(color, 1.0);\n}\n\n#endif\n"),r(i,t+"/vertex","#define GLSLIFY 1\n#ifndef GLSL_MESH_VERTEX\n#define GLSL_MESH_VERTEX\n\n#ifndef GLSL_MESH_VERTEX_DEFAULT_POSITION\n#define GLSL_MESH_VERTEX_DEFAULT_POSITION vec4(0.0, 0.0, 0.0, 1.0)\n#endif\n\nvec4 MeshVertex(void) {\n  return vec4(GLSL_MESH_VERTEX_DEFAULT_POSITION);\n}\n\nvec4 MeshVertex(vec4 position) {\n  return position;\n}\n\nvec4 MeshVertex(mat4 transform, vec4 position) {\n  return MeshVertex(transform * position);\n}\n\nvec4 MeshVertex(mat4 transform, vec3 position) {\n  return MeshVertex(transform, vec4(position, 1.0));\n}\n\nvec4 MeshVertex(mat4 transform, mat4 model, vec4 position) {\n  return MeshVertex(transform * model * position);\n}\n\nvec4 MeshVertex(mat4 transform, mat4 model, vec3 position) {\n  return MeshVertex(transform, model, vec4(position, 1.0));\n}\n\nvec4 MeshVertex(mat4 projection, mat4 view, mat4 model, vec4 position) {\n  return MeshVertex(projection * view * model, position);\n}\n\nvec4 MeshVertex(mat4 projection, mat4 view, mat4 model, vec3 position) {\n  return MeshVertex(projection, view, model, vec4(position, 1.0));\n}\n\n#endif\n"),r(i,t+"/mesh","#define GLSLIFY 1\n#ifndef GLSL_MESH\n#define GLSL_MESH\n\nstruct Mesh {\n  mat4 model;\n  mat3 modelNormal;\n};\n\n#endif\n"),i))}).call(this,"/lib/core/glsl/mesh")},{glslify:291}],42:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_VARIABLES\n#define GLSL_TEXTURE_VARIABLES\n\n#ifndef GLSL_TEXTURE_2D_SAMPLER_VARIABLE\n#define GLSL_TEXTURE_2D_SAMPLER_VARIABLE tex2d\n#endif\n\n#ifndef GLSL_TEXTURE_2D_RESOLUTION_VARIABLE\n#define GLSL_TEXTURE_2D_RESOLUTION_VARIABLE tex2dResolution\n#endif\n\n#ifndef GLSL_TEXTURE_CUBE_SAMPLER_VARIABLE\n#define GLSL_TEXTURE_CUBE_SAMPLER_VARIABLE texCube\n#endif\n\n#ifndef GLSL_TEXTURE_CUBE_RESOLUTION_VARIABLE\n#define GLSL_TEXTURE_CUBE_RESOLUTION_VARIABLE texCubeResolution\n#endif\n\n#endif\n"),r(i,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_UNIFORMS\n#define GLSL_TEXTURE_UNIFORMS\n\n#include "./variables"\n\n#ifdef GLSL_TEXTURE_2D\nuniform sampler2D GLSL_TEXTURE_2D_SAMPLER_VARIABLE;\nuniform vec2 GLSL_TEXTURE_2D_RESOLUTION_VARIABLE;\n#endif\n\n#ifdef GLSL_TEXTURE_CUBE\nuniform samplerCube GLSL_TEXTURE_CUBE_SAMPLER_VARIABLE;\nuniform vec2 GLSL_TEXTURE_CUBE_RESOLUTION_VARIABLE;\n#endif\n\n#endif\n'),r(i,t+"/cube","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_CUBE\n#define GLSL_TEXTURE_CUBE\n\n#endif\n"),r(i,t+"/2d","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_2D\n#define GLSL_TEXTURE_2D\n\n#endif\n"),i))}).call(this,"/lib/core/glsl/texture")},{glslify:291}],43:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_TIME_VARIABLES\n#define GLSL_TIME_VARIABLES\n\n#ifndef GLSL_TIME_UNIFORM_VARIABLE\n#define GLSL_TIME_UNIFORM_VARIABLE time\n#endif\n\n#endif\n"),r(i,t+"/time",'#define GLSLIFY 1\n#ifndef GLSL_TIME\n#define GLSL_TIME\n\n#include "../frame/frame"\n#include "../frame/uniforms"\n#include "../frame/variables"\n\nfloat GetTime() {\n  return GLSL_FRAME_UNIFORM_VARIABLE.time;\n}\n\n#endif\n'),i))}).call(this,"/lib/core/glsl/time")},{glslify:291}],44:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_POSITION\n#define GLSL_VARYING_EMIT_POSITION\n#ifdef GLSL_VARYING_POSITION\n\n#include "../variables"\n\nvoid EmitVaryingLocalPosition(vec3 position) {\n  GLSL_VARYING_LOCAL_POSITION_VARIABLE = position;\n}\n\nvoid EmitVaryingPosition(mat4 model, vec3 position) {\n  vec4 worldPosition = model * vec4(position, 1.0);\n  GLSL_VARYING_POSITION_VARIABLE = worldPosition.xyz;\n}\n\nvoid EmitVaryingPositions(mat4 model, vec3 position) {\n  EmitVaryingPosition(model, position);\n  EmitVaryingLocalPosition(position);\n}\n\n#endif\n#endif\n'),r(i,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_NORMAL\n#define GLSL_VARYING_EMIT_NORMAL\n#ifdef GLSL_VARYING_NORMAL\n\n#include "../variables"\n\nvoid EmitVaryingLocalNormal(vec3 normal) {\n  GLSL_VARYING_LOCAL_NORMAL_VARIABLE = normalize(normal);\n}\n\nvoid EmitVaryingNormal(mat3 modelNormal, vec3 normal) {\n  GLSL_VARYING_NORMAL_VARIABLE = normalize(modelNormal * normal);\n}\n\nvoid EmitVaryingNormals(mat3 modelNormal, vec3 normal) {\n  EmitVaryingNormal(modelNormal, normal);\n  EmitVaryingLocalNormal(normal);\n}\n\n#endif\n#endif\n'),r(i,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_COLOR\n#define GLSL_VARYING_EMIT_COLOR\n#ifdef GLSL_VARYING_COLOR\n\n#include "../variables"\n\nvoid EmitVaryingColor(vec4 color) {\n  GLSL_VARYING_COLOR_VARIABLE = color;\n}\n\nvoid EmitVaryingColor(vec3 color) {\n  EmitVaryingColor(vec4(color, 1.0));\n}\n\nvoid EmitVaryingColors(vec4 color) {\n  EmitVaryingColor(color);\n}\n\nvoid EmitVaryingColors(vec3 color) {\n  EmitVaryingColors(vec4(color, 1.0));\n}\n\n#endif\n#endif\n'),r(i,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_UV\n#define GLSL_VARYING_EMIT_UV\n#ifdef GLSL_VARYING_UV\n\n#include "../variables"\n\nvoid EmitVaryingUv(vec2 uv) {\n  GLSL_VARYING_UV_VARIABLE = uv;\n}\n\nvoid EmitVaryingUvs(vec2 uv) {\n  EmitVaryingUv(uv);\n}\n\n#endif\n#endif\n'),i))}).call(this,"/lib/core/glsl/varying/emit")},{glslify:291}],45:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,o({},e("./emit"),e("./read"),(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_VARYING_VARIABLES\n#define GLSL_VARYING_VARIABLES\n\n#ifndef GLSL_VARYING_COLOR_VARIABLE\n#define GLSL_VARYING_COLOR_VARIABLE vColor\n#endif\n\n#ifndef GLSL_VARYING_POSITION_VARIABLE\n#define GLSL_VARYING_POSITION_VARIABLE vPosition\n#endif\n\n#ifndef GLSL_VARYING_LOCAL_POSITION_VARIABLE\n#define GLSL_VARYING_LOCAL_POSITION_VARIABLE vLocalPosition\n#endif\n\n#ifndef GLSL_VARYING_NORMAL_VARIABLE\n#define GLSL_VARYING_NORMAL_VARIABLE vNormal\n#endif\n\n#ifndef GLSL_VARYING_LOCAL_NORMAL_VARIABLE\n#define GLSL_VARYING_LOCAL_NORMAL_VARIABLE vLocalNormal\n#endif\n\n#ifndef GLSL_VARYING_UV_VARIABLE\n#define GLSL_VARYING_UV_VARIABLE vUv\n#endif\n\n#endif\n"),r(i,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_POSITION\n#define GLSL_VARYING_POSITION\n\n#include "./variables"\n\nvarying vec3 GLSL_VARYING_LOCAL_POSITION_VARIABLE;\nvarying vec3 GLSL_VARYING_POSITION_VARIABLE;\n\n#endif\n'),r(i,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_NORMAL\n#define GLSL_VARYING_NORMAL\n\n#include "./variables"\n\nvarying vec3 GLSL_VARYING_LOCAL_NORMAL_VARIABLE;\nvarying vec3 GLSL_VARYING_NORMAL_VARIABLE;\n\n#endif\n'),r(i,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_COLOR\n#define GLSL_VARYING_COLOR\n\n#include "./variables"\n\nvarying vec4 GLSL_VARYING_COLOR_VARIABLE;\n\n#endif\n'),r(i,t+"/data","#define GLSLIFY 1\n#ifndef GLSL_VARYING_DATA\n#define GLSL_VARYING_DATA\n\nstruct VaryingData {\n  // exported\n  vec3 localPosition;\n  vec3 localNormal;\n  vec3 position;\n  vec3 normal;\n  vec4 color;\n  vec2 uv;\n\n  // private\n  mat3 modelNormal;\n  mat4 model;\n};\n\nVaryingData CreateVaryingData() {\n  VaryingData data;\n  data.localPosition = vec3(0.0);\n  data.localNormal = vec3(0.0);\n  data.position = vec3(0.0);\n  data.normal = vec3(0.0);\n  data.color = vec4(0.0);\n  data.uv = vec2(0.0);\n\n  data.modelNormal = mat3(1.0);\n  data.model = mat4(1.0);\n  return data;\n}\n\n#endif\n"),r(i,t+"/emit",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT\n#define GLSL_VARYING_EMIT\n\n#include "./emit/position"\n#include "./emit/normal"\n#include "./emit/color"\n#include "./emit/uv"\n#include "./data"\n\nvoid EmitVaryingData(const in VaryingData data) {\n#if defined(GLSL_VARYING_POSITION) && defined(GLSL_VARYING_EMIT_POSITION)\n  EmitVaryingPositions(data.model, data.position);\n#endif\n\n#if defined(GLSL_VARYING_NORMAL) && defined(GLSL_VARYING_EMIT_NORMAL)\n  EmitVaryingNormals(data.modelNormal, data.normal);\n#endif\n\n#if defined(GLSL_VARYING_COLOR) && defined(GLSL_VARYING_EMIT_COLOR)\n  EmitVaryingColors(data.color);\n#endif\n\n#if defined(GLSL_VARYING_UV) && defined(GLSL_VARYING_EMIT_UV)\n  EmitVaryingUvs(data.uv);\n#endif\n}\n\n#endif\n'),r(i,t+"/read",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ\n#define GLSL_VARYING_READ\n\n#include "./read/position"\n#include "./read/normal"\n#include "./read/color"\n#include "./read/uv"\n#include "./data"\n\nVaryingData ReadVaryingData() {\n  VaryingData data = CreateVaryingData();\n#if defined(GLSL_VARYING_POSITION) && defined(GLSL_VARYING_READ_POSITION)\n  data.localPosition = ReadVaryingLocalPosition();\n  data.position = ReadVaryingPosition();\n#endif\n\n#if defined(GLSL_VARYING_NORMAL) && defined(GLSL_VARYING_READ_NORMAL)\n  data.localNormal = ReadVaryingLocalNormal();\n  data.normal = ReadVaryingNormal();\n#endif\n\n#if defined(GLSL_VARYING_COLOR) && defined(GLSL_VARYING_READ_COLOR)\n  data.color = ReadVaryingColor();\n#endif\n\n#if defined(GLSL_VARYING_UV) && defined(GLSL_VARYING_READ_UV)\n  data.uv = ReadVaryingUv();\n#endif\n  return data;\n}\n\n#endif\n'),r(i,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_UV\n#define GLSL_VARYING_UV\n\n#include "./variables"\n\nvarying vec2 GLSL_VARYING_UV_VARIABLE;\n\n#endif\n'),i)))}).call(this,"/lib/core/glsl/varying")},{"./emit":44,"./read":46,glslify:291}],46:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_POSITION\n#define GLSL_VARYING_READ_POSITION\n#ifdef GLSL_VARYING_POSITION\n\n#include "../variables"\n\nvec3 ReadVaryingLocalPosition() {\n  return vec3(GLSL_VARYING_LOCAL_POSITION_VARIABLE);\n}\n\nvec3 ReadVaryingPosition() {\n  return vec3(GLSL_VARYING_POSITION_VARIABLE);\n}\n\n#endif\n#endif\n'),r(i,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_NORMAL\n#define GLSL_VARYING_READ_NORMAL\n#ifdef GLSL_VARYING_NORMAL\n\n#include "../variables"\n\nvec3 ReadVaryingLocalNormal() {\n  return vec3(GLSL_VARYING_LOCAL_NORMAL_VARIABLE);\n}\n\nvec3 ReadVaryingNormal() {\n  return vec3(GLSL_VARYING_NORMAL_VARIABLE);\n}\n\n#endif\n#endif\n'),r(i,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_COLOR\n#define GLSL_VARYING_READ_COLOR\n#ifdef GLSL_VARYING_COLOR\n\n#include "../variables"\n\nvec4 ReadVaryingColor() {\n  return vec4(GLSL_VARYING_COLOR_VARIABLE);\n}\n\n#endif\n#endif\n'),r(i,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_UV\n#define GLSL_VARYING_READ_UV\n#ifdef GLSL_VARYING_UV\n\n#include "../variables"\n\nvec2 ReadVaryingUv() {\n  return vec2(GLSL_VARYING_UV_VARIABLE);\n}\n\n#endif\n#endif\n'),i))}).call(this,"/lib/core/glsl/varying/read")},{glslify:291}],47:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(i={},r(i,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_VARIABLES\n#define GLSL_VERTEX_ATTRIBUTES_VARIABLES\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE position\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE normal\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE color\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE uv\n#endif\n\n#endif\n"),r(i,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_POSITION\n#define GLSL_VERTEX_ATTRIBUTES_POSITION\n\n#include "./variables"\n\nattribute vec3 GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE;\n\n#endif\n'),r(i,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_NORMAL\n#define GLSL_VERTEX_ATTRIBUTES_NORMAL\n\n#include "./variables"\n\nattribute vec3 GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE;\n\n#endif\n'),r(i,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_COLOR\n#define GLSL_VERTEX_ATTRIBUTES_COLOR\n\n#include "./variables"\n\nattribute vec4 GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE;\n\n#endif\n'),r(i,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_UV\n#define GLSL_VERTEX_ATTRIBUTES_UV\n\n#include "./variables"\n\nattribute vec2 GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE;\n\n#endif\n'),i))}).call(this,"/lib/core/glsl/vertex/attributes")},{glslify:291}],48:[function(e,t,n){(function(t){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,r({},e("./attributes"),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/main",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_MAIN\n#define GLSL_VERTEX_MAIN\n\n#include "../varying/data"\n\nvoid InitVarying(inout VaryingData varyingData);\nvoid BeforeMain(inout vec4 vertexPosition, inout VaryingData varyingData);\nvoid Main(inout vec4 vertexPosition, inout VaryingData data);\nvoid TransformMain(inout vec4 vertexPosition, inout VaryingData varyingData);\nvoid AfterMain(inout vec4 vertexPosition, inout VaryingData varyingData);\n\nvoid main() {\n  VaryingData varyingData = CreateVaryingData();\n  InitVarying(varyingData);\n  gl_Position = vec4(vec3(0.0), 1.0);\n  BeforeMain(gl_Position, varyingData);\n  Main(gl_Position, varyingData);\n  TransformMain(gl_Position, varyingData);\n#ifdef GLSL_VARYING_EMIT\n  EmitVaryingData(varyingData);\n#endif\n  AfterMain(gl_Position, varyingData);\n}\n\n#ifdef GLSL_VERTEX_MAIN_BEFORE\n  void GLSL_VERTEX_MAIN_BEFORE(inout vec4 vertexPosition,\n                               inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_VERTEX_MAIN_TRANSFORM\n  void GLSL_VERTEX_MAIN_TRANSFORM(inout vec4 vertexPosition,\n                                  inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_VERTEX_MAIN_AFTER\n  void GLSL_VERTEX_MAIN_AFTER(inout vec4 vertexPosition,\n                              inout VaryingData varyingData);\n#endif\n\nvoid BeforeMain(inout vec4 vertexPosition,\n                inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_BEFORE\n  GLSL_VERTEX_MAIN_BEFORE(vertexPosition, varyingData);\n#endif\n}\n\nvoid TransformMain(inout vec4 vertexPosition,\n                   inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_TRANSFORM\n  GLSL_VERTEX_MAIN_TRANSFORM(vertexPosition, varyingData);\n#endif\n}\n\nvoid AfterMain(inout vec4 vertexPosition,\n               inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_AFTER\n  GLSL_VERTEX_MAIN_AFTER(vertexPosition, varyingData);\n#endif\n}\n\nvoid InitVarying(inout VaryingData varyingData) {\n  #ifdef GLSL_VERTEX_ATTRIBUTES_POSITION\n    varyingData.position = position;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_NORMAL\n    varyingData.normal = normal;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_COLOR\n    varyingData.color = color;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_UV\n    varyingData.uv = uv;\n  #endif\n\n  #if defined(GLSL_MESH) && defined(GLSL_MESH_UNIFORMS)\n    varyingData.modelNormal = mesh.modelNormal;\n    varyingData.model = mesh.model;\n  #endif\n}\n\n#endif\n')))}).call(this,"/lib/core/glsl/vertex")},{"./attributes":47,glslify:291}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.libglsl=void 0;var r=e("./shaderlib");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./geometry");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./dynamic");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./context");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./entity");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var f=e("./gl");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return f[e]}})});var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./glsl"));n.libglsl=c},{"./context":28,"./dynamic":29,"./entity":30,"./geometry":31,"./gl":33,"./glsl":39,"./shaderlib":50}],50:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderLibPreprocessor=n.ShaderLib=n.kDefaultShaderName=n.kDefaultShaderLibVersion=n.kDefaultShaderLibPrecision=void 0;var a=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="function"==typeof Symbol&&"symbol"==o(Symbol.iterator)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":o(e)},f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./dynamic"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./glsl")),d=e("path"),p=(r(e("glsl-token-defines")),r(e("glsl-token-string"))),m=r(e("glsl-inject-defines")),h=r(e("glsl-tokenizer")),v=r(e("prepr")),y=r(e("defined")),b=r(e("string-hash")),g="preprocessor",_="block-comment",x="line-comment",S=n.kDefaultShaderLibPrecision="mediump float",A=n.kDefaultShaderLibVersion="100",O=n.kDefaultShaderName="<anonymous>",E=(n.ShaderLib=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.preprocessor,r=void 0===n?void 0:n,o=t.middleware,a=void 0===o?[]:o,u=t.precision,c=void 0===u?S:u,d=t.version,p=void 0===d?A:d,m=t.defines,h=void 0===m?{}:m,v=t.glsl;i(this,e),this.cache=new s.DynamicValue(this),this.store=new s.DynamicValue(this),this.version=(0,y.default)(p||A),this.precision=(0,y.default)(c,S),this.middleware=(0,y.default)(a,[]),this.preprocessor=(0,y.default)(r,new E(this)),this.preprocessor.define(h),this.add(f({},l,v))}return c(e,null,[{key:"defaults",value:function(){return{precision:S,shaderName:O,version:A,defines:{},name:O}}}]),c(e,[{key:"define",value:function(e,t){return this.preprocessor.define(e,t)}},{key:"injectShaderNameDefine",value:function(e,t){var n=/\s?#ifndef SHADER_NAME\s?\n#define SHADER_NAME\s?.*\n#endif\n?$/g;return String(t).replace(n,"")}},{key:"injectShaderPrecision",value:function(e){var t=this.precision,n="precision "+(void 0===t?S:t)+";",r=/[\s|\t]?precision\s+([a-z]+)\s+([a-z|A-Z]+)[\s+]?;[\s|\t|\r]?/g;return e=e.replace(n,"").replace(r,""),n+"\n"+e}},{key:"add",value:function(e,t){var n=this;return"string"==typeof e&&"string"==typeof t?(e=e.replace(/[\/]+/g,"/"),this.store.set(e,t)):e&&"object"==(void 0===e?"undefined":u(e))&&function e(t,r){for(var i in r)t.push(i),"object"==u(r[i])?e(t,r[i]):n.add(t.join("/"),r[i]),t.pop()}([],e),this}},{key:"get",value:function(e){return"string"==typeof e&&"string"==typeof this.store[e]?this.compile(e,this.store[e]):null}},{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"./";return t=(0,d.resolve)("/",t),e=e.replace((0,d.extname)(e),""),e=(0,d.resolve)(t,e).slice(1)}},{key:"hash",value:function(e){return"string"==typeof e?(0,b.default)(e):null}},{key:"isCached",value:function(e){return"string"==typeof this.cache[this.hash(e)||""]}},{key:"preprocess",value:function(e){var t=this.defines;return e=(0,v.default)(e,t),e=e.split("\n").filter(function(e){return 0==/^\s*$/.test(e)}).join("\n")}},{key:"compile",value:function(e,t){if(!t&&e&&(t=e,e=null),e||(e=O),!t)return null;var n=this.hash(t);return this.cache[n]?this.cache[n]:(t=this.injectShaderNameDefine(e,t),t=this.preprocessor.process(e,t),t=this.injectShaderPrecision(t),t=t.split("\n").filter(function(e){return e.length}).map(function(e){return 1==e.length?e+"\n":e}).join("\n")+"\n",this.cache.set(n,t),t)}},{key:"use",value:function(e){return"function"==typeof e&&this.middleware.push(e),this}},{key:"defines",get:function(){var e=(this.preprocessor||{}).defines;return void 0===e?null:e}}]),e}(),n.ShaderLibPreprocessor=function(){function e(t){i(this,e),this.defines=new s.DynamicValue(this),this.shaderLib=t,this.middleware=[]}return c(e,[{key:"define",value:function(e,t){var n=this;return"object"==(void 0===e?"undefined":u(e))?Object.keys(e).map(function(t){return n.define(t,e[t])}).some(function(e){return!0===e}):"string"==typeof e&&(!0===t?t=1:!1===t&&(t=0),null!=t)&&(t=String(t))!=this.defines[e]&&(this.defines.set(e,t),!0)}},{key:"undefine",value:function(e){return this.defines.unset(e),this}},{key:"process",value:function(e,t){function n(e,t,r){var i=(0,h.default)(e,{version:l}),u=!0,f=!1,c=void 0;try{for(var s,d=i[Symbol.iterator]();!(u=(s=d.next()).done);u=!0)!function(){var e=s.value,i=function(){return t.push(e)};switch(e.type){case _:case x:break;case g:var u=RegExp(/[\s|\t]?#include[\s]+([<|"]?.*[>|"]?)$/);switch(e.data.match(/(#[a-z]+)\s?/)[0].trim()){case"#define":var f=e.data.match(/#define[\s]+(.*)/);f&&(f[1].match(/.*[\s]+(.*)/)||(e.data=e.data+" 1")),i();break;case"#include":var c=e.data.match(u)||[],l=a(c,2),d=(l[0],l[1]),p=d.replace(/^["|<](.*)["|>]/,"$1").trim(),m=d[0].trim(),h=d[d.trim().length-1].trim(),y=function(e,t){return new e((t||"")+"\n\tat (glsl) "+v.join("\n\tat (glsl) "))};if(-1==["<",'"'].indexOf(m)){var b="Unexpected token '"+m+"'. Expecting '<' or '\"'.";throw y(SyntaxError,b)}if(-1==[">",'"'].indexOf(h)){var S="Unexpected token '"+h+"'. Expecting "+("<"==m?"'>'":"'\"'")+".";throw y(SyntaxError,S)}if("<"==m&&">"!=h){var A="Unexpected token '"+h+"'. Expecting '>'.";throw y(SyntaxError,A)}if('"'==m&&'"'!=h){var O="Unexpected token '"+h+"'. Expecting '\"'.";throw y(SyntaxError,O)}var E="<"==m&&">"==h?"/":r,w="."!=p[0]?"./":"",L=o.resolve(""+w+p,E),M=o.get(L);if(!M)throw y(ReferenceError,"glsl lib "+d+" not found.");v.push(p+":"+e.line),n(M+"\n",t,E),v.pop();break;default:i()}break;default:i()}}()}catch(e){f=!0,c=e}finally{try{!u&&d.return&&d.return()}finally{if(f)throw c}}}var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.shaderLib,c=this.defines,s=o.middleware,l=o.version,v=[],b=[];return i=i&&"object"==(void 0===i?"undefined":u(i))?i:{},"string"==typeof t&&(t=(0,m.default)(t,f({},c,i.defines))),n("\n"+t+"\n",b,e!=O?(0,d.dirname)(e):"/"),t=(0,p.default)(b),s.filter(function(e){return"function"==typeof e}).reduce(function(e,t){return(0,y.default)(t(o,r,e,i),e)},t).replace("#define GLSLIFY 1\n","")}}]),e}())},{"./dynamic":29,"./glsl":39,defined:130,"glsl-inject-defines":280,"glsl-token-defines":281,"glsl-token-string":283,"glsl-tokenizer":290,path:297,prepr:299,"string-hash":304}],51:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":f(t))&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":f(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}function u(e){switch(e+1){case 1:return"First";case 2:return"Second";case 3:return"Third";case 4:return"Fourth";case 5:return"Fifth";case 6:return"Sixth";default:return"Unknown"}}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.BadArgumentError=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../utils"),l="BadArgumentError(): Expecting first argument index to be a number.",d="BadArgumentError(): Expecting second argument name to be a string.",p="BadArgumentError(): Expecting fourth argument name to be a string.";n.BadArgumentError=function(e){function t(e,n,o,a){if(r(this,t),"number"!=typeof e)throw new TypeError(l);if("string"!=typeof n)throw new TypeError(d);if("string"!=typeof a)throw new TypeError(p);var f=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Expecting "+u(e).toLowerCase()+" argument "+n+" to be "+a+". Got "+(0,s.toTypeString)(o)+" instead."));return"function"==typeof Error.captureStackTrace?Error.captureStackTrace(f,f.constructor):f.stack=new(Error(message).stack),f}return o(t,a(TypeError)),c(t,[{key:"name",get:function(){return this.constructor.name}},{key:"code",get:function(){return this.constructor.name}}]),t}()},{"../utils":119}],52:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.MissingContextError=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Missing context object for "+(e||"Unknown")+"."));return"function"==typeof Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=new(Error(message).stack),n}return o(t,a(TypeError)),f(t,[{key:"name",get:function(){return this.constructor.name}},{key:"code",get:function(){return this.constructor.name}}]),t}()},{}],53:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./arguments");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./arguments":51,"./context":52}],54:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.FrameContext=function(e,t){return(0,i.assignDefaults)(t,a),(0,o.ScopedContext)(e,t,{regl:function(){return e?e.regl:null},gl:function(){return e?e.gl:null},clear:function(e,n){return function(o){return e.regl.clear(r({},o||(0,i.pick)("clear",[n,t])))}}})};var i=e("../utils"),o=e("../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../scope":92,"../utils":119,"./defaults":55}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.autoClear=!0,n.uniformName="frame",n.blending={equation:"add",enable:!1,color:[0,0,0,1],func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1}},n.culling={enable:!1,face:"back"},n.depth={enable:!0,range:[0,1],func:"less",mask:!0},n.clear={color:[17/255,17/255,17/255,1],depth:1}},{}],56:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Frame=function(e){function t(){if(null==g)return d()}function n(t,n){var r=(0,i.ScopedContext)(e,{frame:function(){return o},cancel:function(e){var t=e.frames;return function(){o&&(o.cancel(),t.splice(t.indexOf(o),1))}},cancelAll:function(){return function(){if(y){var e=!0,t=!1,n=void 0;try{for(var r,i=y[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.cancel()}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}y.splice(0,y.length)}g&&(g.cancel(),g=null)}}}),o=l(n,r);return y.push(o)}function l(e,t){var n=null,r=null;return r={cancel:function(){n=!0},onframe:function(){return n?y.splice(y.indexOf(r,1)):t(e)}}}function d(){function t(){b(s);var t=y.map(function(e){return e.onframe});try{for(var n=0;n<t.length;++n)t[n]()}catch(t){e.emit("error",t);try{var r=!0,i=!1,o=void 0;try{for(var a,u=y[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)(0,a.value.cancel)()}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}catch(t){e.emit("error",t)}return p()}}return g&&p(),g=e.regl.frame(function(){return h(t)})}function p(){if(null!=g){try{var t=!0,n=!1,r=void 0;try{for(var i,o=y[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.cancel()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}catch(t){e.emit("error",t)}y.splice(0,y.length);try{g.cancel()}catch(e){}g=null}}var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(m,f);var h=(0,c.Entity)(e,m,(0,i.ScopedContext)(e,{frames:function(){return y},loop:function(){return g}}),(0,a.FrameContext)(e,m),(0,u.FrameState)(e,m)),v=m.frames,y=void 0===v?[]:v,b=(e.regl({}),(0,o.UpdateContext)(e,m,{update:function(e,t){var n=e.clear;if(t&&!0===t.autoClear&&"function"==typeof n)return n()}})),g=null;return function(e,r){return t(),"function"==typeof e&&(r=e,e={}),n(0,r)}};var r=e("../utils"),i=e("../scope"),o=e("../update"),a=e("./context"),u=e("./state"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),c=e("../core"),s=(function(e){e&&e.__esModule}(e("raf")),function(){})},{"../core":49,"../scope":92,"../update":118,"../utils":119,"./context":54,"./defaults":55,"./state":58,raf:301}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./frame");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./state");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":54,"./frame":56,"./state":58,"./uniforms":59}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.FrameState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),e.regl({depth:r({},t.depth),blend:r({},t.blending),cull:r({},t.culling)})};var i=e("../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../utils":119,"./defaults":55}],59:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FrameShaderUniforms=void 0;var r=e("../utils"),i=e("../shader"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.FrameShaderUniforms=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,o);var n=t.uniformName;return(0,i.ShaderUniforms)(e,{prefix:n+"."},{resolution:function(e){return[e.drawingBufferWidth,e.drawingBufferHeight]},time:function(e){return e.time},tick:function(e){return e.tick}})}},{"../shader":95,"../utils":119,"./defaults":55}],60:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.FrameBuffer=function(e){function t(e,t){var n=e.texturePointer,i=e.drawingBufferWidth,o=e.drawingBufferHeight,a=t.width||i,u=t.height||o;n&&l!=n&&(l=n,n(r({width:a,height:u,wrap:"clamp",min:"linear",mag:"linear"},t.texture)),c({color:n})),d==a&&p==u||(d=a,p=u,c.resize(a,u))}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.assignDefaults)(n,{depth:!0});var f=e.regl({}),c=e.regl.framebuffer((0,i.framebuffer)(n)),s=e.regl({framebuffer:c}),l=null,d=0,p=0;return(0,u.Entity)(e,n,(0,a.ScopedContext)(e,{framebufferPointer:function(){return s}}),function(e,n){f(e,t),s(function(e){(0,e.clear)(),n()})})};var i=e("regl-extend"),o=e("../utils"),a=e("../scope"),u=e("../core")},{"../core":49,"../scope":92,"../utils":119,"regl-extend":303}],61:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./framebuffer");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})})},{"./framebuffer":60}],62:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./camera");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./core");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./frame");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./framebuffer");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./material");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var f=e("./mesh");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return f[e]}})});var c=e("./object3d");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return c[e]}})});var s=e("./scissor");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}})});var l=e("./scope");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return l[e]}})});var d=e("./shader");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return d[e]}})});var p=e("./texture");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return p[e]}})});var m=e("./viewport");Object.keys(m).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return m[e]}})})},{"./camera":9,"./core":49,"./frame":57,"./framebuffer":61,"./material":65,"./mesh":77,"./object3d":89,"./scissor":91,"./scope":92,"./shader":95,"./texture":116,"./viewport":120}],63:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,o),(0,i.ScopedContext)(e,t,{lineWidth:function(e,t){return(0,r.pick)("lineWidth",[t,o,e])},wireframe:function(e,t){return(0,r.pick)("wireframe",[t,o,e])},opacity:function(e,t){return(0,r.pick)("opacity",[t,o,e])},color:function(e,t){return(0,r.ensureRGB)((0,r.pick)("color",[t,o,e]))}})};var r=e("../utils"),i=e("../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../scope":92,"../utils":119,"./defaults":64}],64:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="material",n.opacity=1,n.color=[100/255,110/255,1],n.wireframePrimitive="line strip",n.primitive="triangles",n.lineWidth=1,n.blending={equation:"add",enable:!1,color:[0,0,0,1],func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1}},n.culling={enable:!1,face:"back"},n.depth={enable:!0,range:[0,1],func:"less",mask:!0}},{}],65:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./material");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./shader");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./state");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":63,"./material":66,"./shader":67,"./state":70}],66:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Material=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.assignDefaults)(t,f),(0,c.Entity)(e,t,(0,o.MaterialContext)(e,t),(0,u.MaterialState)(e,t),(0,r.MaterialShaderUniforms)(e,t),(0,i.FrameShaderUniforms)(e,t),(0,r.MaterialShader)(e,t))};var r=e("./shader"),i=e("../frame"),o=e("./context"),a=e("../utils"),u=e("./state"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),c=e("../core")},{"../core":49,"../frame":57,"../utils":119,"./context":63,"./defaults":64,"./shader":67,"./state":70}],67:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./shader");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./shader":68,"./uniforms":69}],68:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.createFragmentShader;return(0,o.assignDefaults)(t,u),(0,a.Shader)(e,i({fragmentShader:n(t)},t))}Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.MaterialShader=r;var o=e("../../utils"),a=e("../../shader"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));Object.assign(r,{createFragmentShader:function(){return"\n    #define GLSL_MATERIAL_UNIFORM_VARIABLE "+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).uniformName+"\n    #include <material/fragment/main>\n    "}})},{"../../shader":95,"../../utils":119,"../defaults":64}],69:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialShaderUniforms=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,o);var n=t.uniformName;return(0,i.ShaderUniforms)(e,{prefix:n+"."},{opacity:function(e,n){return(0,r.pick)("opacity",[n,e,t])},color:function(e,n){return(0,r.ensureRGB)((0,r.pick)("color",[n,e,t]))}})};var r=e("../../utils"),i=e("../../shader"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../shader":95,"../../utils":119,"../defaults":64}],70:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,o),(0,i.ScopedState)(e,t,{blend:{equation:function(e,n){return(0,r.pick)("equation",[n.blending,e.blending,t.blending])},color:function(e,n){return(0,r.ensureRGBA)((0,r.pick)("color",[n.blending,e.blending,t.blending]))},enable:function(e,n){return(0,r.pick)("enable",[n.blending,e.blending,t.blending])},func:function(e,n){return(0,r.pick)("func",[n.blending,e.blending,t.blending])}},cull:{enable:function(e,n){return Boolean((0,r.pick)("enable",[n.culling,e.culling,t.culling]))},face:function(e,n){return String((0,r.pick)("face",[n.culling,e.culling,t.culling]))}},depth:{enable:function(e,n){return"boolean"==typeof n.depth?n.depth:Boolean((0,r.pick)("enable",[n.depth,e.depth,t.depth]))},range:function(e,n){return(0,r.pick)("range",[n.depth,e.depth,t.depth])},func:function(e,n){return(0,r.pick)("func",[n.depth,e.depth,t.depth])},mask:function(e,n){return(0,r.pick)("mask",[n.depth,e.depth,t.depth])}}})};var r=e("../utils"),i=e("../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../scope":92,"../utils":119,"./defaults":64}],71:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MeshBoundingBoxContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,o);var n=new WeakMap,a=t.geometry;return(0,i.ScopedContext)(e,{boundingBox:function(){if(a){if(n.has(a))return n.get(a);if("function"==typeof a.computeBoundingBox){var e=a.computeBoundingBox();return n.set(a,e),e}return null}return null}})};var r=e("../../utils"),i=e("../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../scope":92,"../../utils":119,"../defaults":76}],72:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MeshContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,f),(0,c.Entity)(e,t,(0,u.Object3DContext)(e,t),(0,o.MeshGeometryContext)(e,t),(0,i.MeshBoundingBoxContext)(e,t),(0,r.isolate)((0,a.MeshSizeContext)(e,t)))};var r=e("../../utils"),i=e("./bounding-box"),o=e("./geometry"),a=e("./size"),u=e("../../object3d"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),c=e("../../core")},{"../../core":49,"../../object3d":89,"../../utils":119,"../defaults":76,"./bounding-box":71,"./geometry":73,"./size":75}],73:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MeshGeometryContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,o);var n=t.geometry;return(0,i.ScopedContext)(e,{geometry:function(){return n}})};var r=e("../../utils"),i=e("../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../scope":92,"../../utils":119,"../defaults":76}],74:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./bounding-box");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./geometry");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./size");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./bounding-box":71,"./context":72,"./geometry":73,"./size":75}],75:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.MeshSizeContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,a),(0,o.ScopedContext)(e,{size:function(e,t,n){var r=(0,i.pick)("boundingBox",[t,e,a]),o=(0,i.normalizeScaleVector)((0,i.pick)("scale",[t,e,a]));if(!r)return[0,0,0];var c=r&&r[0].length,s=r[0],l=r[1],d=[];switch(c){case 3:f.default.subtract(d,l,s),f.default.multiply(d,d,o);break;case 2:u.default.subtract(d,l,s),u.default.multiply(d,d,o)}return d}})};var i=e("../../utils"),o=e("../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),u=r(e("gl-vec2")),f=r(e("gl-vec3"))},{"../../scope":92,"../../utils":119,"../defaults":76,"gl-vec2":215,"gl-vec3":245}],76:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.state={lineWidth:1,primitive:"triangles",wireframe:!1,wireframePrimitive:"line strip"},n.shader={uniformName:"mesh",defines:{}}},{}],77:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./shader");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./state");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./mesh");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":74,"./mesh":78,"./shader":80,"./state":83}],78:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.Mesh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(t,u),null==t.geometry.complex&&(t.geometry=new f.Geometry({complex:t.geometry}));var n=(e.regl({}),e.regl(r({},t.regl)));return(0,f.Entity)(e,t,(0,c.MeshContext)(e,t),(0,s.MeshState)(e,t),(0,l.MeshShaderAttributes)(e,t),(0,l.MeshShaderUniforms)(e,t),(0,l.MeshShader)(e,t),(0,o.CameraShaderUniforms)(e,t.camera),(0,a.FrameShaderUniforms)(e,t.frame),function(e,t){return!1!==n.args&&n(),t()})};var i=e("../utils"),o=e("../camera"),a=e("../frame"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),f=(e("../object3d"),e("../core")),c=e("./context"),s=e("./state"),l=e("./shader")},{"../camera":9,"../core":49,"../frame":57,"../object3d":89,"../utils":119,"./context":74,"./defaults":76,"./shader":80,"./state":83}],79:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MeshShaderAttributes=function(e,t){(0,i.assignDefaults)(t,o.shader);var n=t.geometry,a=t.attributes,u=void 0===a?{}:a;return n&&(n.positions&&(u.position=e.regl.buffer(n.positions)),n.normals&&(u.normal=e.regl.buffer(n.normals)),n.uvs&&(u.uv=e.regl.buffer(n.uvs))),(0,r.ShaderAttributes)(e,u)};var r=e("../../shader"),i=e("../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../shader":95,"../../utils":119,"../defaults":76}],80:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./attributes");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./uniforms");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./shader");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./attributes":79,"./shader":81,"./uniforms":82}],81:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.assignDefaults)(t,a.shader);var n=t.uniformName,f=t.geometry,c=t.vertexShader,s=void 0===c?r.createVertexShader({uniformName:n}):c,l=t.fragmentShader,d=void 0===l?r.createFragmentShader({uniformName:n}):l,p=t.defines,m=void 0===p?{}:p;return f&&(f.positions?m.GLSL_MESH_HAS_POSITION=!0:m.GLSL_MESH_NO_POSITION=!0,f.normals?m.GLSL_MESH_HAS_NORMAL=!0:m.GLSL_MESH_NO_NORMAL=!0,f.uvs?m.GLSL_MESH_HAS_UV=!0:m.GLSL_MESH_NO_UV=!0),(0,u.Shader)(e,i({vertexShader:function(e){var t=e.vertexShader;return"string"==typeof t?t:s},fragmentShader:function(e){var t=e.fragmentShader;return"string"==typeof t?t:d}},t,{defines:i({},t.defines,m)}))}Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.MeshShader=r;var o=e("../../utils"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),u=e("../../shader");Object.assign(r,{createVertexShader:function(){return"\n    #define GLSL_MESH_UNIFORM_VARIABLE "+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).uniformName+"\n    #include <mesh/vertex/main>\n    "},createFragmentShader:function(){return"\n    #define GLSL_MESH_UNIFORM_VARIABLE "+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).uniformName+"\n    #include <mesh/fragment/main>\n    "}})},{"../../shader":95,"../../utils":119,"../defaults":76}],82:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=0;n<e.length;++n)e[n]=t[n]}Object.defineProperty(n,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.MeshShaderUniforms=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.assignDefaults)(t,f.shader);var n=t.uniformName;t.prefix=n+".";var r={position:new Float32Array(3),rotation:new Float32Array(4),scale:new Float32Array(3),model:new Float32Array(16),modelNormal:new Float32Array(9)};return(0,u.ShaderUniforms)(e,o({},t),{modelNormal:function(e){var t=e.transform;return i(r.modelNormal,(0,a.isArrayLike)(t)?s.default.normalFromMat4([],t)||d:d),r.modelNormal},model:function(e){var t=e.transform;return i(r.model,(0,a.isArrayLike)(t)?t:l),r.model}})};var a=e("../../utils"),u=e("../../shader"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),c=r(e("gl-mat4")),s=r(e("gl-mat3")),l=c.default.identity([]),d=s.default.identity([])},{"../../shader":95,"../../utils":119,"../defaults":76,"gl-mat3":145,"gl-mat4":163}],83:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MeshState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(t,i.state);var n=t.geometry,a=null,u={primitive:function(e,n){return(0,r.pick)("wireframe",[n,t])?(0,r.pick)("wireframePrimitive",[n,t]):(0,r.pick)("primitive",[n,t])},lineWidth:function(e,n){return Math.max(1,(0,r.pick)("lineWidth",[n,t]))||1}};return n.cells?(a=e.regl.elements({data:n.cells}),Object.assign(u,{elements:a,count:function(e,i){var a=n.positions[0].length*n.cells.length,u=(0,r.pick)("count",[i,t]);return null!=u?(0,o.default)(u,0,a):a}})):n.positions&&Object.assign(u,{count:function(e,i){var a=(0,r.pick)("count",[i,t]),u=n.positions.length;return null!=a?(0,o.default)(a,0,u):u}}),e.regl(u)};var r=e("../utils"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),o=function(e){return e&&e.__esModule?e:{default:e}}(e("defined"))},{"../utils":119,"./defaults":76,defined:130}],84:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assertComponentArguments)("Object3DContext",e,t),(0,a.Entity)(e,t,(0,o.Object3DTRSContext)(e,t),(0,i.Object3DMatrixContext)(e,t))};var r=e("../../utils"),i=e("./matrix"),o=e("./trs"),a=e("../../core")},{"../../core":49,"../../utils":119,"./matrix":86,"./trs":87}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./matrix");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./trs");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./context":84,"./matrix":86,"./trs":87}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DMatrixContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.assertComponentArguments)("Object3DMatrixContext",e,t);var n=o.default.identity(new Float32Array(16)),u=o.default.identity(new Float32Array(16));return(0,r.ScopedContext)(e,t,{matrix:function(e,n){var r=(0,a.pick)("position",[n,t,i]),f=(0,a.pick)("rotation",[n,t,i]),c=(0,a.normalizeScaleVector)((0,a.pick)("scale",[n,t,i]));return o.default.identity(u),o.default.fromRotationTranslation(u,f,r),o.default.scale(u,u,c),u},transform:function(e,t){var r=e.transform;return o.default.copy(n,u),r&&o.default.multiply(n,r,u),n}})};var r=e("../../scope"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),o=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4")),a=e("../../utils")},{"../../scope":92,"../../utils":119,"../defaults":88,"gl-mat4":163}],87:[function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Cannot destructure undefined")}Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DTRSContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assertComponentArguments)("Object3DTRSContext",e,t),(0,o.ScopedContext)(e,t,{scale:function(e,n){return r(e),(0,i.normalizeScaleVector)((0,i.pick)("scale",[n,t,a]))},position:function(e,n){return r(e),(0,i.pick)("position",[n,t,a])},rotation:function(e,n){return r(e),(0,i.pick)("rotation",[n,t,a])}})};var i=e("../../utils"),o=e("../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../scope":92,"../../utils":119,"../defaults":88}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.rotation=[0,0,0,1],n.position=[0,0,0],n.scale=[1,1,1]},{}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./object3d");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./context":85,"./object3d":90}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Object3D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assertComponentArguments)("Object3D",e,t),(0,i.Object3DContext)(e,t)};var r=e("../utils"),i=e("./context");(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e})(e("./defaults")),e("../core")},{"../core":49,"../utils":119,"./context":85,"./defaults":88}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Scissor=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.regl({scissor:{enable:!0,box:t.scissor}})}},{}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ScopedContext=function(e,t,n){return t&&!n&&(n=t,t={}),e.regl({context:new i.DynamicValue(e,t,n)})},n.ScopedState=function(e,t,n){return t&&!n&&(n=t,t={}),e.regl((0,r.command)(new i.DynamicValue(e,t,n)))};var r=e("regl-extend"),i=e("./core")},{"./core":49,"regl-extend":303}],93:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.ShaderAttributes=function(e,t,n){"object"!=(void 0===t?"undefined":i(t))&&(t={}),"object"!=(void 0===n?"undefined":i(n))&&(n=t);var r=new o.WebGLShaderAttributes(e,t,n);return e.regl({attributes:r,context:{attributes:r}})},n.ShaderInstancedAttributes=function(e,t,n){"object"!=(void 0===t?"undefined":i(t))&&(t={}),"object"!=(void 0===n?"undefined":i(n))&&(n=t);var r=new o.WebGLShaderInstancedAttributes(e,t,n);return e.regl({attributes:r,context:{attributes:r}})};var o=e("../core")},{"../core":49}],94:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.ShaderDefines=function(e,t,n){return"object"!=(void 0===t?"undefined":o(t))&&(t={}),"object"!=(void 0===n?"undefined":o(n))&&(n=t,t={}),n=i({},n),(0,a.ScopedContext)(e,i({},t,{defines:function(){var e=(arguments.length<=0?void 0:arguments[0]).defines,t=void 0===e?{}:e;for(var r in n){var i=n[r];t[r]="function"==typeof i?i.apply(void 0,arguments):i,null==t[r]&&delete t[r]}return t}}))};var a=e("../scope")},{"../scope":92}],95:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./attributes");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./uniforms");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./defines");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./shader");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./attributes":93,"./defines":94,"./shader":96,"./uniforms":97}],96:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.Shader=function(e){function t(e,t){var n=(t=t||{}).forceCompile,r=void 0!==n&&n,i=e.defines;i&&Object.keys(i).length&&g.preprocessor.define(i)&&(x=!0,r=!0),(r||p(e,t))&&s(e,t),c(e,t),x=!1}function n(e){return L[e]?L[e]:L[e]=g.hash(e)}function r(e,t,r){return r=l(e,t,r),b[n(r)]}function c(t,i){var o={context:{fragmentShader:function(e){var t=e.fragmentShader;return E||t},vertexShader:function(e){var t=e.vertexShader;return w||t}}};if(i.fragmentShader||i.vertexShader){var a=r(t,i,i.fragmentShader),u=r(t,i,i.vertexShader);if((u||a)&&(a&&a!=E&&(E=a),u&&u!=w&&(w=u),"string"==typeof E&&(o.frag=E),"string"==typeof w&&(o.vert=w),"string"==typeof o.vert||"string"==typeof o.frag)){if(S&&S.opts&&S.opts.vert==o.vert&&S.opts.frag==o.frag)return;var f=function(e){return[e.vert||"",e.frag||""].map(n).join("")}(o);null==y[f]?(S=e.regl(o),y[f]=S,S.opts=o):y[f]!=S&&(S=y[f])}}}function s(e,t){function i(n,r){var i=null,o=null;return d(r)?(o=l(e,t,r),i=g.compile(v+" ("+n+")",o),i=g.preprocess(i),{compiled:i,uncompiled:o}):null}function o(n){return Boolean(r(e,t,n))}!x&&o(t.vertexShader)||function(){var e=i("vertex",t.vertexShader);e&&(w=e.compiled,O=e.uncompiled,b[n(O)]=w)}(),!x&&o(t.fragmentShader)||function(){var e=i("fragment",t.fragmentShader);e&&(E=e.compiled,A=e.uncompiled,b[n(A)]=E)}()}function l(e,t,n){var r=(g.defines,null);return"string"==typeof n?r=n:"function"==typeof n&&(r=n(e,t)),r}function d(e){return["string","function"].indexOf(void 0===e?"undefined":i(e))>-1}function p(e,t){function r(e){e&&(o=!0)}function i(i,o){return o=l(e,t,o),b[n(o)]?r(!1):"string"!=typeof i&&"string"==typeof o?r(!0):"string"==typeof o&&i!=o?r(!0):void 0}var o=!1;return r("function"!=typeof S),i(O,t.vertexShader),i(A,t.fragmentShader),o}var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.assignDefaults)(m,a.ShaderLib.defaults());var h=m.shaderName,v=void 0===h?"shader":h,y={},b={},g=new a.ShaderLib(o({},m)),_=e.regl({}),x=!1,S=_,A=null,O=null,E=null,w=null,L={};return(0,a.Entity)(e,m,(0,f.ShaderDefines)(e,m,m.defines),function(e,n){return _(e,t),S(e,n)})};var a=e("../core"),u=e("../utils"),f=(e("../scope"),e("./defines"));e("../update")},{"../core":49,"../scope":92,"../update":118,"../utils":119,"./defines":94}],97:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.ShaderUniforms=function(e,t,n){"object"!=(void 0===t?"undefined":i(t))&&(t={}),"object"!=(void 0===n?"undefined":i(n))&&(n=t);var r=new o.WebGLShaderUniforms(e,t,n);return e.regl({uniforms:r,context:{uniforms:r}})};var o=e("../core")},{"../core":49}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TextureContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,i),(0,o.Entity)(e,t,(0,r.isolate)((0,u.TextureDataContext)(e,t)),(0,a.TexturePointerContext)(e,t),(0,f.TextureInfoContext)(e,t))};var r=e("../../../utils"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),o=e("../../../core"),a=e("./pointer"),u=e("./data"),f=e("./info")},{"../../../core":49,"../../../utils":119,"../defaults":103,"./data":99,"./info":101,"./pointer":102}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TextureDataContext=function(e){function t(e){var t=e.src;return t in u?e:(t in f||(f[t]=new Image,Object.assign(f[t],{src:t,onload:function(){u[t]=e,delete f[t]}})),null)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.assignDefaults)(n,o);var u={},f={};return(0,i.ScopedContext)(e,n,{textureData:function(e,n){var r=n.data;return(0,a.isImage)(r)?r.src in u?r:t(r):(0,a.isVideo)(r)?(0,a.isTextureDataReady)(r)?r:null:r||null}})};var r=e("../../../utils"),i=e("../../../scope"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),a=e("../../utils")},{"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":103}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./pointer");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./data");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":98,"./data":99,"./info":101,"./pointer":102}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TextureInfoContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(t,a);var n=t.uniformName;return(0,o.ScopedContext)(e,{textureUniformName:function(){return n},textureResolution:function(e){var t=e.textureData;return(0,r.getTextureDataResolution)(t)}})};var r=e("../../utils"),i=e("../../../utils"),o=e("../../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":103}],102:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.TexturePointerContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.assignDefaults)(t,c);var n=e.regl.texture(c),r=e.regl.texture((0,a.texture)(t)),l=new WeakMap,d=new WeakMap;return(0,f.ScopedContext)(e,{texturePointer:function(a){function u(){if(c(p))if("object"==(void 0===_?"undefined":i(_))){var e=_.x,t=_.y,n=_.level;x.subimage(S,e,t,n)}else x.subimage(S)}function f(){x=e.regl.texture(S),p&&l.set(p,x)}function c(e){return l.get(e)==x}var p=a.textureData,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=m.copy,v=void 0!==h&&h,y=m.buffer,b=void 0!==y&&y,g=m.subimage,_=void 0!==g&&g,x=n,S=o({},t);return 1==b?r:(p&&(Object.assign(S,{data:p}),x=l.get(p)||n,(0,s.isImage)(p)&&(p&&!l.has(p)?f():_&&u()),(0,s.isVideo)(p)&&(l.has(p)?function(){if(0!=c(p))if((0,s.isVideo)(p)){var e=d.get(p)||0;(!e||Date.now()-e>16)&&(_?u():x(S),d.set(p,Date.now()))}else _?u():x(S)}():f()),x==n&&(l.has(p)?_&&u():f())),null==p&&1==v&&(x=r,function(){var e={};"x"in m&&(e.x=m.x),"y"in m&&(e.y=m.y),"width"in m&&(e.width=m.width),"height"in m&&(e.height=m.height),r(o({},e,{copy:!0}))}()),x)}})};var a=e("regl-extend"),u=e("../../../utils"),f=e("../../../scope"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),s=e("../../utils")},{"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":103,"regl-extend":303}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="tex2d",n.colorSpace="browser",n.format="rgba",n.min="linear",n.mag="linear"},{}],104:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var o=e("./texture");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./context":100,"./texture":105,"./uniforms":106}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Texture=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),(0,r.TextureContext)(e,t)};var r=e("./context"),i=e("../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../utils":119,"./context":100,"./defaults":103}],106:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.TextureShaderUniforms=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(n,a);var u=n.uniformName;return(0,o.ShaderUniforms)(e,{},(t={},r(t,u+"Resolution",function(e){return e.textureResolution}),r(t,u,function(e){return e.texturePointer}),t))};var i=e("../../utils"),o=e("../../shader"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../shader":95,"../../utils":119,"./defaults":103}],107:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.assignDefaults)(t,i),t.uniformName,(0,o.Entity)(e,t,(0,r.isolate)((0,u.CubeTextureDataContext)(e,t)),(0,a.CubeTexturePointerContext)(e,t),(0,f.CubeTextureInfoContext)(e,t))};var r=e("../../../utils"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),o=e("../../../core"),a=e("./pointer"),u=e("./data"),f=e("./info")},{"../../../core":49,"../../../utils":119,"../defaults":112,"./data":108,"./info":110,"./pointer":111}],108:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n.CubeTextureDataContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.assignDefaults)(t,u),(0,a.ScopedContext)(e,{cubeTextureData:function(e,n){var a=(0,o.pick)("data",[n,e,t]);if(a&&Array.isArray(a)&&a.some(f.isCubeTextureDataReady)){var u=(0,f.getCubeTextureDataResolution)(a),c=i(u,2),s=c[0],l=c[1];if(s&&l)return[].concat(r(a))}return null}})};var o=e("../../../utils"),a=e("../../../scope"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),f=e("../../utils")},{"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":112}],109:[function(e,t,n){arguments[4][100][0].apply(n,arguments)},{"./context":107,"./data":108,"./info":110,"./pointer":111,dup:100}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureInfoContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(t,a);var n=t.uniformName;return(0,o.ScopedContext)(e,{cubeTextureUniformName:function(){return n},cubeTextureResolution:function(e){var t=e.cubeTextureData;return(0,r.getCubeTextureDataResolution)(t)}})};var r=e("../../utils"),i=e("../../../utils"),o=e("../../../scope"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))},{"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":112}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTexturePointerContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(t,a);var n=Array(6).fill(null),f=e.regl.cube(Object.assign((0,r.texture)(t),{colorSpace:"browser"}));return(0,o.ScopedContext)(e,{cubeTexturePointer:function(e){var i=e.cubeTextureData,o=!1;if(Array.isArray(i))for(var a=0;a<n.length;++a)n[a]!=i[a]&&(0,u.isCubeTextureDataReady)(i[[a]])&&(n[a]=i[a],o=!0);for(var c=(0,u.getCubeTextureDataResolution)(n),s=0;s<n.length;++s)null!=n[s]&&(0,u.isCubeTextureDataReady)(n[s])||(n[s]={shape:c});if(o){var l=Object.assign({},(0,r.texture)(t),{faces:n});f(l)}return f}})};var r=e("regl-extend"),i=e("../../../utils"),o=e("../../../scope"),a=(e("../../../core"),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"))),u=e("../../utils")},{"../../../core":49,"../../../scope":92,"../../../utils":119,"../../utils":117,"../defaults":112,"regl-extend":303}],112:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="texCube",n.colorSpace="browser",n.format="rgba",n.min="linear",n.mag="linear"},{}],113:[function(e,t,n){arguments[4][104][0].apply(n,arguments)},{"./context":109,"./texture":114,"./uniforms":115,dup:104}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTexture=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.assignDefaults)(t,o),(0,r.CubeTextureContext)(e,t)};var r=e("./context"),i=e("../../utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../utils":119,"./context":109,"./defaults":112}],115:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureShaderUniforms=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.assignDefaults)(n,a);var u=n.uniformName;return(0,o.ShaderUniforms)(e,(t={},r(t,u+"Resolution",function(e){return e.cubeTextureResolution}),r(t,u,function(e){return e.cubeTexturePointer}),t))};var i=e("../../utils"),o=e("../../shader"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"))},{"../../shader":95,"../../utils":119,"./defaults":112}],116:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./cube");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./2d");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./2d":104,"./cube":113}],117:[function(e,t,n){"use strict";function r(e){return S(e)||_(e)?[e.width,e.height]:x(e)?[e.videoWidth||0,e.videoHeight||0]:e&&e.shape?e.shape:[0,0]}function i(e){return Array.isArray(e)?(e=e.filter(function(e){return e}).filter(function(e){return S(e)||x(e)||e.shape&&e.shape.every(Boolean)})[0],i(e)):S(e)||_(e)?[e.width,e.height]:x(e)?[e.videoWidth||0,e.videoHeight||0]:e&&e.shape?e.shape:[0,0]}Object.defineProperty(n,"__esModule",{value:!0}),n.isImage=n.isVideo=n.isCanvas=n.HAVE_ENOUGH_DATA=n.HAVE_FUTURE_DATA=n.HAVE_CURRENT_DATA=n.HAVE_METADATA=n.HAVE_NOTHING=void 0,n.isTextureDataReady=function(e){if(!e)return!1;var t=r(e);return!!(t[0]&&t[1]&&(x(e)&&e.readyState>=h||(S(e)||_(e))&&e.width&&e.height))},n.getTextureDataResolution=r,n.isCubeTextureDataReady=function(e){return!!(x(e)&&e.readyState>=h)||!(!S(e)&&!_(e)||!e.width||!e.height)},n.getCubeTextureDataResolution=i;var o=function(e){return e&&e.__esModule?e:{default:e}}(e("global/window")),a=o.default.HTMLVideoElement,u=o.default.HTMLCanvasElement,f=o.default.HTMLImageElement,c=a||{},s=c.HAVE_NOTHING,l=void 0===s?0:s,d=c.HAVE_METADATA,p=void 0===d?1:d,m=c.HAVE_CURRENT_DATA,h=void 0===m?2:m,v=c.HAVE_FUTURE_DATA,y=void 0===v?3:v,b=c.HAVE_ENOUGH_DATA,g=void 0===b?4:b;n.HAVE_NOTHING=l,n.HAVE_METADATA=p,n.HAVE_CURRENT_DATA=h,n.HAVE_FUTURE_DATA=y,n.HAVE_ENOUGH_DATA=g;var _=n.isCanvas=function(e){return e instanceof u},x=n.isVideo=function(e){return e instanceof a},S=n.isImage=function(e){return e instanceof f}},{"global/window":279}],118:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return r({},"__"+Math.random().toString("16").slice(2)+"_update",function(n,r){return t(n,(0,o.assignDefaults)(r||{},e))})}Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateContext=function(e,t,n){t&&!n&&(n=t,t={});var r=n.update;return"update"in t&&delete t.update,"function"==typeof n.update?e.regl({context:new a.DynamicValue(e,t,i(t,r))}):e.regl({})};var o=e("./utils"),a=e("./core")},{"./core":49,"./utils":119}],119:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){return(t.filter(function(e){return e}).find(function(t){return null!=t[e]})||{})[e]}function a(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function u(){return y.default.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function f(e){if(e instanceof S||e instanceof A){var t=u(),n=t.getContext("2d");return t.width=a(e.width),t.height=a(e.height),n.drawImage(e,0,0,t.width,t.height),t}return e}function c(e,t,n){var r=u(),i=r.getContext("2d"),o=e.width,f=e.height;return n&&(o=a(o),f=a(f)),r.width=Math.floor(e.width*t),r.height=Math.floor(e.height*t),i.drawImage(e,0,0,o,f,0,0,r.width,r.height),r}function s(e){e=[].concat(i(e||[]));for(var t=0;t<3;++t)"number"!=typeof e[t]?e[t]=0:e[t]=(0,_.default)(e[t],0,1);return"number"!=typeof e[3]?e[3]=1:e[3]=(0,_.default)(e[3],0,1),[].concat(i(e)).slice(0,4)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1];return"number"==typeof t&&(t=l(t,[1,1,1])),"number"==typeof e?O(3,e):Array.isArray(e)?Object.assign(e,Object.assign([],t,e)).slice(0,3):t}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.fill=n.lerp=n.radians=n.isolate=n.debug=void 0;var p="function"==typeof Symbol&&"symbol"==d(Symbol.iterator)?function(e){return void 0===e?"undefined":d(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":d(e)};n.assignDefaults=function(e,t){return(0,g.default)(!0,e,(0,g.default)(!0,{},t,e))},n.pick=o,n.get=function(){return console.warn("utils.get() is deprecated. Please use utils.pick()"),o.apply(void 0,arguments)},n.nearestPowerOfTwo=a,n.createCanvas=u,n.getScreenOrientation=function(){return function(e){switch(function(){if("object"==p(b.default.screen)){if("object"==p(b.default.screen.orientation))return b.default.screen.orientation.type;if("string"==typeof b.default.screen.orientation)return b.default.screen.orientation;if("object"==p(b.default.screen.mozOrientation))return b.default.screen.mozOrientation.type;if("string"==typeof b.default.screen.mozOrientation)return b.default.screen.mozOrientation}return null}()){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0;default:return b.default.orientation||b.default.mozOrientation||0}}()},n.makePowerOfTwo=f,n.scaleImageIntoCanvas=c,n.clampImageToMaxSize=function(e,t,n){return e.width>t||e.height>t?c(e,t/Math.max(e.width,e.height),n):n?f(e):e},n.ensureRGBA=s,n.ensureRGB=function(e){return s(e).slice(0,3)},n.isArrayLike=function(e){return Boolean(e&&(Array.isArray(e)||e instanceof x||(0,h.default)(e)||"number"==e.length||"function"==typeof e[Symbol.iterator]))},n.normalizeScaleVector=l,n.ensureObject=function(e){return e?Array.isArray(e)?{}:"object"!=(void 0===e?"undefined":p(e))?{}:e:{}},n.ensureArray=function(e){return e&&Array.isArray(e)?e:[]},n.toTypeString=function(e){return Object.prototype.toString.call(e).toLowerCase().replace("[object ","").replace("]","")},n.assertComponentArguments=function(e,t,n){if(void 0===t)throw new m.MissingContextError(e);if(null===t||"object"!=(void 0===t?"undefined":p(t))||Array.isArray(t))throw new m.BadArgumentError(0,"ctx",t,"object");if(n&&"object"!=(void 0===n?"undefined":p(n)))throw new m.BadArgumentError(1,"initialState",n,"object")};var m=e("./errors"),h=r(e("is-typedarray")),v=r(e("debug")),y=r(e("global/document")),b=r(e("global/window")),g=r(e("extend")),_=r(e("clamp")),x=Object.getPrototypeOf(Float32Array.prototype).constructor,S=b.default.HTMLImageElement,A=b.default.HTMLCanvasElement,O=(n.debug=(0,v.default)("[axis3d@0.6.4]"),n.isolate=function(e){return function(){return e.apply(void 0,arguments)}},n.radians=function(e){return e==e?e*Math.PI/180:0},n.lerp=function(e,t,n){return e*(1-n)+t*n},n.fill=function(e,t){return Array(e).fill(t)})},{"./errors":53,clamp:127,debug:128,extend:133,"global/document":278,"global/window":279,"is-typedarray":292}],120:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.regl({viewport:t.viewport})}},{}],121:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,i){"object"===(void 0===n?"undefined":r(n))&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):e.createREGL=i()}(void 0,function(){function e(e){return"undefined"!=typeof btoa?btoa(e):"base64:"+e}function t(e){var t=new Error("(regl) "+e);throw console.error(t),t}function n(e,n){e||t(n)}function i(e){return e?": "+e:""}function o(e,n,r){n.indexOf(e)<0&&t("invalid value"+i(r)+". must be one of: "+n)}function a(e,t){for(e+="";e.length<t;)e=" "+e;return e}function u(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function f(e,t){this.number=e,this.line=t,this.errors=[]}function c(e,t,n){this.file=e,this.line=t,this.message=n}function s(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function l(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function d(t,n){var r=t.split("\n"),i=1,o=0,a={unknown:new u,0:new u};a.unknown.name=a[0].name=n||s(),a.unknown.lines.push(new f(0,""));for(var c=0;c<r.length;++c){var l=r[c],d=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(l);if(d)switch(d[1]){case"line":var p=/(\d+)(\s+\d+)?/.exec(d[2]);p&&(i=0|p[1],p[2]&&((o=0|p[2])in a||(a[o]=new u)));break;case"define":var m=/SHADER_NAME(_B64)?\s+(.*)$/.exec(d[2]);m&&(a[o].name=m[1]?e(m[2]):m[2])}a[o].lines.push(new f(i++,l))}return Object.keys(a).forEach(function(e){var t=a[e];t.lines.forEach(function(e){t.index[e.number]=e})}),a}function p(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);n?t.push(new c(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new c("unknown",0,e))}}),t}function m(e,t){t.forEach(function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}function h(e){e._commandRef=s()}function v(e,n){var r=l();t(e+" in command "+(n||s())+("unknown"===r?"":" called from "+r))}function y(e,t,n,o){(void 0===e?"undefined":r(e))!==t&&v("invalid parameter type"+i(n)+". expected "+t+", got "+(void 0===e?"undefined":r(e)),o||s())}function b(e,t){return e===ze||e===Ue||e===Ye?2:e===He?4:qe[e]*t}function g(e){return!(e&e-1||!e)}function _(e,t){this.id=We++,this.type=e,this.data=t}function x(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function S(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+x(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return S(e.substr(0,r.index)).concat(S(r[1])).concat(S(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+x(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(S(i[a]));return o}function A(e){return"["+S(e).join("][")+"]"}function O(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function E(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;if(e!==document.body){var o=e.getBoundingClientRect();t=o.right-o.left,r=o.bottom-o.top}i.width=n*t,i.height=n*r,Ie(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return Ie(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",Ie(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}function w(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function L(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function M(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function j(e){return"string"==typeof e?e.split():(Xe(Array.isArray(e),"invalid extension array"),e)}function T(e){return"string"==typeof e?(Xe("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function R(e){var t,n,i,o,a=e||{},u={},f=[],c=[],s="undefined"==typeof window?1:window.devicePixelRatio,l=!1,d=function(e){e&&Xe.raise(e)},p=function(){};if("string"==typeof a?(Xe("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(a),Xe(t,"invalid query string for element")):"object"===(void 0===a?"undefined":r(a))?L(a)?t=a:M(a)?i=(o=a).canvas:(Xe.constructor(a),"gl"in a?o=a.gl:"canvas"in a?i=T(a.canvas):"container"in a&&(n=T(a.container)),"attributes"in a&&(u=a.attributes,Xe.type(u,"object","invalid context attributes")),"extensions"in a&&(f=j(a.extensions)),"optionalExtensions"in a&&(c=j(a.optionalExtensions)),"onDone"in a&&(Xe.type(a.onDone,"function","invalid or missing onDone callback"),d=a.onDone),"profile"in a&&(l=!!a.profile),"pixelRatio"in a&&Xe((s=+a.pixelRatio)>0,"invalid pixel ratio")):Xe.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?i=t:n=t),!o){if(!i){Xe("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var m=E(n||document.body,d,s);if(!m)return null;i=m.canvas,p=m.onDestroy}o=w(i,u)}return o?{gl:o,canvas:i,container:n,extensions:f,optionalExtensions:c,pixelRatio:s,profile:l,onDone:d,onDestroy:p}:(p(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function k(e,t){function n(t){Xe.type(t,"string","extension name must be string");var n,i=t.toLowerCase();try{n=r[i]=e.getExtension(i)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw new Error("(regl): error restoring extension "+e)})}}}function I(e){return!!e&&"object"===(void 0===e?"undefined":r(e))&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||ke(e.data))}function P(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function C(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function D(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,(t|=n)|e>>1}function V(e){var t=C(e),n=ft[D(t)>>2];return n.length>0?n.pop():new ArrayBuffer(t)}function G(e){ft[D(e.byteLength)>>2].push(e)}function N(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function F(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],u=0;u<n;++u)r[i++]=a[u]}function B(e,t,n,r,i,o){for(var a=o,u=0;u<t;++u)for(var f=e[u],c=0;c<n;++c)for(var s=f[c],l=0;l<r;++l)i[a++]=s[l]}function U(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var u=t[n];if(t.length-n==4){var f=t[n+1],c=t[n+2],s=t[n+3];for(a=0;a<u;++a)B(e[a],f,c,s,r,i),i+=o}else for(a=0;a<u;++a)U(e[a],t,n+1,r,i),i+=o}function z(e){return 0|Re[Object.prototype.toString.call(e)]}function Y(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function H(e,t,n,r,i,o,a){for(var u=0,f=0;f<n;++f)for(var c=0;c<r;++c)e[u++]=t[i*f+o*c+a]}function q(e,t,n){function r(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=ht,this.byteLength=0,this.dimension=1,this.dtype=yt,this.persistentData=null,n.profile&&(this.stats={size:0})}function i(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function o(e,t,n,r,o,a){var u;if(e.usage=n,Array.isArray(t)){if(e.dtype=r||bt,t.length>0){var f;if(Array.isArray(t[0])){u=mt(t);for(var c=1,s=1;s<u.length;++s)c*=u[s];e.dimension=c,i(e,f=pt(t,u,e.dtype),n),a?e.persistentData=f:ct.freeType(f)}else if("number"==typeof t[0]){e.dimension=o;var l=ct.allocType(e.dtype,t.length);Y(l,t),i(e,l,n),a?e.persistentData=l:ct.freeType(l)}else ke(t[0])?(e.dimension=t[0].length,e.dtype=r||z(t[0])||bt,i(e,f=pt(t,[t.length,t[0].length],e.dtype),n),a?e.persistentData=f:ct.freeType(f)):Xe.raise("invalid buffer data")}}else if(ke(t))e.dtype=r||z(t),e.dimension=o,i(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(I(t)){u=t.shape;var d=t.stride,p=t.offset,m=0,h=0,v=0,y=0;1===u.length?(m=u[0],h=1,v=d[0],y=0):2===u.length?(m=u[0],h=u[1],v=d[0],y=d[1]):Xe.raise("invalid shape"),e.dtype=r||z(t.data)||bt,e.dimension=h;var b=ct.allocType(e.dtype,m*h);H(b,t.data,m,h,v,y,p),i(e,b,n),a?e.persistentData=b:ct.freeType(b)}else Xe.raise("invalid buffer data")}function a(n){t.bufferCount--;var r=n.buffer;Xe(r,"buffer must not be deleted already"),e.deleteBuffer(r),n.buffer=null,delete f[n.id]}var u=0,f={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){a(this)};var c=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(f).forEach(function(t){e+=f[t].stats.size}),e}),{create:function(i,u,c,s){function l(t){var r=ht,i=null,a=0,u=0,f=1;return Array.isArray(t)||ke(t)||I(t)?i=t:"number"==typeof t?a=0|t:t&&(Xe.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(Xe(null===i||Array.isArray(i)||ke(i)||I(i),"invalid data for buffer"),i=t.data),"usage"in t&&(Xe.parameter(t.usage,dt,"invalid buffer usage"),r=dt[t.usage]),"type"in t&&(Xe.parameter(t.type,lt,"invalid buffer type"),u=lt[t.type]),"dimension"in t&&(Xe.type(t.dimension,"number","invalid dimension"),f=0|t.dimension),"length"in t&&(Xe.nni(a,"buffer length must be a nonnegative integer"),a=0|t.length)),p.bind(),i?o(p,i,r,u,f,s):(e.bufferData(p.type,a,r),p.dtype=u||yt,p.usage=r,p.dimension=f,p.byteLength=a),n.profile&&(p.stats.size=p.byteLength*gt[p.dtype]),l}function d(t,n){Xe(n+t.byteLength<=p.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+p.byteLength),e.bufferSubData(p.type,n,t)}t.bufferCount++;var p=new r(u);return f[p.id]=p,c||l(i),l._reglType="buffer",l._buffer=p,l.subdata=function(e,t){var n,r=0|(t||0);if(p.bind(),Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var i=ct.allocType(p.dtype,e.length);Y(i,e),d(i,r),ct.freeType(i)}else if(Array.isArray(e[0])||ke(e[0])){n=mt(e);var o=pt(e,n,p.dtype);d(o,r),ct.freeType(o)}else Xe.raise("invalid buffer data")}else if(ke(e))d(e,r);else if(I(e)){n=e.shape;var a=e.stride,u=0,f=0,c=0,s=0;1===n.length?(u=n[0],f=1,c=a[0],s=0):2===n.length?(u=n[0],f=n[1],c=a[0],s=a[1]):Xe.raise("invalid shape");var m=Array.isArray(e.data)?p.dtype:z(e.data),h=ct.allocType(m,u*f);H(h,e.data,u,f,c,s,e.offset),d(h,r),ct.freeType(h)}else Xe.raise("invalid data for buffer subdata");return l},n.profile&&(l.stats=p.stats),l.destroy=function(){a(p)},l},createStream:function(e,t){var n=c.pop();return n||(n=new r(e)),n.bind(),o(n,t,vt,0,1,!1),n},destroyStream:function(e){c.push(e)},clear:function(){et(f).forEach(a),c.forEach(a)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:function(){et(f).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:o}}function X(e,t,n,r){function i(e){this.id=f++,u[this.id]=this,this.buffer=e,this.primType=At,this.vertCount=0,this.type=0}function o(r,i,o,a,u,f,c){if(r.buffer.bind(),i){var s=c;c||ke(i)&&(!I(i)||ke(i.data))||(s=t.oes_element_index_uint?jt:Lt),n._initBuffer(r.buffer,i,o,s,3)}else e.bufferData(Tt,f,o),r.buffer.dtype=l||Et,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=f;var l=c;if(!c){switch(r.buffer.dtype){case Et:case Ot:l=Et;break;case Lt:case wt:l=Lt;break;case jt:case Mt:l=jt;break;default:Xe.raise("unsupported type for element array")}r.buffer.dtype=l}r.type=l,Xe(l!==jt||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=u;d<0&&(d=r.buffer.byteLength,l===Lt?d>>=1:l===jt&&(d>>=2)),r.vertCount=d;var p=a;if(a<0){p=At;var m=r.buffer.dimension;1===m&&(p=xt),2===m&&(p=St),3===m&&(p=At)}r.primType=p}function a(e){r.elementsCount--,Xe(null!==e.buffer,"must not double destroy elements"),delete u[e.id],e.buffer.destroy(),e.buffer=null}var u={},f=0,c={uint8:Et,uint16:Lt};t.oes_element_index_uint&&(c.uint32=jt),i.prototype.bind=function(){this.buffer.bind()};var s=[];return{create:function(e,t){function u(e){if(e)if("number"==typeof e)f(e),s.primType=At,s.vertCount=0|e,s.type=Et;else{var t=null,n=kt,r=-1,i=-1,a=0,l=0;Array.isArray(e)||ke(e)||I(e)?t=e:(Xe.type(e,"object","invalid arguments for elements"),"data"in e&&(t=e.data,Xe(Array.isArray(t)||ke(t)||I(t),"invalid data for element buffer")),"usage"in e&&(Xe.parameter(e.usage,dt,"invalid element buffer usage"),n=dt[e.usage]),"primitive"in e&&(Xe.parameter(e.primitive,_t,"invalid element buffer primitive"),r=_t[e.primitive]),"count"in e&&(Xe("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),i=0|e.count),"type"in e&&(Xe.parameter(e.type,c,"invalid buffer type"),l=c[e.type]),"length"in e?a=0|e.length:(a=i,l===Lt||l===wt?a*=2:l!==jt&&l!==Mt||(a*=4))),o(s,t,n,r,i,a,l)}else f(),s.primType=At,s.vertCount=0,s.type=Et;return u}var f=n.create(null,Tt,!0),s=new i(f._buffer);return r.elementsCount++,u(e),u._reglType="elements",u._elements=s,u.subdata=function(e,t){return f.subdata(e,t),u},u.destroy=function(){a(s)},u},createStream:function(e){var t=s.pop();return t||(t=new i(n.create(null,Tt,!0,!1)._buffer)),o(t,e,Rt,-1,-1,0,0),t},destroyStream:function(e){s.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){et(u).forEach(a)}}}function W(e){for(var t=ct.allocType(Ct,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{It[0]=e[n];var r=Pt[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var u=-14-o;t[n]=i+(a+1024>>u)}else t[n]=o>15?i+31744:i+(o+15<<10)+a}return t}function $(e){return Array.isArray(e)||ke(e)}function K(e){return"[object "+e+"]"}function Q(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Z(e){return!!Array.isArray(e)&&!(0===e.length||!$(e[0]))}function J(e){return Object.prototype.toString.call(e)}function ee(e){return J(e)===Xn}function te(e){return J(e)===Wn}function ne(e){return J(e)===$n}function re(e){return J(e)===Kn}function ie(e){if(!e)return!1;var t=J(e);return Qn.indexOf(t)>=0||(Q(e)||Z(e)||I(e))}function oe(e){return 0|Re[Object.prototype.toString.call(e)]}function ae(e,t){var n=t.length;switch(e.type){case vn:case yn:case bn:case gn:var r=ct.allocType(e.type,n);r.set(t),e.data=r;break;case nn:e.data=W(t);break;default:Xe.raise("unsupported texture type, must specify a typed array")}}function ue(e,t){return ct.allocType(e.type===nn?gn:e.type,t)}function fe(e,t){e.type===nn?(e.data=W(t),ct.freeType(t)):e.data=t}function ce(e,t,n,r,i,o){for(var a=e.width,u=e.height,f=e.channels,c=ue(e,a*u*f),s=0,l=0;l<u;++l)for(var d=0;d<a;++d)for(var p=0;p<f;++p)c[s++]=t[n*d+r*l+i*p+o];fe(e,c)}function se(e,t,n,r,i,o){var a;if(a=void 0!==Jn[e]?Jn[e]:qn[e]*Zn[t],o&&(a*=6),i){for(var u=0,f=n;f>=1;)u+=a*f*f,f/=2;return u}return a*n*r}function le(e,t,n,i,o,a,u){function f(){this.internalformat=Ft,this.format=Ft,this.type=vn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=0}function c(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function s(e,i){if("object"===(void 0===i?"undefined":r(i))&&i){if("premultiplyAlpha"in i&&(Xe.type(i.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=i.premultiplyAlpha),"flipY"in i&&(Xe.type(i.flipY,"boolean","invalid texture flip"),e.flipY=i.flipY),"alignment"in i&&(Xe.oneOf(i.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=i.alignment),"colorSpace"in i&&(Xe.parameter(i.colorSpace,D,"invalid colorSpace"),e.colorSpace=D[i.colorSpace]),"type"in i){var o=i.type;Xe(t.oes_texture_float||!("float"===o||"float32"===o),"you must enable the OES_texture_float extension in order to use floating point textures."),Xe(t.oes_texture_half_float||!("half float"===o||"float16"===o),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Xe(t.webgl_depth_texture||!("uint16"===o||"uint32"===o||"depth stencil"===o),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Xe.parameter(o,V,"invalid texture type"),e.type=V[o]}var a=e.width,u=e.height,f=e.channels,c=!1;"shape"in i?(Xe(Array.isArray(i.shape)&&i.shape.length>=2,"shape must be an array"),a=i.shape[0],u=i.shape[1],3===i.shape.length&&(f=i.shape[2],Xe(f>0&&f<=4,"invalid number of channels"),c=!0),Xe(a>=0&&a<=n.maxTextureSize,"invalid width"),Xe(u>=0&&u<=n.maxTextureSize,"invalid height")):("radius"in i&&(a=u=i.radius,Xe(a>=0&&a<=n.maxTextureSize,"invalid radius")),"width"in i&&(a=i.width,Xe(a>=0&&a<=n.maxTextureSize,"invalid width")),"height"in i&&(u=i.height,Xe(u>=0&&u<=n.maxTextureSize,"invalid height")),"channels"in i&&(f=i.channels,Xe(f>0&&f<=4,"invalid number of channels"),c=!0)),e.width=0|a,e.height=0|u,e.channels=0|f;var s=!1;if("format"in i){var l=i.format;Xe(t.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Xe.parameter(l,G,"invalid texture format");var d=e.internalformat=G[l];e.format=X[d],l in V&&("type"in i||(e.type=V[l])),l in N&&(e.compressed=!0),s=!0}!c&&s?e.channels=qn[e.format]:c&&!s?e.channels!==Hn[e.format]&&(e.format=e.internalformat=Hn[e.channels]):s&&c&&Xe(e.channels===qn[e.format],"number of channels inconsistent with specified format")}}function l(t){e.pixelStorei(Nn,t.flipY),e.pixelStorei(Fn,t.premultiplyAlpha),e.pixelStorei(Bn,t.colorSpace),e.pixelStorei(Gn,t.unpackAlignment)}function d(){f.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(e,t){var r=null;if(ie(t)?r=t:t&&(Xe.type(t,"object","invalid pixel data type"),s(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),ie(t.data)&&(r=t.data)),Xe(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){Xe(!r,"can not specify copy and data field for the same texture");var i=o.viewportWidth,a=o.viewportHeight;e.width=e.width||i-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,Xe(e.xOffset>=0&&e.xOffset<i&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=i&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(r){if(ke(r))e.channels=e.channels||4,e.data=r,"type"in t||e.type!==vn||(e.type=oe(r));else if(Q(r))e.channels=e.channels||4,ae(e,r),e.alignment=1,e.needsFree=!0;else if(I(r)){var u=r.data;Array.isArray(u)||e.type!==vn||(e.type=oe(u));var f,c,l,d,p,m,h=r.shape,v=r.stride;3===h.length?(l=h[2],m=v[2]):(Xe(2===h.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,m=1),f=h[0],c=h[1],d=v[0],p=v[1],e.alignment=1,e.width=f,e.height=c,e.channels=l,e.format=e.internalformat=Hn[l],e.needsFree=!0,ce(e,u,d,p,m,r.offset)}else if(ee(r)||te(r))ee(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(ne(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(re(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(Z(r)){var y=e.width||r[0].length,b=e.height||r.length,g=e.channels;g=$(r[0][0])?g||r[0][0].length:g||1;for(var _=st.shape(r),x=1,S=0;S<_.length;++S)x*=_[S];var A=ue(e,x);st.flatten(r,_,"",A),fe(e,A),e.alignment=1,e.width=y,e.height=b,e.channels=g,e.format=e.internalformat=Hn[g],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===gn?Xe(n.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===nn&&Xe(n.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function m(t,n,r){var o=t.element,a=t.data,u=t.internalformat,f=t.format,c=t.type,s=t.width,d=t.height;l(t),o?e.texImage2D(n,r,f,f,c,o):t.compressed?e.compressedTexImage2D(n,r,u,s,d,0,a):t.needsCopy?(i(),e.copyTexImage2D(n,r,f,t.xOffset,t.yOffset,s,d,0)):e.texImage2D(n,r,f,s,d,0,f,c,a)}function h(t,n,r,o,a){var u=t.element,f=t.data,c=t.internalformat,s=t.format,d=t.type,p=t.width,m=t.height;l(t),u?e.texSubImage2D(n,a,r,o,s,d,u):t.compressed?e.compressedTexSubImage2D(n,a,r,o,c,p,m,f):t.needsCopy?(i(),e.copyTexSubImage2D(n,a,r,o,t.xOffset,t.yOffset,p,m)):e.texSubImage2D(n,a,r,o,p,m,s,d,f)}function v(){return W.pop()||new d}function y(e){e.needsFree&&ct.freeType(e.data),d.call(e),W.push(e)}function b(){f.call(this),this.genMipmaps=!1,this.mipmapHint=Pn,this.mipmask=0,this.images=Array(16)}function g(e,t,n){var r=e.images[0]=v();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function _(e,t){var n=null;if(ie(t))c(n=e.images[0]=v(),e),p(n,t),e.mipmask=1;else if(s(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)c(n=e.images[i]=v(),e),n.width>>=i,n.height>>=i,p(n,r[i]),e.mipmask|=1<<i;else c(n=e.images[0]=v(),e),p(n,t),e.mipmask=1;c(e,e.images[0]),(e.compressed&&e.internalformat===rn||e.internalformat===on||e.internalformat===an||e.internalformat===un)&&Xe(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function x(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;m(n[r],t,r)}}function S(){var e=K.pop()||new b;f.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function A(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&y(t[n]),t[n]=null;K.push(e)}function O(){this.minFilter=Ln,this.magFilter=Ln,this.wrapS=An,this.wrapT=An,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Pn}function E(e,t){if("min"in t){var i=t.min;Xe.parameter(i,C),e.minFilter=C[i],Yn.indexOf(e.minFilter)>=0&&(e.genMipmaps=!0)}if("mag"in t){var o=t.mag;Xe.parameter(o,P),e.magFilter=P[o]}var a=e.wrapS,u=e.wrapT;if("wrap"in t){var f=t.wrap;"string"==typeof f?(Xe.parameter(f,k),a=u=k[f]):Array.isArray(f)&&(Xe.parameter(f[0],k),Xe.parameter(f[1],k),a=k[f[0]],u=k[f[1]])}else{if("wrapS"in t){var c=t.wrapS;Xe.parameter(c,k),a=k[c]}if("wrapT"in t){var s=t.wrapT;Xe.parameter(s,k),u=k[s]}}if(e.wrapS=a,e.wrapT=u,"anisotropic"in t){var l=t.anisotropic;Xe("number"==typeof l&&l>=1&&l<=n.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var d=!1;switch(r(t.mipmap)){case"string":Xe.parameter(t.mipmap,R,"invalid mipmap hint"),e.mipmapHint=R[t.mipmap],e.genMipmaps=!0,d=!0;break;case"boolean":d=e.genMipmaps=t.mipmap;break;case"object":Xe(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,d=!0;break;default:Xe.raise("invalid mipmap type")}!d||"min"in t||(e.minFilter=jn)}}function w(n,r){e.texParameteri(r,wn,n.minFilter),e.texParameteri(r,En,n.magFilter),e.texParameteri(r,_n,n.wrapS),e.texParameteri(r,xn,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,Vn,n.anisotropic),n.genMipmaps&&(e.hint(In,n.mipmapHint),e.generateMipmap(r))}function L(t){f.call(this),this.mipmask=0,this.internalformat=Ft,this.id=J++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new O,u.profile&&(this.stats={size:0})}function M(t){e.activeTexture(zn),e.bindTexture(t.target,t.texture)}function j(){var t=pe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(Vt,null)}function T(t){var n=t.texture;Xe(n,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(e.activeTexture(zn+r),e.bindTexture(i,null),pe[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete le[t.id],a.textureCount--}var R={"don't care":Pn,"dont care":Pn,nice:Dn,fast:Cn},k={repeat:Sn,clamp:An,mirror:On},P={nearest:Ln,linear:Mn},C=Ie({mipmap:kn,"nearest mipmap nearest":jn,"linear mipmap nearest":Tn,"nearest mipmap linear":Rn,"linear mipmap linear":kn},P),D={none:0,browser:Un},V={uint8:vn,rgba4:Wt,rgb565:Kt,"rgb5 a1":$t},G={alpha:Bt,luminance:zt,"luminance alpha":Yt,rgb:Ut,rgba:Ft,rgba4:Ht,"rgb5 a1":qt,rgb565:Xt},N={};t.ext_srgb&&(G.srgb=en,G.srgba=tn),t.oes_texture_float&&(V.float32=V.float=gn),t.oes_texture_half_float&&(V.float16=V["half float"]=nn),t.webgl_depth_texture&&(Ie(G,{depth:Zt,"depth stencil":Jt}),Ie(V,{uint16:yn,uint32:bn,"depth stencil":Qt})),t.webgl_compressed_texture_s3tc&&Ie(N,{"rgb s3tc dxt1":rn,"rgba s3tc dxt1":on,"rgba s3tc dxt3":an,"rgba s3tc dxt5":un}),t.webgl_compressed_texture_atc&&Ie(N,{"rgb atc":fn,"rgba atc explicit alpha":cn,"rgba atc interpolated alpha":sn}),t.webgl_compressed_texture_pvrtc&&Ie(N,{"rgb pvrtc 4bppv1":ln,"rgb pvrtc 2bppv1":dn,"rgba pvrtc 4bppv1":pn,"rgba pvrtc 2bppv1":mn}),t.webgl_compressed_texture_etc1&&(N["rgb etc1"]=hn);var F=Array.prototype.slice.call(e.getParameter(Dt));Object.keys(N).forEach(function(e){var t=N[e];F.indexOf(t)>=0&&(G[e]=t)});var B=Object.keys(G);n.textureFormats=B;var U=[];Object.keys(G).forEach(function(e){var t=G[e];U[t]=e});var z=[];Object.keys(V).forEach(function(e){var t=V[e];z[t]=e});var Y=[];Object.keys(P).forEach(function(e){var t=P[e];Y[t]=e});var H=[];Object.keys(C).forEach(function(e){var t=C[e];H[t]=e});var q=[];Object.keys(k).forEach(function(e){var t=k[e];q[t]=e});var X=B.reduce(function(e,t){var n=G[t];return n===zt||n===Bt||n===zt||n===Yt||n===Zt||n===Jt?e[n]=n:n===qt||t.indexOf("rgba")>=0?e[n]=Ft:e[n]=Ut,e},{}),W=[],K=[],J=0,le={},de=n.maxTextureUnits,pe=Array(de).map(function(){return null});return Ie(L.prototype,{bind:function(){var t=this;t.bindCount+=1;var n=t.unit;if(n<0){for(var r=0;r<de;++r){var i=pe[r];if(i){if(i.bindCount>0)continue;i.unit=-1}pe[r]=t,n=r;break}n>=de&&Xe.raise("insufficient number of texture units"),u.profile&&a.maxTextureUnits<n+1&&(a.maxTextureUnits=n+1),t.unit=n,e.activeTexture(zn+n),e.bindTexture(t.target,t.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&T(this)}}),u.profile&&(a.getTotalTextureSize=function(){var e=0;return Object.keys(le).forEach(function(t){e+=le[t].stats.size}),e}),{create2D:function(t,r){function i(e,t){var r=o.texInfo;O.call(r);var a=S();return"number"==typeof e?"number"==typeof t?g(a,0|e,0|t):g(a,0|e,0|e):e?(Xe.type(e,"object","invalid arguments to regl.texture"),E(r,e),_(a,e)):g(a,1,1),r.genMipmaps&&(a.mipmask=(a.width<<1)-1),o.mipmask=a.mipmask,c(o,a),Xe.texture2D(r,a,n),o.internalformat=a.internalformat,i.width=a.width,i.height=a.height,M(o),x(a,Vt),w(r,Vt),j(),A(a),u.profile&&(o.stats.size=se(o.internalformat,o.type,a.width,a.height,r.genMipmaps,!1)),i.format=U[o.internalformat],i.type=z[o.type],i.mag=Y[r.magFilter],i.min=H[r.minFilter],i.wrapS=q[r.wrapS],i.wrapT=q[r.wrapT],i}var o=new L(Vt);return le[o.id]=o,a.textureCount++,i(t,r),i.subimage=function(e,t,n,r){Xe(!!e,"must specify image data");var a=0|t,u=0|n,f=0|r,s=v();return c(s,o),s.width=0,s.height=0,p(s,e),s.width=s.width||(o.width>>f)-a,s.height=s.height||(o.height>>f)-u,Xe(o.type===s.type&&o.format===s.format&&o.internalformat===s.internalformat,"incompatible format for texture.subimage"),Xe(a>=0&&u>=0&&a+s.width<=o.width&&u+s.height<=o.height,"texture.subimage write out of bounds"),Xe(o.mipmask&1<<f,"missing mipmap data"),Xe(s.data||s.element||s.needsCopy,"missing image data"),M(o),h(s,Vt,a,u,f),j(),y(s),i},i.resize=function(t,n){var r=0|t,a=0|n||r;if(r===o.width&&a===o.height)return i;i.width=o.width=r,i.height=o.height=a,M(o);for(var f=0;o.mipmask>>f;++f)e.texImage2D(Vt,f,o.format,r>>f,a>>f,0,o.format,o.type,null);return j(),u.profile&&(o.stats.size=se(o.internalformat,o.type,r,a,!1,!1)),i},i._reglType="texture2d",i._texture=o,u.profile&&(i.stats=o.stats),i.destroy=function(){o.decRef()},i},createCube:function(t,i,o,f,l,d){function m(e,t,i,o,a,f){var l,d=b.texInfo;for(O.call(d),l=0;l<6;++l)T[l]=S();if("number"!=typeof e&&e)if("object"===(void 0===e?"undefined":r(e)))if(t)_(T[0],e),_(T[1],t),_(T[2],i),_(T[3],o),_(T[4],a),_(T[5],f);else if(E(d,e),s(b,e),"faces"in e){var p=e.faces;for(Xe(Array.isArray(p)&&6===p.length,"cube faces must be a length 6 array"),l=0;l<6;++l)Xe("object"===r(p[l])&&!!p[l],"invalid input for cube map face"),c(T[l],b),_(T[l],p[l])}else for(l=0;l<6;++l)_(T[l],e);else Xe.raise("invalid arguments to cube map");else{var h=0|e||1;for(l=0;l<6;++l)g(T[l],h,h)}for(c(b,T[0]),d.genMipmaps?b.mipmask=(T[0].width<<1)-1:b.mipmask=T[0].mipmask,Xe.textureCube(b,d,T,n),b.internalformat=T[0].internalformat,m.width=T[0].width,m.height=T[0].height,M(b),l=0;l<6;++l)x(T[l],Nt+l);for(w(d,Gt),j(),u.profile&&(b.stats.size=se(b.internalformat,b.type,m.width,m.height,d.genMipmaps,!0)),m.format=U[b.internalformat],m.type=z[b.type],m.mag=Y[d.magFilter],m.min=H[d.minFilter],m.wrapS=q[d.wrapS],m.wrapT=q[d.wrapT],l=0;l<6;++l)A(T[l]);return m}var b=new L(Gt);le[b.id]=b,a.cubeCount++;var T=new Array(6);return m(t,i,o,f,l,d),m.subimage=function(e,t,n,r,i){Xe(!!t,"must specify image data"),Xe("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,u=0|i,f=v();return c(f,b),f.width=0,f.height=0,p(f,t),f.width=f.width||(b.width>>u)-o,f.height=f.height||(b.height>>u)-a,Xe(b.type===f.type&&b.format===f.format&&b.internalformat===f.internalformat,"incompatible format for texture.subimage"),Xe(o>=0&&a>=0&&o+f.width<=b.width&&a+f.height<=b.height,"texture.subimage write out of bounds"),Xe(b.mipmask&1<<u,"missing mipmap data"),Xe(f.data||f.element||f.needsCopy,"missing image data"),M(b),h(f,Nt+e,o,a,u),j(),y(f),m},m.resize=function(t){var n=0|t;if(n!==b.width){m.width=b.width=n,m.height=b.height=n,M(b);for(var r=0;r<6;++r)for(var i=0;b.mipmask>>i;++i)e.texImage2D(Nt+r,i,b.format,n>>i,n>>i,0,b.format,b.type,null);return j(),u.profile&&(b.stats.size=se(b.internalformat,b.type,m.width,m.height,!1,!0)),m}},m._reglType="textureCube",m._texture=b,u.profile&&(m.stats=b.stats),m.destroy=function(){b.decRef()},m},clear:function(){for(var t=0;t<de;++t)e.activeTexture(zn+t),e.bindTexture(Vt,null),pe[t]=null;et(le).forEach(T),a.cubeCount=0,a.textureCount=0},getTexture:function(e){return null},restore:function(){et(le).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;n<32;++n)if(0!=(t.mipmask&1<<n))if(t.target===Vt)e.texImage2D(Vt,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)e.texImage2D(Nt+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);w(t.texInfo,t.target)})}}}function de(e,t,n){return nr[e]*t*n}function pe(e,t,n,i,o,a){function u(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function f(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function c(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);Xe(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;Xe(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function s(t,n){n&&(n.texture?e.framebufferTexture2D(ir,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(ir,t,or,n.renderbuffer._renderbuffer.renderbuffer))}function l(e){var t=ar,n=null,i=null,o=e;"object"===(void 0===e?"undefined":r(e))&&(o=e.data,"target"in e&&(t=0|e.target)),Xe.type(o,"function","invalid attachment data");var a=o._reglType;return"texture2d"===a?(n=o,Xe(t===ar)):"textureCube"===a?(n=o,Xe(t>=ur&&t<ur+6,"invalid cube map target")):"renderbuffer"===a?(i=o,t=or):Xe.raise("invalid regl object for attachment"),new u(t,n,i)}function d(e,t,n,r,a){if(n){var f=i.create2D({width:e,height:t,format:r,type:a});return f._texture.refCount=0,new u(ar,f,null)}var c=o.create({width:e,height:t,format:r});return c._renderbuffer.refCount=0,new u(or,null,c)}function p(e){return e&&(e.texture||e.renderbuffer)}function m(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function h(){this.id=O++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function v(e){e.colorAttachments.forEach(f),f(e.depthAttachment),f(e.stencilAttachment),f(e.depthStencilAttachment)}function y(t){var n=t.framebuffer;Xe(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete E[t.id]}function b(t){var r;e.bindFramebuffer(ir,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)s(fr+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(ir,fr+r,ar,null,0);e.framebufferTexture2D(ir,lr,ar,null,0),e.framebufferTexture2D(ir,cr,ar,null,0),e.framebufferTexture2D(ir,sr,ar,null,0),s(cr,t.depthAttachment),s(sr,t.stencilAttachment),s(lr,t.depthStencilAttachment);var o=e.checkFramebufferStatus(ir);o!==dr&&Xe.raise("framebuffer configuration not supported, status = "+xr[o]),e.bindFramebuffer(ir,_.next),_.cur=_.next,e.getError()}function g(e,r){function i(e,r){var a;Xe(_.next!==o,"can not update framebuffer which is currently in use");var u=t.webgl_draw_buffers,f=0,s=0,m=!0,h=!0,y=null,g=!0,O="rgba",E="uint8",w=1,L=null,M=null,j=null,T=!1;if("number"==typeof e)f=0|e,s=0|r||f;else if(e){Xe.type(e,"object","invalid arguments for framebuffer");var R=e;if("shape"in R){var k=R.shape;Xe(Array.isArray(k)&&k.length>=2,"invalid shape for framebuffer"),f=k[0],s=k[1]}else"radius"in R&&(f=s=R.radius),"width"in R&&(f=R.width),"height"in R&&(s=R.height);("color"in R||"colors"in R)&&(y=R.color||R.colors,Array.isArray(y)&&Xe(1===y.length||u,"multiple render targets not supported")),y||("colorCount"in R&&(w=0|R.colorCount,Xe(w>0,"invalid color buffer count")),"colorTexture"in R&&(g=!!R.colorTexture,O="rgba4"),"colorType"in R&&(E=R.colorType,g?(Xe(t.oes_texture_float||!("float"===E||"float32"===E),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Xe(t.oes_texture_half_float||!("half float"===E||"float16"===E),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===E||"float16"===E?(Xe(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),O="rgba16f"):"float"!==E&&"float32"!==E||(Xe(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),O="rgba32f"),Xe.oneOf(E,A,"invalid color type")),"colorFormat"in R&&(O=R.colorFormat,x.indexOf(O)>=0?g=!0:S.indexOf(O)>=0?g=!1:g?Xe.oneOf(R.colorFormat,x,"invalid color format for texture"):Xe.oneOf(R.colorFormat,S,"invalid color format for renderbuffer"))),("depthTexture"in R||"depthStencilTexture"in R)&&(T=!(!R.depthTexture&&!R.depthStencilTexture),Xe(!T||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in R&&("boolean"==typeof R.depth?m=R.depth:(L=R.depth,h=!1)),"stencil"in R&&("boolean"==typeof R.stencil?h=R.stencil:(M=R.stencil,m=!1)),"depthStencil"in R&&("boolean"==typeof R.depthStencil?m=h=R.depthStencil:(j=R.depthStencil,m=!1,h=!1))}else f=s=1;var I=null,P=null,C=null,D=null;if(Array.isArray(y))I=y.map(l);else if(y)I=[l(y)];else for(I=new Array(w),a=0;a<w;++a)I[a]=d(f,s,g,O,E);Xe(t.webgl_draw_buffers||I.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Xe(I.length<=n.maxColorAttachments,"too many color attachments, not supported"),f=f||I[0].width,s=s||I[0].height,L?P=l(L):m&&!h&&(P=d(f,s,T,"depth","uint32")),M?C=l(M):h&&!m&&(C=d(f,s,!1,"stencil","uint8")),j?D=l(j):!L&&!M&&h&&m&&(D=d(f,s,T,"depth stencil","depth stencil")),Xe(!!L+!!M+!!j<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var V=null;for(a=0;a<I.length;++a)if(c(I[a],f,s),Xe(!I[a]||I[a].texture&&mr.indexOf(I[a].texture._texture.format)>=0||I[a].renderbuffer&&_r.indexOf(I[a].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+a+" is invalid"),I[a]&&I[a].texture){var G=hr[I[a].texture._texture.format]*vr[I[a].texture._texture.type];null===V?V=G:Xe(V===G,"all color attachments much have the same number of bits per pixel.")}return c(P,f,s),Xe(!P||P.texture&&P.texture._texture.format===pr||P.renderbuffer&&P.renderbuffer._renderbuffer.format===yr,"invalid depth attachment for framebuffer object"),c(C,f,s),Xe(!C||C.renderbuffer&&C.renderbuffer._renderbuffer.format===br,"invalid stencil attachment for framebuffer object"),c(D,f,s),Xe(!D||D.texture&&D.texture._texture.format===gr||D.renderbuffer&&D.renderbuffer._renderbuffer.format===gr,"invalid depth-stencil attachment for framebuffer object"),v(o),o.width=f,o.height=s,o.colorAttachments=I,o.depthAttachment=P,o.stencilAttachment=C,o.depthStencilAttachment=D,i.color=I.map(p),i.depth=p(P),i.stencil=p(C),i.depthStencil=p(D),i.width=o.width,i.height=o.height,b(o),i}var o=new h;return a.framebufferCount++,i(e,r),Ie(i,{resize:function(e,t){Xe(_.next!==o,"can not resize a framebuffer which is currently in use");var n=0|e,r=0|t||n;if(n===o.width&&r===o.height)return i;for(var a=o.colorAttachments,u=0;u<a.length;++u)m(a[u],n,r);return m(o.depthAttachment,n,r),m(o.stencilAttachment,n,r),m(o.depthStencilAttachment,n,r),o.width=i.width=n,o.height=i.height=r,b(o),i},_reglType:"framebuffer",_framebuffer:o,destroy:function(){y(o),v(o)},use:function(e){_.setFBO({framebuffer:i},e)}})}var _={cur:null,next:null,dirty:!1,setFBO:null},x=["rgba"],S=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&S.push("srgba"),t.ext_color_buffer_half_float&&S.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&S.push("rgba32f");var A=["uint8"];t.oes_texture_half_float&&A.push("half float","float16"),t.oes_texture_float&&A.push("float","float32");var O=0,E={};return Ie(_,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof h)return t}return null},create:g,createCube:function(e){function r(e){var n;Xe(o.indexOf(_.next)<0,"can not update framebuffer which is currently in use");var a=t.webgl_draw_buffers,u={color:null},f=0,c=null,s="rgba",l="uint8",d=1;if("number"==typeof e)f=0|e;else if(e){Xe.type(e,"object","invalid arguments for framebuffer");var p=e;if("shape"in p){var m=p.shape;Xe(Array.isArray(m)&&m.length>=2,"invalid shape for framebuffer"),Xe(m[0]===m[1],"cube framebuffer must be square"),f=m[0]}else"radius"in p&&(f=0|p.radius),"width"in p?(f=0|p.width,"height"in p&&Xe(p.height===f,"must be square")):"height"in p&&(f=0|p.height);("color"in p||"colors"in p)&&(c=p.color||p.colors,Array.isArray(c)&&Xe(1===c.length||a,"multiple render targets not supported")),c||("colorCount"in p&&(d=0|p.colorCount,Xe(d>0,"invalid color buffer count")),"colorType"in p&&(Xe.oneOf(p.colorType,A,"invalid color type"),l=p.colorType),"colorFormat"in p&&(s=p.colorFormat,Xe.oneOf(p.colorFormat,x,"invalid color format for texture"))),"depth"in p&&(u.depth=p.depth),"stencil"in p&&(u.stencil=p.stencil),"depthStencil"in p&&(u.depthStencil=p.depthStencil)}else f=1;var h;if(c)if(Array.isArray(c))for(h=[],n=0;n<c.length;++n)h[n]=c[n];else h=[c];else{h=Array(d);var v={radius:f,format:s,type:l};for(n=0;n<d;++n)h[n]=i.createCube(v)}for(u.color=Array(h.length),n=0;n<h.length;++n){var y=h[n];Xe("function"==typeof y&&"textureCube"===y._reglType,"invalid cube map"),f=f||y.width,Xe(y.width===f&&y.height===f,"invalid cube map shape"),u.color[n]={target:ur,data:h[n]}}for(n=0;n<6;++n){for(var b=0;b<h.length;++b)u.color[b].target=ur+n;n>0&&(u.depth=o[0].depth,u.stencil=o[0].stencil,u.depthStencil=o[0].depthStencil),o[n]?o[n](u):o[n]=g(u)}return Ie(r,{width:f,height:f,color:h})}var o=Array(6);return r(e),Ie(r,{faces:o,resize:function(e){var t,i=0|e;if(Xe(i>0&&i<=n.maxCubeMapSize,"invalid radius for cube fbo"),i===r.width)return r;var a=r.color;for(t=0;t<a.length;++t)a[t].resize(i);for(t=0;t<6;++t)o[t].resize(i);return r.width=r.height=i,r},_reglType:"framebufferCube",destroy:function(){o.forEach(function(e){e.destroy()})}})},clear:function(){et(E).forEach(y)},restore:function(){et(E).forEach(function(t){t.framebuffer=e.createFramebuffer(),b(t)})}})}function me(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Sr,this.offset=0,this.stride=0,this.divisor=0}function he(e,t,n,r,i){for(var o=n.maxAttributes,a=new Array(o),u=0;u<o;++u)a[u]=new me;return{Record:me,scope:{},state:a}}function ve(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){var o=n===Ar?c:s,a=o[r];if(!a){var u=t.str(r);a=e.createShader(n),e.shaderSource(a,u),e.compileShader(a),Xe.shaderError(e,a,u,n,i),o[r]=a}return a}function u(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function f(n,u){var f,c,s=a(Ar,n.fragId),l=a(Or,n.vertId),d=n.program=e.createProgram();e.attachShader(d,s),e.attachShader(d,l),e.linkProgram(d),Xe.linkError(e,d,t.str(n.fragId),t.str(n.vertId),u);var p=e.getProgramParameter(d,Er);r.profile&&(n.stats.uniformsCount=p);var m=n.uniforms;for(f=0;f<p;++f)if(c=e.getActiveUniform(d,f))if(c.size>1)for(var h=0;h<c.size;++h){var v=c.name.replace("[0]","["+h+"]");o(m,new i(v,t.id(v),e.getUniformLocation(d,v),c))}else o(m,new i(c.name,t.id(c.name),e.getUniformLocation(d,c.name),c));var y=e.getProgramParameter(d,wr);r.profile&&(n.stats.attributesCount=y);var b=n.attributes;for(f=0;f<y;++f)(c=e.getActiveAttrib(d,f))&&o(b,new i(c.name,t.id(c.name),e.getAttribLocation(d,c.name),c))}var c={},s={},l={},d=[],p=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return d.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return d.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);et(c).forEach(t),c={},et(s).forEach(t),s={},d.forEach(function(t){e.deleteProgram(t.program)}),d.length=0,l={},n.shaderCount=0},program:function(e,t,r){Xe.command(e>=0,"missing vertex shader",r),Xe.command(t>=0,"missing fragment shader",r);var i=l[t];i||(i=l[t]={});var o=i[e];return o||(o=new u(t,e),n.shaderCount++,f(o,r),i[e]=o,d.push(o)),o},restore:function(){c={},s={};for(var e=0;e<d.length;++e)f(d[e])},shader:a,frag:-1,vert:-1}}function ye(e,t,n,r,i,o){function a(a){var u;null===t.next?(Xe(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=Mr):(Xe(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=t.next.colorAttachments[0].texture._texture.type,o.oes_texture_float?Xe(u===Mr||u===Tr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):Xe(u===Mr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var f=0,c=0,s=r.framebufferWidth,l=r.framebufferHeight,d=null;ke(a)?d=a:a&&(Xe.type(a,"object","invalid arguments to regl.read()"),f=0|a.x,c=0|a.y,Xe(f>=0&&f<r.framebufferWidth,"invalid x offset for regl.read"),Xe(c>=0&&c<r.framebufferHeight,"invalid y offset for regl.read"),s=0|(a.width||r.framebufferWidth-f),l=0|(a.height||r.framebufferHeight-c),d=a.data||null),d&&(u===Mr?Xe(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===Tr&&Xe(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Xe(s>0&&s+f<=r.framebufferWidth,"invalid width for read pixels"),Xe(l>0&&l+c<=r.framebufferHeight,"invalid height for read pixels"),n();var p=s*l*4;return d||(u===Mr?d=new Uint8Array(p):u===Tr&&(d=d||new Float32Array(p))),Xe.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),Xe(d.byteLength>=p,"data buffer for regl.read() too small"),e.pixelStorei(jr,4),e.readPixels(f,c,s,l,Lr,u,d),d}function u(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}return function(e){return e&&"framebuffer"in e?u(e):a(e)}}function be(e,t,n,r){function i(e){this.id=-1,this.handle=null,o&&(this.handle=o.createVertexArrayOES(),this.handle&&(this.id=u++)),this.bind=function(){o&&this.handle&&o.bindVertexArrayOES(this.handle)},this.unbind=function(){o&&o.bindVertexArrayOES(null)},this.destroy=function(){o&&this.handle&&(o.deleteVertexArrayOES(this.handle),u=Math.max(0,u-1),n.vaoCount=u,this.id=-1,this.handle=null)}}var o=t.oes_vertex_array_object,a=null,u=0,f={};return{getShared:function(){return a},hasSupport:Boolean(o),create:function(){var t=new i(e);return f[t.id]=t,n.vaoCount=u,a=t,t},clear:function(){et(f).forEach(function(e){e&&"function"==typeof e.destroy&&e.destroy()})}}}function ge(e){return Array.prototype.slice.call(e)}function _e(e){return ge(e).join("")}function xe(){function e(){var e=[],t=[];return Ie(function(){e.push.apply(e,ge(arguments))},{def:function(){var r="v"+n++;return t.push(r),arguments.length>0&&(e.push(r,"="),e.push.apply(e,ge(arguments)),e.push(";")),r},toString:function(){return _e([t.length>0?"var "+t+";":"",_e(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),i=n.toString,o=r.toString;return Ie(function(){n.apply(n,ge(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=e(),a={};return{global:o,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return r[t];var o="g"+n++;return r.push(o),i.push(e),o},block:e,proc:function(e,n){function r(){var e="a"+i.length;return i.push(e),e}var i=[];n=n||0;for(var o=0;o<n;++o)r();var u=t(),f=u.toString;return a[e]=Ie(u,{arg:r,toString:function(){return _e(["function(",i.join(),"){",f(),"}"])}})},scope:t,cond:function(){var e=_e(arguments),n=t(),r=t(),i=n.toString,o=r.toString;return Ie(n,{then:function(){return n.apply(n,ge(arguments)),this},else:function(){return r.apply(r,ge(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),_e(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=_e(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,i)}}}function Se(e){return Array.isArray(e)||ke(e)||I(e)}function Ae(e){return e.sort(function(e,t){return e===di?-1:t===di?1:e<t?-1:1})}function Oe(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function Ee(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function we(e){return new Oe(!1,!1,!1,e)}function Le(e,t){var n=e.type;if(n===Cr){var r=e.data.length;return new Oe(!0,r>=1,r>=2,t)}if(n===Nr){var i=e.data;return new Oe(i.thisDep,i.contextDep,i.propDep,t)}return new Oe(n===Gr,n===Vr,n===Dr,t)}function Me(e,t,n,i,o,a,u,f,c,s,l,d,p,m,h,v){function y(e){return e.replace(".","_")}function b(e,t,n){var r=y(e);re.push(e),ne[r]=te[r]=!!n,ie[r]=t}function g(e,t,n){var r=y(e);re.push(e),Array.isArray(n)?(te[r]=n.slice(),ne[r]=n.slice()):te[r]=ne[r]=n,oe[r]=t}function _(){var e=xe(),n=e.link,r=e.global;e.id=fe++,e.batchId="0";var i=n(ae),o=e.shared={props:"a0"};Object.keys(ae).forEach(function(e){o[e]=r.def(i,".",e)}),Xe.optional(function(){e.CHECK=n(Xe),e.commandStr=Xe.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},ue.invalidBlendCombinations=So});var a=e.next={},u=e.current={};Object.keys(oe).forEach(function(e){Array.isArray(te[e])&&(a[e]=r.def(o.next,".",e),u[e]=r.def(o.current,".",e))});var f=e.constants={};Object.keys(ue).forEach(function(e){f[e]=r.def(JSON.stringify(ue[e]))}),e.invoke=function(t,r){switch(r.type){case Cr:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case Dr:return t.def(o.props,r.data);case Vr:return t.def(o.context,r.data);case Gr:return t.def("this",r.data);case Nr:return r.data.append(e,t),r.data.ref}},e.attribCache={};var c={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in c)return c[r];var i=l.scope[r];return i||(i=l.scope[r]=new Q),c[r]=n(i)},e}function x(e){var t,n=e.static,r=e.dynamic;if(pi in n){var i=!!n[pi];(t=we(function(e,t){return i})).enable=i}else if(pi in r){var o=r[pi];t=Le(o,function(e,t){return e.invoke(t,o)})}return t}function S(e,t){var n=e.static,r=e.dynamic;if(mi in n){var i=n[mi];return i?(i=c.getFramebuffer(i),Xe.command(i,"invalid framebuffer object"),we(function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+Si,n+".width"),t.set(o,"."+Ai,n+".height"),n})):we(function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+Si,r+"."+wi),t.set(r,"."+Ai,r+"."+Li),"null"})}if(mi in r){var o=r[mi];return Le(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");Xe.optional(function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")}),t.set(i,".next",a);var u=r.context;return t.set(u,"."+Si,a+"?"+a+".width:"+u+"."+wi),t.set(u,"."+Ai,a+"?"+a+".height:"+u+"."+Li),a})}return null}function A(e,t,n){function r(e){if(e in i){var r=i[e];Xe.commandType(r,"object","invalid "+e,n.commandStr);var a,u,f=!0,c=0|r.x,s=0|r.y;return"width"in r?(a=0|r.width,Xe.command(a>=0,"invalid "+e,n.commandStr)):f=!1,"height"in r?(u=0|r.height,Xe.command(u>=0,"invalid "+e,n.commandStr)):f=!1,new Oe(!f&&t&&t.thisDep,!f&&t&&t.contextDep,!f&&t&&t.propDep,function(e,t){var n=e.shared.context,i=a;"width"in r||(i=t.def(n,".",Si,"-",c));var o=u;return"height"in r||(o=t.def(n,".",Ai,"-",s)),[c,s,i,o]})}if(e in o){var l=o[e],d=Le(l,function(t,n){var r=t.invoke(n,l);Xe.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),u=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",Si,"-",o,")"),f=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",Ai,"-",a,")");return Xe.optional(function(){t.assert(n,u+">=0&&"+f+">=0","invalid "+e)}),[o,a,u,f]});return t&&(d.thisDep=d.thisDep||t.thisDep,d.contextDep=d.contextDep||t.contextDep,d.propDep=d.propDep||t.propDep),d}return t?new Oe(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",Si),t.def(n,".",Ai)]}):null}var i=e.static,o=e.dynamic,a=r(di);if(a){var u=a;a=new Oe(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=u.append(e,t),r=e.shared.context;return t.set(r,"."+Oi,n[2]),t.set(r,"."+Ei,n[3]),n})}return{viewport:a,scissor_box:r(li)}}function O(e){function n(e){if(e in i){var n=t.id(i[e]);Xe.optional(function(){d.shader(Eo[e],n,Xe.guessCommand())});var r=we(function(){return n});return r.id=n,r}if(e in o){var a=o[e];return Le(a,function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return Xe.optional(function(){n(t.shared.shader,".shader(",Eo[e],",",i,",",t.command,");")}),i})}return null}var r,i=e.static,o=e.dynamic,a=n(vi),u=n(hi),f=null;return Ee(a)&&Ee(u)?(f=d.program(u.id,a.id),r=we(function(e,t){return e.link(f)})):r=new Oe(a&&a.thisDep||u&&u.thisDep,a&&a.contextDep||u&&u.contextDep,a&&a.propDep||u&&u.propDep,function(e,t){var n,r=e.shared.shader;n=a?a.append(e,t):t.def(r,".",vi);var i,o=r+".program("+(i=u?u.append(e,t):t.def(r,".",hi))+","+n;return Xe.optional(function(){o+=","+e.command}),t.def(o+")")}),{frag:a,vert:u,progVar:r,program:f}}function E(e,t){function n(e,n){if(e in r){var a=0|r[e];return Xe.command(!n||a>=0,"invalid "+e,t.commandStr),we(function(e,t){return n&&(e.OFFSET=a),a})}if(e in i){var u=i[e];return Le(u,function(t,r){var i=t.invoke(r,u);return n&&(t.OFFSET=i,Xe.optional(function(){t.assert(r,i+">=0","invalid "+e)})),i})}return n&&o?we(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,i=e.dynamic,o=function(){if(yi in r){var e=r[yi];Se(e)?e=u.getElements(u.create(e,!0)):e&&(e=u.getElements(e),Xe.command(e,"invalid elements",t.commandStr));var n=we(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null});return n.value=e,n}if(yi in i){var o=i[yi];return Le(o,function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,a=e.invoke(t,o),u=t.def("null"),f=t.def(r,"(",a,")"),c=e.cond(f).then(u,"=",i,".createStream(",a,");").else(u,"=",i,".getElements(",a,");");return Xe.optional(function(){e.assert(c.else,"!"+a+"||"+u,"invalid elements")}),t.entry(c),t.exit(e.cond(f).then(i,".destroyStream(",u,");")),e.ELEMENTS=u,u})}return null}(),a=n(_i,!0);return{elements:o,primitive:function(){if(bi in r){var e=r[bi];return Xe.commandParameter(e,_t,"invalid primitve",t.commandStr),we(function(t,n){return _t[e]})}if(bi in i){var n=i[bi];return Le(n,function(e,t){var r=e.constants.primTypes,i=e.invoke(t,n);return Xe.optional(function(){e.assert(t,i+" in "+r,"invalid primitive, must be one of "+Object.keys(_t))}),t.def(r,"[",i,"]")})}return o?Ee(o)?we(o.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return oo}):new Oe(o.thisDep,o.contextDep,o.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",oo)}):null}(),count:function(){if(gi in r){var e=0|r[gi];return Xe.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),we(function(){return e})}if(gi in i){var n=i[gi];return Le(n,function(e,t){var r=e.invoke(t,n);return Xe.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(o){if(Ee(o)){if(o)return a?new Oe(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return Xe.optional(function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")}),n}):we(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var u=we(function(){return-1});return Xe.optional(function(){u.MISSING=!0}),u}var f=new Oe(o.thisDep||a.thisDep,o.contextDep||a.contextDep,o.propDep||a.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")});return Xe.optional(function(){f.DYNAMIC=!0}),f}return null}(),instances:n(xi,!1),offset:a}}function w(e,t){var n=e.static,o=e.dynamic,a={};return re.forEach(function(e){function u(t,r){if(e in n){var i=t(n[e]);a[f]=we(function(){return i})}else if(e in o){var u=o[e];a[f]=Le(u,function(e,t){return r(e,t,e.invoke(t,u))})}}var f=y(e);switch(e){case Kr:case Br:case Fr:case oi:case Hr:case si:case ei:case ni:case ri:case Wr:return u(function(n){return Xe.commandType(n,"boolean",e,t.commandStr),n},function(t,n,r){return Xe.optional(function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)}),r});case qr:return u(function(n){return Xe.commandParameter(n,Ao,"invalid "+e,t.commandStr),Ao[n]},function(t,n,r){var i=t.constants.compareFuncs;return Xe.optional(function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(Ao))}),n.def(i,"[",r,"]")});case Xr:return u(function(e){return Xe.command($(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,n){return Xe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]});case Yr:return u(function(e){Xe.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return Xe.commandParameter(n,xo,f+".srcRGB",t.commandStr),Xe.commandParameter(r,xo,f+".srcAlpha",t.commandStr),Xe.commandParameter(i,xo,f+".dstRGB",t.commandStr),Xe.commandParameter(o,xo,f+".dstAlpha",t.commandStr),Xe.command(-1===So.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[xo[n],xo[i],xo[r],xo[o]]},function(t,n,r){function i(i,a){var u=n.def('"',i,a,'" in ',r,"?",r,".",i,a,":",r,".",i);return Xe.optional(function(){t.assert(n,u+" in "+o,"invalid "+e+"."+i+a+", must be one of "+Object.keys(xo))}),u}var o=t.constants.blendFuncs;Xe.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var a=i("src","RGB"),u=i("dst","RGB");Xe.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+u+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var f=n.def(o,"[",a,"]"),c=n.def(o,"[",i("src","Alpha"),"]");return[f,n.def(o,"[",u,"]"),c,n.def(o,"[",i("dst","Alpha"),"]")]});case zr:return u(function(n){return"string"==typeof n?(Xe.commandParameter(n,Z,"invalid "+e,t.commandStr),[Z[n],Z[n]]):"object"===(void 0===n?"undefined":r(n))?(Xe.commandParameter(n.rgb,Z,e+".rgb",t.commandStr),Xe.commandParameter(n.alpha,Z,e+".alpha",t.commandStr),[Z[n.rgb],Z[n.alpha]]):void Xe.commandRaise("invalid blend.equation",t.commandStr)},function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),u=t.cond("typeof ",r,'==="string"');return Xe.optional(function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(Z))}n(u.then,e,r),t.assert(u.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(u.else,e+".rgb",r+".rgb"),n(u.else,e+".alpha",r+".alpha")}),u.then(o,"=",a,"=",i,"[",r,"];"),u.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(u),[o,a]});case Ur:return u(function(e){return Xe.command($(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),P(4,function(t){return+e[t]})},function(e,t,n){return Xe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),P(4,function(e){return t.def("+",n,"[",e,"]")})});case ai:return u(function(e){return Xe.commandType(e,"number",f,t.commandStr),0|e},function(e,t,n){return Xe.optional(function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")}),t.def(n,"|0")});case ui:return u(function(n){Xe.commandType(n,"object",f,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return Xe.commandParameter(r,Ao,e+".cmp",t.commandStr),Xe.commandType(i,"number",e+".ref",t.commandStr),Xe.commandType(o,"number",e+".mask",t.commandStr),[Ao[r],i,o]},function(e,t,n){var r=e.constants.compareFuncs;return Xe.optional(function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")}),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",mo),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case fi:case ci:return u(function(n){Xe.commandType(n,"object",f,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return Xe.commandParameter(r,Oo,e+".fail",t.commandStr),Xe.commandParameter(i,Oo,e+".zfail",t.commandStr),Xe.commandParameter(o,Oo,e+".zpass",t.commandStr),[e===ci?uo:ao,Oo[r],Oo[i],Oo[o]]},function(t,n,r){function i(i){return Xe.optional(function(){t.assert(n,'!("'+i+'" in '+r+")||("+r+"."+i+" in "+o+")","invalid "+e+"."+i+", must be one of "+Object.keys(Oo))}),n.def('"',i,'" in ',r,"?",o,"[",r,".",i,"]:",mo)}var o=t.constants.stencilOps;return Xe.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[e===ci?uo:ao,i("fail"),i("zfail"),i("zpass")]});case ti:return u(function(e){Xe.commandType(e,"object",f,t.commandStr);var n=0|e.factor,r=0|e.units;return Xe.commandType(n,"number",f+".factor",t.commandStr),Xe.commandType(r,"number",f+".units",t.commandStr),[n,r]},function(t,n,r){return Xe.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[n.def(r,".factor|0"),n.def(r,".units|0")]});case Qr:return u(function(e){var n=0;return"front"===e?n=ao:"back"===e&&(n=uo),Xe.command(!!n,f,t.commandStr),n},function(e,t,n){return Xe.optional(function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),t.def(n,'==="front"?',ao,":",uo)});case Jr:return u(function(e){return Xe.command("number"==typeof e&&e>=i.lineWidthDims[0]&&e<=i.lineWidthDims[1],"invalid line width, must positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],t.commandStr),e},function(e,t,n){return Xe.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")}),n});case Zr:return u(function(e){return Xe.commandParameter(e,wo,f,t.commandStr),wo[e]},function(e,t,n){return Xe.optional(function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(n+'==="cw"?'+fo+":"+co)});case $r:return u(function(e){return Xe.command($(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,n){return Xe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),P(4,function(e){return"!!"+n+"["+e+"]"})});case ii:return u(function(e){Xe.command("object"===(void 0===e?"undefined":r(e))&&e,f,t.commandStr);var n="value"in e?e.value:1,i=!!e.invert;return Xe.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,i]},function(e,t,n){return Xe.optional(function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]})}}),a}function L(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=we(function(){return o});else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=we(function(e){return e.link(o)}):"framebuffer"===a||"framebufferCube"===a?(Xe.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=we(function(e){return e.link(o.color[0])})):Xe.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else $(o)?r=we(function(t){return t.global.def("[",P(o.length,function(n){return Xe.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]}),"]")}):Xe.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=Le(t,function(e,n){return e.invoke(n,t)})}),i}function M(e,n){var i=e.static,o=e.dynamic,u={};return Object.keys(i).forEach(function(e){var o=i[e],f=t.id(e),c=new Q;if(Se(o))c.state=Ir,c.buffer=a.getBuffer(a.create(o,ji,!1,!0)),c.type=0;else{var s=a.getBuffer(o);if(s)c.state=Ir,c.buffer=s,c.type=0;else if(Xe.command("object"===(void 0===o?"undefined":r(o))&&o,"invalid data for attribute "+e,n.commandStr),o.constant){var l=o.constant;c.buffer="null",c.state=Pr,"number"==typeof l?c.x=l:(Xe.command($(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+e,n.commandStr),Rr.forEach(function(e,t){t<l.length&&(c[e]=l[t])}))}else{s=Se(o.buffer)?a.getBuffer(a.create(o.buffer,ji,!1,!0)):a.getBuffer(o.buffer),Xe.command(!!s,'missing buffer for attribute "'+e+'"',n.commandStr);var d=0|o.offset;Xe.command(d>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var p=0|o.stride;Xe.command(p>=0&&p<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var m=0|o.size;Xe.command(!("size"in o)||m>0&&m<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var h=!!o.normalized,v=0;"type"in o&&(Xe.commandParameter(o.type,lt,"invalid type for attribute "+e,n.commandStr),v=lt[o.type]);var y=0|o.divisor;"divisor"in o&&(Xe.command(0===y||J,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),Xe.command(y>=0,'invalid divisor for attribute "'+e+'"',n.commandStr)),Xe.optional(function(){var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach(function(n){Xe.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)})}),c.buffer=s,c.state=Ir,c.size=m,c.normalized=h,c.type=v||s.dtype,c.offset=d,c.stride=p,c.divisor=y}}u[e]=we(function(e,t){var n=e.attribCache;if(f in n)return n[f];var r={isStream:!1};return Object.keys(c).forEach(function(e){r[e]=c[e]}),c.buffer&&(r.buffer=e.link(c.buffer),r.type=r.type||r.buffer+".dtype"),n[f]=r,r})}),Object.keys(o).forEach(function(e){var t=o[e];u[e]=Le(t,function(n,r){function i(e){r(c[e],"=",o,".",e,"|0;")}var o=n.invoke(r,t),a=n.shared,u=a.isBufferArgs,f=a.buffer;Xe.optional(function(){n.assert(r,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+u+"("+o+")||"+f+".getBuffer("+o+")||"+f+".getBuffer("+o+".buffer)||"+u+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+a.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+e+'"')});var c={isStream:r.def(!1)},s=new Q;s.state=Ir,Object.keys(s).forEach(function(e){c[e]=r.def(""+s[e])});var l=c.buffer,d=c.type;return r("if(",u,"(",o,")){",c.isStream,"=true;",l,"=",f,".createStream(",ji,",",o,");",d,"=",l,".dtype;","}else{",l,"=",f,".getBuffer(",o,");","if(",l,"){",d,"=",l,".dtype;",'}else if("constant" in ',o,"){",c.state,"=",Pr,";","if(typeof "+o+'.constant === "number"){',c[Rr[0]],"=",o,".constant;",Rr.slice(1).map(function(e){return c[e]}).join("="),"=0;","}else{",Rr.map(function(e,t){return c[e]+"="+o+".constant.length>="+t+"?"+o+".constant["+t+"]:0;"}).join(""),"}}else{","if(",u,"(",o,".buffer)){",l,"=",f,".createStream(",ji,",",o,".buffer);","}else{",l,"=",f,".getBuffer(",o,".buffer);","}",d,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",l,".dtype;",c.normalized,"=!!",o,".normalized;"),i("size"),i("offset"),i("stride"),i("divisor"),r("}}"),r.exit("if(",c.isStream,"){",f,".destroyStream(",l,");","}"),c})}),u}function j(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=we(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=Le(t,function(e,n){return e.invoke(n,t)})}),r}function T(e,t,n,r,i){function a(e){var t=s[e];t&&(d[e]=t)}var u=e.static,f=e.dynamic;Xe.optional(function(){function e(e){Object.keys(e).forEach(function(e){Xe.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',i.commandStr)})}var t=[mi,hi,vi,yi,bi,_i,gi,xi,pi].concat(re);e(u),e(f)});var c=S(e,i),s=A(e,c,i),l=E(e,i),d=w(e,i),p=O(e,i);a(di),a(y(li));var m=Object.keys(d).length>0,h={framebuffer:c,draw:l,shader:p,state:d,dirty:m};return h.profile=x(e,i),h.uniforms=L(n,i),h.attributes=M(t,i),h.context=j(r,i),Object.keys(t).length&&!o.getShared()&&o.hasSupport&&o.create(),h}function R(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o);var a=n[o];i(r,".",o,"=",a.append(e,t),";")}),t(i)}function k(e,t,n,r){var i,o=e.shared,a=o.gl,u=o.framebuffer;ee&&(i=t.def(o.extensions,".webgl_draw_buffers"));var f,c=e.constants,s=c.drawBuffer,l=c.backBuffer;f=n?n.append(e,t):t.def(u,".next"),r||t("if(",f,"!==",u,".cur){"),t("if(",f,"){",a,".bindFramebuffer(",go,",",f,".framebuffer);"),ee&&t(i,".drawBuffersWEBGL(",s,"[",f,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",go,",null);"),ee&&t(i,".drawBuffersWEBGL(",l,");"),t("}",u,".cur=",f,";"),r||t("}")}function I(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,u=r.current,f=r.next,c=e.cond(u,".dirty");re.forEach(function(t){var r=y(t);if(!(r in n.state)){var s,l;if(r in a){s=a[r],l=o[r];var d=P(te[r].length,function(e){return c.def(s,"[",e,"]")});c(e.cond(d.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",oe[r],"(",d,");",d.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else{s=c.def(f,".",r);var p=e.cond(s,"!==",u,".",r);c(p),r in ie?p(e.cond(s).then(i,".enable(",ie[r],");").else(i,".disable(",ie[r],");"),u,".",r,"=",s,";"):p(i,".",oe[r],"(",s,");",u,".",r,"=",s,";")}}}),0===Object.keys(n.state).length&&c(u,".dirty=false;"),t(c)}function C(e,t,n,r){var i=e.shared,o=e.current,a=i.current,u=i.gl;Ae(Object.keys(n)).forEach(function(i){var f=n[i];if(!r||r(f)){var c=f.append(e,t);if(ie[i]){var s=ie[i];Ee(f)?c?t(u,".enable(",s,");"):t(u,".disable(",s,");"):t(e.cond(c).then(u,".enable(",s,");").else(u,".disable(",s,");")),t(a,".",i,"=",c,";")}else if($(c)){var l=o[i];t(u,".",oe[i],"(",c,");",c.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(u,".",oe[i],"(",c,");",a,".",i,"=",c,";")}})}function D(e,t){J&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function V(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){e(c=t.def(),"=",o(),";"),"string"==typeof i?e(p,".count+=",i,";"):e(p,".count++;"),h&&(r?e(s=t.def(),"=",v,".getNumPendingQueries();"):e(v,".beginQuery(",p,");"))}function u(e){e(p,".cpuTime+=",o(),"-",c,";"),h&&(r?e(v,".pushScopeStats(",s,",",v,".getNumPendingQueries(),",p,");"):e(v,".endQuery();"))}function f(e){var n=t.def(m,".profile");t(m,".profile=",e,";"),t.exit(m,".profile=",n,";")}var c,s,l,d=e.shared,p=e.stats,m=d.current,v=d.timer,y=n.profile;if(y){if(Ee(y))return void(y.enable?(a(t),u(t.exit),f("true")):f("false"));f(l=y.append(e,t))}else l=t.def(m,".profile");var b=e.block();a(b),t("if(",l,"){",b,"}");var g=e.block();u(g),t.exit("if(",l,"){",g,"}")}function G(e,t,n,r,i){function o(e){switch(e){case zi:case Xi:case Qi:return 2;case Yi:case Wi:case Zi:return 3;case Hi:case $i:case Ji:return 4;default:return 1}}function a(n,r,i){function o(){t("if(!",s,".buffer){",f,".enableVertexAttribArray(",c,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",s,".type!==",o,"||",s,".size!==",n,"||",m.map(function(e){return s+"."+e+"!=="+i[e]}).join("||"),"){",f,".bindBuffer(",ji,",",d,".buffer);",f,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",s,".type=",o,";",s,".size=",n,";",m.map(function(e){return s+"."+e+"="+i[e]+";"}).join(""),"}"),J){var a=i.divisor;t("if(",s,".divisor!==",a,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,a],");",s,".divisor=",a,";}")}}function a(){t("if(",s,".buffer){",f,".disableVertexAttribArray(",c,");","}if(",Rr.map(function(e,t){return s+"."+e+"!=="+p[t]}).join("||"),"){",f,".vertexAttrib4f(",c,",",p,");",Rr.map(function(e,t){return s+"."+e+"="+p[t]+";"}).join(""),"}")}var f=u.gl,c=t.def(n,".location"),s=t.def(u.attributes,"[",c,"]"),l=i.state,d=i.buffer,p=[i.x,i.y,i.z,i.w],m=["buffer","normalized","offset","stride"];l===Ir?o():l===Pr?a():(t("if(",l,"===",Ir,"){"),o(),t("}else{"),a(),t("}"))}var u=e.shared,f=u.vao;f&&t("if(",f,"&&",f,".getShared()){",f,".getShared().bind(); }"),r.forEach(function(r){var u,f=r.name,c=n.attributes[f];if(c){if(!i(c))return;u=c.append(e,t)}else{if(!i(Lo))return;var s=e.scopeAttrib(f);Xe.optional(function(){e.assert(t,s+".state","missing attribute "+f)}),u={},Object.keys(new Q).forEach(function(e){u[e]=t.def(s,".",e)})}a(e.link(r),o(r.info.type),u)})}function N(e,n,r,i,o){for(var a,u=e.shared,f=u.gl,c=0;c<i.length;++c){var s,l=i[c],d=l.name,p=l.info.type,m=r.uniforms[d],h=e.link(l)+".location";if(m){if(!o(m))continue;if(Ee(m)){var v=m.value;if(Xe.command(null!==v&&void 0!==v,'missing uniform "'+d+'"',e.commandStr),p===ro||p===io){Xe.command("function"==typeof v&&(p===ro&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||p===io&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+d,e.commandStr);var y=e.link(v._texture||v.color[0]._texture);n(f,".uniform1i(",h,",",y+".bind());"),n.exit(y,".unbind();")}else if(p===eo||p===to||p===no){Xe.optional(function(){Xe.command($(v),"invalid matrix for uniform "+d,e.commandStr),Xe.command(p===eo&&4===v.length||p===to&&9===v.length||p===no&&16===v.length,"invalid length for matrix uniform "+d,e.commandStr)});var b=e.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),g=2;p===to?g=3:p===no&&(g=4),n(f,".uniformMatrix",g,"fv(",h,",false,",b,");")}else{switch(p){case Ui:Xe.commandType(v,"number","uniform "+d,e.commandStr),a="1f";break;case zi:Xe.command($(v)&&2===v.length,"uniform "+d,e.commandStr),a="2f";break;case Yi:Xe.command($(v)&&3===v.length,"uniform "+d,e.commandStr),a="3f";break;case Hi:Xe.command($(v)&&4===v.length,"uniform "+d,e.commandStr),a="4f";break;case Ki:Xe.commandType(v,"boolean","uniform "+d,e.commandStr),a="1i";break;case qi:Xe.commandType(v,"number","uniform "+d,e.commandStr),a="1i";break;case Qi:case Xi:Xe.command($(v)&&2===v.length,"uniform "+d,e.commandStr),a="2i";break;case Zi:case Wi:Xe.command($(v)&&3===v.length,"uniform "+d,e.commandStr),a="3i";break;case Ji:case $i:Xe.command($(v)&&4===v.length,"uniform "+d,e.commandStr),a="4i"}n(f,".uniform",a,"(",h,",",$(v)?Array.prototype.slice.call(v):v,");")}continue}s=m.append(e,n)}else{if(!o(Lo))continue;s=n.def(u.uniforms,"[",t.id(d),"]")}p===ro?n("if(",s,"&&",s,'._reglType==="framebuffer"){',s,"=",s,".color[0];","}"):p===io&&n("if(",s,"&&",s,'._reglType==="framebufferCube"){',s,"=",s,".color[0];","}"),Xe.optional(function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+d+'".  '+r)}function r(e){t("typeof "+s+'==="'+e+'"',"invalid type, expected "+e)}function i(n,r){t(u.isArrayLike+"("+s+")&&"+s+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function o(n){t("typeof "+s+'==="function"&&'+s+'._reglType==="texture'+(n===Ri?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(p){case qi:r("number");break;case Xi:i(2);break;case Wi:i(3);break;case $i:i(4);break;case Ui:r("number");break;case zi:i(2);break;case Yi:i(3);break;case Hi:i(4);break;case Ki:r("boolean");break;case Qi:i(2);break;case Zi:i(3);break;case Ji:case eo:i(4);break;case to:i(9);break;case no:i(16);break;case ro:o(Ri);break;case io:o(ki)}});var _=1;switch(p){case ro:case io:var x=n.def(s,"._texture");n(f,".uniform1i(",h,",",x,".bind());"),n.exit(x,".unbind();");continue;case qi:case Ki:a="1i";break;case Xi:case Qi:a="2i",_=2;break;case Wi:case Zi:a="3i",_=3;break;case $i:case Ji:a="4i",_=4;break;case Ui:a="1f";break;case zi:a="2f",_=2;break;case Yi:a="3f",_=3;break;case Hi:a="4f",_=4;break;case eo:a="Matrix2fv";break;case to:a="Matrix3fv";break;case no:a="Matrix4fv"}if(n(f,".uniform",a,"(",h,","),"M"===a.charAt(0)){var S=Math.pow(p-eo+2,2),A=e.global.def("new Float32Array(",S,")");n("false,(Array.isArray(",s,")||",s," instanceof Float32Array)?",s,":(",P(S,function(e){return A+"["+e+"]="+s+"["+e+"]"}),",",A,")")}else n(_>1?P(_,function(e){return s+"["+e+"]"}):s);n(");")}}function F(e,t,n,r){function i(i){var o=l[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(c,".",i)}function o(){function e(){n(y,".drawElementsInstancedANGLE(",[p,h,b,m+"<<(("+b+"-"+kr+")>>1)",v],");")}function t(){n(y,".drawArraysInstancedANGLE(",[p,m,h,v],");")}d?g?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(f+".drawElements("+[p,h,b,m+"<<(("+b+"-"+kr+")>>1)"]+");")}function t(){n(f+".drawArrays("+[p,m,h]+");")}d?g?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}var u=e.shared,f=u.gl,c=u.draw,s=u.vao,l=r.draw,d=function(){var i,o=l.elements,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a)):i=a.def(c,".",yi),i&&a("if("+i+")"+f+".bindBuffer("+Ti+","+i+".buffer.buffer);"),i}(),p=i(bi),m=i(_i),h=function(){var i,o=l.count,a=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(a=n),i=o.append(e,a),Xe.optional(function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(a,i+">=0","missing vertex count")})):(i=a.def(c,".",gi),Xe.optional(function(){e.assert(a,i+">=0","missing vertex count")})),i}();if("number"==typeof h){if(0===h)return}else n("if(",h,"){"),n.exit("}");var v,y;J&&(v=i(xi),y=e.instancing);var b=d+".type",g=l.elements&&Ee(l.elements);s&&t("if(",s,"&&",s,".getShared()){",s,".getShared().bind(); }"),J&&("number"!=typeof v||v>=0)?"string"==typeof v?(n("if(",v,">0){"),o(),n("}else if(",v,"<0){"),a(),n("}")):o():a(),s&&t("if(",s,"&&",s,".getShared()){",s,".getShared().unbind(); }")}function B(e,t,n,r,i){var o=_(),a=o.proc("body",i);return Xe.optional(function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)}),J&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function U(e,t,n,r){D(e,t),G(e,t,n,r.attributes,function(){return!0}),N(e,t,n,r.uniforms,function(){return!0}),F(e,t,t,n)}function z(e,t){var n=e.proc("draw",1);D(e,n),R(e,n,t.context),k(e,n,t.framebuffer),I(e,n,t),C(e,n,t.state),V(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)U(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return B(U,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function Y(e,t,n,r){function i(){return!0}e.batchId="a1",D(e,t),G(e,t,n,r.attributes,i),N(e,t,n,r.uniforms,i),F(e,t,t,n)}function H(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}D(e,t);var a=n.contextDep,u=t.def(),f=t.def();e.shared.props=f,e.batchId=u;var c=e.scope(),s=e.scope();if(t(c.entry,"for(",u,"=0;",u,"<","a1",";++",u,"){",f,"=","a0","[",u,"];",s,"}",c.exit),n.needsContext&&R(e,s,n.context),n.needsFramebuffer&&k(e,s,n.framebuffer),C(e,s,n.state,i),n.profile&&i(n.profile)&&V(e,s,n,!1,!0),r)G(e,c,n,r.attributes,o),G(e,s,n,r.attributes,i),N(e,c,n,r.uniforms,o),N(e,s,n,r.uniforms,i),F(e,c,s,n);else{var l=e.global.def("{}"),d=n.shader.progVar.append(e,s),p=s.def(d,".id"),m=s.def(l,"[",p,"]");s(e.shared.gl,".useProgram(",d,".program);","if(!",m,"){",m,"=",l,"[",p,"]=",e.link(function(t){return B(Y,e,n,t,2)}),"(",d,");}",m,".call(this,a0[",u,"],",u,");")}}function q(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",D(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(R(e,r,t.context),o=!1);var a=t.framebuffer,u=!1;a?(a.propDep?i=u=!0:a.contextDep&&i&&(u=!0),u||k(e,r,a)):k(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),I(e,r,t),C(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||V(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=u;var f=t.shader.progVar;if(f.contextDep&&i||f.propDep)H(e,r,t,null);else{var c=f.append(e,r);if(r(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)H(e,r,t,t.shader.program);else{var s=e.global.def("{}"),l=r.def(c,".id"),d=r.def(s,"[",l,"]");r(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",s,"[",l,"]=",e.link(function(n){return B(H,e,t,n,2)}),"(",c,");",d,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function X(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;R(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),Ae(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,i);$(r)?r.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,r)}),V(e,i,n,!0,!0),[yi,_i,gi,xi,bi].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new Q).forEach(function(e){i.set(o,"."+e,r[e])})}),r(hi),r(vi),Object.keys(n.state).length>0&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function W(e){if("object"===(void 0===e?"undefined":r(e))&&!$(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(Ke.isDynamic(e[t[n]]))return!0;return!1}}function K(e,t,n){var i=t.static[n];if(i&&W(i)){var o=e.global,a=Object.keys(i),u=!1,f=!1,c=!1,s=e.global.def("{}");a.forEach(function(t){var n=i[t];if(Ke.isDynamic(n)){"function"==typeof n&&(n=i[t]=Ke.unbox(n));var a=Le(n,null);u=u||a.thisDep,c=c||a.propDep,f=f||a.contextDep}else{switch(o(s,".",t,"="),void 0===n?"undefined":r(n)){case"number":o(n);break;case"string":o('"',n,'"');break;case"object":Array.isArray(n)&&o("[",n.join(),"]");break;default:o(e.link(n))}o(";")}}),t.dynamic[n]=new Ke.DynamicVariable(Nr,{thisDep:u,contextDep:f,propDep:c,ref:s,append:function(e,t){a.forEach(function(n){var r=i[n];if(Ke.isDynamic(r)){var o=e.invoke(t,r);t(s,".",n,"=",o,";")}})}}),delete t.static[n]}}var Q=l.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Z.min=so,Z.max=lo);var J=n.angle_instanced_arrays,ee=n.webgl_draw_buffers,te={dirty:!0,profile:v.profile},ne={},re=[],ie={},oe={};b(Fr,Ci),b(Br,Pi),g(Ur,"blendColor",[0,0,0,0]),g(zr,"blendEquationSeparate",[yo,yo]),g(Yr,"blendFuncSeparate",[vo,ho,vo,ho]),b(Hr,Vi,!0),g(qr,"depthFunc",bo),g(Xr,"depthRange",[0,1]),g(Wr,"depthMask",!0),g($r,$r,[!0,!0,!0,!0]),b(Kr,Ii),g(Qr,"cullFace",uo),g(Zr,Zr,co),g(Jr,Jr,1),b(ei,Ni),g(ti,"polygonOffset",[0,0]),b(ni,Fi),b(ri,Bi),g(ii,"sampleCoverage",[1,!1]),b(oi,Di),g(ai,"stencilMask",-1),g(ui,"stencilFunc",[po,0,-1]),g(fi,"stencilOpSeparate",[ao,mo,mo,mo]),g(ci,"stencilOpSeparate",[uo,mo,mo,mo]),b(si,Gi),g(li,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),g(di,di,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ae={gl:e,context:m,strings:t,next:ne,current:te,draw:p,elements:u,vao:o,buffer:a,shader:d,attributes:l.state,uniforms:s,framebuffer:c,extensions:n,timer:h,isBufferArgs:Se},ue={primTypes:_t,compareFuncs:Ao,blendFuncs:xo,blendEquations:Z,stencilOps:Oo,glTypes:lt,orientationType:wo};Xe.optional(function(){ae.isArrayLike=$}),ee&&(ue.backBuffer=[uo],ue.drawBuffer=P(i.maxDrawbuffers,function(e){return 0===e?[0]:P(e,function(e){return _o+e})}));var fe=0;return{next:ne,current:te,compile:function(e,t,n,r,i){var o=_();o.stats=o.link(i),Object.keys(t.static).forEach(function(e){K(o,t,e)}),Mi.forEach(function(t){K(o,e,t)});var a=T(e,t,n,r,o);return z(o,a),X(o,a),q(o,a),o.compile()},procs:function(){var t=_(),n=t.proc("poll"),r=t.proc("refresh"),o=t.block();n(o),r(o);var a=t.shared,u=a.gl,f=a.next,c=a.current;o(c,".dirty=false;"),k(t,n),k(t,r,null,!0);var s,l=e.getExtension("angle_instanced_arrays");l&&(s=t.link(l));for(var d=0;d<i.maxAttributes;++d){var p=r.def(a.attributes,"[",d,"]"),m=t.cond(p,".buffer");m.then(u,".enableVertexAttribArray(",d,");",u,".bindBuffer(",ji,",",p,".buffer.buffer);",u,".vertexAttribPointer(",d,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(u,".disableVertexAttribArray(",d,");",u,".vertexAttrib4f(",d,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),r(m),l&&r(s,".vertexAttribDivisorANGLE(",d,",",p,".divisor);")}return Object.keys(ie).forEach(function(e){var i=ie[e],a=o.def(f,".",e),s=t.block();s("if(",a,"){",u,".enable(",i,")}else{",u,".disable(",i,")}",c,".",e,"=",a,";"),r(s),n("if(",a,"!==",c,".",e,"){",s,"}")}),Object.keys(oe).forEach(function(e){var i,a,s=oe[e],l=te[e],d=t.block();if(d(u,".",s,"("),$(l)){var p=l.length;i=t.global.def(f,".",e),a=t.global.def(c,".",e),d(P(p,function(e){return i+"["+e+"]"}),");",P(p,function(e){return a+"["+e+"]="+i+"["+e+"];"}).join("")),n("if(",P(p,function(e){return i+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",d,"}")}else i=o.def(f,".",e),a=o.def(c,".",e),d(i,");",c,".",e,"=",i,";"),n("if(",i,"!==",a,"){",d,"}");r(d)}),t.compile()}()}}function je(){return{bufferCount:0,vaoCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function Te(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Re={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ke=function(e){return Object.prototype.toString.call(e)in Re},Ie=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},Pe=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],Ce=33071,De=9728,Ve=9984,Ge=9985,Ne=9986,Fe=9987,Be=5126,Ue=32819,ze=32820,Ye=33635,He=34042,qe={};qe[5120]=qe[5121]=1,qe[5122]=qe[5123]=qe[36193]=qe[Ye]=qe[Ue]=qe[ze]=2,qe[5124]=qe[5125]=qe[Be]=qe[He]=4;var Xe=Ie(n,{optional:function(e){e()},raise:t,commandRaise:v,command:function(e,t,n){e||v(t,n||s())},parameter:function(e,n,r){e in n||t("unknown parameter ("+e+")"+i(r)+". possible values: "+Object.keys(n).join())},commandParameter:function(e,t,n,r){e in t||v("unknown parameter ("+e+")"+i(n)+". possible values: "+Object.keys(t).join(),r||s())},constructor:function(e){Object.keys(e).forEach(function(e){Pe.indexOf(e)<0&&t('invalid regl constructor argument "'+e+'". must be one of '+Pe)})},type:function(e,n,o){(void 0===e?"undefined":r(e))!==n&&t("invalid parameter type"+i(o)+". expected "+n+", got "+(void 0===e?"undefined":r(e)))},commandType:y,isTypedArray:function(e,n){ke(e)||t("invalid parameter type"+i(n)+". must be a typed array")},nni:function(e,n){e>=0&&(0|e)===e||t("invalid parameter type, ("+e+")"+i(n)+". must be a nonnegative integer")},oneOf:o,shaderError:function(e,t,r,i,o){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var u=e.getShaderInfoLog(t),f=i===e.FRAGMENT_SHADER?"fragment":"vertex";y(r,"string",f+" shader source must be a string",o);var c=d(r,o),s=p(u);m(c,s),Object.keys(c).forEach(function(e){function t(e,t){r.push(e),i.push(t||"")}var n=c[e];if(n.hasErrors){var r=[""],i=[""];t("file number "+e+": "+n.name+"\n","color:red;text-decoration:underline;font-weight:bold"),n.lines.forEach(function(e){if(e.errors.length>0){t(a(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),t(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var n=0;e.errors.forEach(function(r){var i=r.message,o=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(i);if(o){var u=o[1];switch(i=o[2],u){case"assign":u="="}n=Math.max(e.line.indexOf(u,n),0)}else n=0;t(a("| ",6)),t(a("^^^",n+3)+"\n","font-weight:bold"),t(a("| ",6)),t(i+"\n","font-weight:bold")}),t(a("| ",6)+"\n")}else t(a(e.number,4)+"|  "),t(e.line+"\n","color:red")}),"undefined"!=typeof document?(i[0]=r.join("%c"),console.log.apply(console,i)):console.log(r.join(""))}}),n.raise("Error compiling "+f+" shader, "+c[0].name)}},linkError:function(e,t,r,i,o){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),u=d(r,o),f='Error linking program with vertex shader, "'+d(i,o)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+f+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+a),n.raise(f)}},callSite:l,saveCommandRef:h,saveDrawInfo:function(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}h(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var u=e._attributeSet={};o(u,n.static),o(u,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?o(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):o(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:s,texture2D:function(e,t,r){var i,o=t.width,a=t.height,u=t.channels;n(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),e.wrapS===Ce&&e.wrapT===Ce||n(g(o)&&g(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&n(e.minFilter!==Ve&&e.minFilter!==Ne&&e.minFilter!==Ge&&e.minFilter!==Fe,"min filter requires mipmap"):(n(g(o)&&g(a),"texture must be a square power of 2 to support mipmapping"),n(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),t.type===Be&&(r.extensions.indexOf("oes_texture_float_linear")<0&&n(e.minFilter===De&&e.magFilter===De,"filter not supported, must enable oes_texture_float_linear"),n(!e.genMipmaps,"mipmap generation not supported with float textures"));var f=t.images;for(i=0;i<16;++i)if(f[i]){var c=o>>i,s=a>>i;n(t.mipmask&1<<i,"missing mipmap data");var l=f[i];if(n(l.width===c&&l.height===s,"invalid shape for mip images"),n(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed);else if(l.data){var d=Math.ceil(b(l.type,u)*c/l.unpackAlignment)*l.unpackAlignment;n(l.data.byteLength===d*s,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else e.genMipmaps||n(0==(t.mipmask&1<<i),"extra mipmap data");t.compressed&&n(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,r,i){var o=e.width,a=e.height,u=e.channels;n(o>0&&o<=i.maxTextureSize&&a>0&&a<=i.maxTextureSize,"invalid texture shape"),n(o===a,"cube map must be square"),n(t.wrapS===Ce&&t.wrapT===Ce,"wrap mode not supported by cube map");for(var f=0;f<r.length;++f){var c=r[f];n(c.width===o&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(n(!c.compressed,"can not generate mipmap for compressed textures"),n(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var s=c.images,l=0;l<16;++l){var d=s[l];if(d){var p=o>>l,m=a>>l;n(c.mipmask&1<<l,"missing mipmap data"),n(d.width===p&&d.height===m,"invalid shape for mip images"),n(d.format===e.format&&d.internalformat===e.internalformat&&d.type===e.type,"incompatible type for mip image"),d.compressed||(d.data?n(d.data.byteLength===p*m*Math.max(b(d.type,u),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}}),We=0,$e=0,Ke={DynamicVariable:_,define:function(e,t){return new _(e,A(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof _},unbox:function(e,t){return"function"==typeof e?new _($e,e):e},accessor:A},Qe={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},Ze="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Je=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}},et=function(e){return Object.keys(e).map(function(t){return e[t]})},tt=5120,nt=5121,rt=5122,it=5123,ot=5124,at=5125,ut=5126,ft=P(8,function(){return[]}),ct={alloc:V,free:G,allocType:function(e,t){var n=null;switch(e){case tt:n=new Int8Array(V(t),0,t);break;case nt:n=new Uint8Array(V(t),0,t);break;case rt:n=new Int16Array(V(2*t),0,t);break;case it:n=new Uint16Array(V(2*t),0,t);break;case ot:n=new Int32Array(V(4*t),0,t);break;case at:n=new Uint32Array(V(4*t),0,t);break;case ut:n=new Float32Array(V(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){G(e.buffer)}},st={shape:function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||ct.allocType(n,i);switch(t.length){case 0:break;case 1:N(e,t[0],a);break;case 2:F(e,t[0],t[1],a);break;case 3:B(e,t[0],t[1],t[2],a,0);break;default:U(e,t,0,a,0)}return a}},lt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},dt={dynamic:35048,stream:35040,static:35044},pt=st.flatten,mt=st.shape,ht=35044,vt=35040,yt=5121,bt=5126,gt=[];gt[5120]=1,gt[5122]=2,gt[5124]=4,gt[5121]=1,gt[5123]=2,gt[5125]=4,gt[5126]=4;var _t={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},xt=0,St=1,At=4,Ot=5120,Et=5121,wt=5122,Lt=5123,Mt=5124,jt=5125,Tt=34963,Rt=35040,kt=35044,It=new Float32Array(1),Pt=new Uint32Array(It.buffer),Ct=5123,Dt=34467,Vt=3553,Gt=34067,Nt=34069,Ft=6408,Bt=6406,Ut=6407,zt=6409,Yt=6410,Ht=32854,qt=32855,Xt=36194,Wt=32819,$t=32820,Kt=33635,Qt=34042,Zt=6402,Jt=34041,en=35904,tn=35906,nn=36193,rn=33776,on=33777,an=33778,un=33779,fn=35986,cn=35987,sn=34798,ln=35840,dn=35841,pn=35842,mn=35843,hn=36196,vn=5121,yn=5123,bn=5125,gn=5126,_n=10242,xn=10243,Sn=10497,An=33071,On=33648,En=10240,wn=10241,Ln=9728,Mn=9729,jn=9984,Tn=9985,Rn=9986,kn=9987,In=33170,Pn=4352,Cn=4353,Dn=4354,Vn=34046,Gn=3317,Nn=37440,Fn=37441,Bn=37443,Un=37444,zn=33984,Yn=[jn,Rn,Tn,kn],Hn=[0,zt,Yt,Ut,Ft],qn={};qn[zt]=qn[Bt]=qn[Zt]=1,qn[Jt]=qn[Yt]=2,qn[Ut]=qn[en]=3,qn[Ft]=qn[tn]=4;var Xn=K("HTMLCanvasElement"),Wn=K("CanvasRenderingContext2D"),$n=K("HTMLImageElement"),Kn=K("HTMLVideoElement"),Qn=Object.keys(Re).concat([Xn,Wn,$n,Kn]),Zn=[];Zn[vn]=1,Zn[gn]=4,Zn[nn]=2,Zn[yn]=2,Zn[bn]=4;var Jn=[];Jn[Ht]=2,Jn[qt]=2,Jn[Xt]=2,Jn[Jt]=4,Jn[rn]=.5,Jn[on]=.5,Jn[an]=1,Jn[un]=1,Jn[fn]=.5,Jn[cn]=1,Jn[sn]=1,Jn[ln]=.5,Jn[dn]=.25,Jn[pn]=.5,Jn[mn]=.25,Jn[hn]=.5;var er=36161,tr=32854,nr=[];nr[tr]=2,nr[32855]=2,nr[36194]=2,nr[33189]=2,nr[36168]=1,nr[34041]=4,nr[35907]=4,nr[34836]=16,nr[34842]=8,nr[34843]=6;var rr=function(e,t,n,i,o){function a(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=tr,this.width=0,this.height=0,o.profile&&(this.stats={size:0})}function u(t){var n=t.renderbuffer;Xe(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(er,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],i.renderbufferCount--}var f={rgba4:tr,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(f.srgba=35907),t.ext_color_buffer_half_float&&(f.rgba16f=34842,f.rgb16f=34843),t.webgl_color_buffer_float&&(f.rgba32f=34836);var c=[];Object.keys(f).forEach(function(e){var t=f[e];c[t]=e});var s=0,l={};return a.prototype.decRef=function(){--this.refCount<=0&&u(this)},o.profile&&(i.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach(function(t){e+=l[t].stats.size}),e}),{create:function(t,u){function s(t,i){var a=0,u=0,l=tr;if("object"===(void 0===t?"undefined":r(t))&&t){var p=t;if("shape"in p){var m=p.shape;Xe(Array.isArray(m)&&m.length>=2,"invalid renderbuffer shape"),a=0|m[0],u=0|m[1]}else"radius"in p&&(a=u=0|p.radius),"width"in p&&(a=0|p.width),"height"in p&&(u=0|p.height);"format"in p&&(Xe.parameter(p.format,f,"invalid renderbuffer format"),l=f[p.format])}else"number"==typeof t?(a=0|t,u="number"==typeof i?0|i:a):t?Xe.raise("invalid arguments to renderbuffer constructor"):a=u=1;if(Xe(a>0&&u>0&&a<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==d.width||u!==d.height||l!==d.format)return s.width=d.width=a,s.height=d.height=u,d.format=l,e.bindRenderbuffer(er,d.renderbuffer),e.renderbufferStorage(er,l,a,u),o.profile&&(d.stats.size=de(d.format,d.width,d.height)),s.format=c[d.format],s}var d=new a(e.createRenderbuffer());return l[d.id]=d,i.renderbufferCount++,s(t,u),s.resize=function(t,r){var i=0|t,a=0|r||i;return i===d.width&&a===d.height?s:(Xe(i>0&&a>0&&i<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),s.width=d.width=i,s.height=d.height=a,e.bindRenderbuffer(er,d.renderbuffer),e.renderbufferStorage(er,d.format,i,a),o.profile&&(d.stats.size=de(d.format,d.width,d.height)),s)},s._reglType="renderbuffer",s._renderbuffer=d,o.profile&&(s.stats=d.stats),s.destroy=function(){d.decRef()},s},clear:function(){et(l).forEach(u)},restore:function(){et(l).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(er,t.renderbuffer),e.renderbufferStorage(er,t.format,t.width,t.height)}),e.bindRenderbuffer(er,null)}}},ir=36160,or=36161,ar=3553,ur=34069,fr=36064,cr=36096,sr=36128,lr=33306,dr=36053,pr=6402,mr=[6408],hr=[];hr[6408]=4;var vr=[];vr[5121]=1,vr[5126]=4,vr[36193]=2;var yr=33189,br=36168,gr=34041,_r=[32854,32855,36194,35907,34842,34843,34836],xr={};xr[dr]="complete",xr[36054]="incomplete attachment",xr[36057]="incomplete dimensions",xr[36055]="incomplete, missing attachment",xr[36061]="unsupported";var Sr=5126,Ar=35632,Or=35633,Er=35718,wr=35721,Lr=6408,Mr=5121,jr=3333,Tr=5126,Rr="xyzw".split(""),kr=5121,Ir=1,Pr=2,Cr=0,Dr=1,Vr=2,Gr=3,Nr=4,Fr="dither",Br="blend.enable",Ur="blend.color",zr="blend.equation",Yr="blend.func",Hr="depth.enable",qr="depth.func",Xr="depth.range",Wr="depth.mask",$r="colorMask",Kr="cull.enable",Qr="cull.face",Zr="frontFace",Jr="lineWidth",ei="polygonOffset.enable",ti="polygonOffset.offset",ni="sample.alpha",ri="sample.enable",ii="sample.coverage",oi="stencil.enable",ai="stencil.mask",ui="stencil.func",fi="stencil.opFront",ci="stencil.opBack",si="scissor.enable",li="scissor.box",di="viewport",pi="profile",mi="framebuffer",hi="vert",vi="frag",yi="elements",bi="primitive",gi="count",_i="offset",xi="instances",Si=mi+"Width",Ai=mi+"Height",Oi=di+"Width",Ei=di+"Height",wi="drawingBufferWidth",Li="drawingBufferHeight",Mi=[Yr,zr,ui,fi,ci,ii,di,li,ti],ji=34962,Ti=34963,Ri=3553,ki=34067,Ii=2884,Pi=3042,Ci=3024,Di=2960,Vi=2929,Gi=3089,Ni=32823,Fi=32926,Bi=32928,Ui=5126,zi=35664,Yi=35665,Hi=35666,qi=5124,Xi=35667,Wi=35668,$i=35669,Ki=35670,Qi=35671,Zi=35672,Ji=35673,eo=35674,to=35675,no=35676,ro=35678,io=35680,oo=4,ao=1028,uo=1029,fo=2304,co=2305,so=32775,lo=32776,po=519,mo=7680,ho=0,vo=1,yo=32774,bo=513,go=36160,_o=36064,xo={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},So=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ao={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oo={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Eo={frag:35632,vert:35633},wo={cw:fo,ccw:co},Lo=new Oe(!1,!1,!1,function(){}),Mo=34918,jo=34919,To=35007,Ro=function(e,t){function n(){return c.pop()||f.createQueryEXT()}function r(e){c.push(e)}function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function o(){return l.pop()||new i}function a(e){l.push(e)}function u(e,t,n){var r=o();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,d.push(r)}var f=t.ext_disjoint_timer_query;if(!f)return null;var c=[],s=[],l=[],d=[],p=[],m=[];return{beginQuery:function(e){var t=n();f.beginQueryEXT(To,t),s.push(t),u(s.length-1,s.length,e)},endQuery:function(){f.endQueryEXT(To)},pushScopeStats:u,update:function(){var e,t,n=s.length;if(0!==n){m.length=Math.max(m.length,n+1),p.length=Math.max(p.length,n+1),p[0]=0,m[0]=0;var i=0;for(e=0,t=0;t<s.length;++t){var o=s[t];f.getQueryObjectEXT(o,jo)?(i+=f.getQueryObjectEXT(o,Mo),r(o)):s[e++]=o,p[t+1]=i,m[t+1]=e}for(s.length=e,e=0,t=0;t<d.length;++t){var u=d[t],c=u.startQueryIndex,l=u.endQueryIndex;u.sum+=p[l]-p[c];var h=m[c],v=m[l];v===h?(u.stats.gpuTime+=u.sum/1e6,a(u)):(u.startQueryIndex=h,u.endQueryIndex=v,d[e++]=u)}d.length=e}},getNumPendingQueries:function(){return s.length},clear:function(){c.push.apply(c,s);for(var e=0;e<c.length;e++)f.deleteQueryEXT(c[e]);s.length=0,c.length=0},restore:function(){s.length=0,c.length=0}}},ko=16384,Io=256,Po=1024,Co=34962,Do="webglcontextlost",Vo="webglcontextrestored",Go=1,No=2,Fo=3;return function(e){function t(){if(0===H.length)return S&&S.update(),void(Q=null);Q=Qe.next(t),l();for(var e=H.length-1;e>=0;--e){var n=H[e];n&&n(L,null,0)}h.flush(),S&&S.update()}function n(){!Q&&H.length>0&&(Q=Qe.next(t))}function i(){Q&&(Qe.cancel(t),Q=null)}function o(e){e.preventDefault(),y=!0,i(),W.forEach(function(e){e()})}function a(e){h.getError(),y=!1,b.restore(),V.restore(),P.restore(),G.restore(),N.restore(),F.restore(),S&&S.restore(),B.procs.refresh(),n(),$.forEach(function(e){e()})}function u(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];Ke.isDynamic(i)?n[r]=Ke.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}function n(e){for(;d.length<e;)d.push(null);return d}Xe(!!e,"invalid args to regl({...})"),Xe.type(e,"object","invalid args to regl({...})");var r=t(e.context||{}),i=t(e.uniforms||{}),o=t(e.attributes||{}),a=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=Ie({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e)),u={gpuTime:0,cpuTime:0,count:0},f=B.compile(a,o,i,r,u),c=f.draw,s=f.batch,l=f.scope,d=[];return Ie(function(e,t){var r;if(y&&Xe.raise("context lost"),"function"==typeof e)return l.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e){for(r=0;r<e;++r)l.call(this,null,t,r);return}if(Array.isArray(e)){for(r=0;r<e.length;++r)l.call(this,e[r],t,r);return}return l.call(this,e,t,0)}if("number"==typeof e){if(e>0)return s.call(this,n(0|e),0|e)}else{if(!Array.isArray(e))return c.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:u})}function f(e,t){var n=0;B.procs.poll();var r=t.color;r&&(h.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=ko),"depth"in t&&(h.clearDepth(+t.depth),n|=Io),"stencil"in t&&(h.clearStencil(0|t.stencil),n|=Po),Xe(!!n,"called regl.clear with no buffer specified"),h.clear(n)}function c(e){return Xe.type(e,"function","regl.frame() callback must be a function"),H.push(e),n(),{cancel:function(){function t(){var e=Te(H,t);H[e]=H[H.length-1],H.length-=1,H.length<=0&&i()}var n=Te(H,e);Xe(n>=0,"cannot cancel a frame twice"),H[n]=t}}}function s(){var e=z.viewport,t=z.scissor_box;e[0]=e[1]=t[0]=t[1]=0,L.viewportWidth=L.framebufferWidth=L.drawingBufferWidth=e[2]=t[2]=h.drawingBufferWidth,L.viewportHeight=L.framebufferHeight=L.drawingBufferHeight=e[3]=t[3]=h.drawingBufferHeight}function l(){L.tick+=1,L.time=p(),s(),B.procs.poll()}function d(){s(),B.procs.refresh(),S&&S.update()}function p(){return(Ze()-A)/1e3}var m=R(e);if(!m)return null;var h=m.gl,v=h.getContextAttributes(),y=h.isContextLost(),b=k(h,m);if(!b)return null;var g=O(),_=je(),x=b.extensions,S=Ro(h,x),A=Ze(),E=h.drawingBufferWidth,w=h.drawingBufferHeight,L={tick:0,time:0,viewportWidth:E,viewportHeight:w,framebufferWidth:E,framebufferHeight:w,drawingBufferWidth:E,drawingBufferHeight:w,pixelRatio:m.pixelRatio},M={},j={elements:null,primitive:4,count:-1,offset:0,instances:-1},T=Je(h,x),I=be(h,x,_,m),P=q(h,_,m),C=X(h,x,P,_),D=he(h,x,T,P,g),V=ve(h,g,_,m),G=le(h,x,T,function(){B.procs.poll()},L,_,m),N=rr(h,x,T,_,m),F=pe(h,x,T,G,N,_),B=Me(h,g,x,T,I,P,C,G,F,M,D,V,j,L,S,m),U=ye(h,F,B.procs.poll,L,v,x),z=B.next,Y=h.canvas,H=[],W=[],$=[],K=[m.onDestroy],Q=null;Y&&(Y.addEventListener(Do,o,!1),Y.addEventListener(Vo,a,!1));var Z=F.setFBO=u({framebuffer:Ke.define.call(null,Go,"framebuffer")});d();var J=Ie(u,{clear:function(e){if(Xe("object"===(void 0===e?"undefined":r(e))&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)Z(Ie({framebuffer:e.framebuffer.faces[t]},e),f);else Z(e,f);else f(null,e)},prop:Ke.define.bind(null,Go),context:Ke.define.bind(null,No),this:Ke.define.bind(null,Fo),draw:u({}),buffer:function(e){return P.create(e,Co,!1,!1)},elements:function(e){return C.create(e,!1)},texture:G.create2D,cube:G.createCube,renderbuffer:N.create,framebuffer:F.create,framebufferCube:F.createCube,attributes:v,frame:c,on:function(e,t){Xe.type(t,"function","listener callback must be a function");var n;switch(e){case"frame":return c(t);case"lost":n=W;break;case"restore":n=$;break;case"destroy":n=K;break;default:Xe.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:T,hasExtension:function(e){return T.extensions.indexOf(e.toLowerCase())>=0},read:U,destroy:function(){H.length=0,i(),Y&&(Y.removeEventListener(Do,o),Y.removeEventListener(Vo,a)),V.clear(),F.clear(),N.clear(),G.clear(),C.clear(),P.clear(),I.clear(),S&&S.clear(),K.forEach(function(e){e()})},_gl:h,_refresh:d,poll:function(){l(),S&&S.update()},now:p,stats:_});return m.onDone(null,J),J}})},{}],122:[function(e,t,n){"use strict";function r(e){return o(e,[])}function i(e,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return a(e,[],t)}function o(e,t){for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?o(r,t):t.push(r)}return t}function a(e,t,n){n--;for(var r=0;r<e.length;r++){var i=e[r];n>-1&&Array.isArray(i)?a(i,t,n):t.push(i)}return t}t.exports=function(e){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return r(e)},t.exports.from=r,t.exports.depth=function(e,t){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return i(e,t)},t.exports.fromDepth=i},{}],123:[function(e,t,n){(function(n){"use strict";function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return n.Buffer&&"function"==typeof n.Buffer.isBuffer?n.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function a(e){return!i(e)&&("function"==typeof n.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function u(e){if(x.isFunction(e)){if(O)return e.name;var t=e.toString().match(w);return t&&t[1]}}function f(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function c(e){if(O||!x.isFunction(e))return x.inspect(e);var t=u(e);return"[Function"+(t?": "+t:"")+"]"}function s(e){return f(c(e.actual),128)+" "+e.operator+" "+f(c(e.expected),128)}function l(e,t,n,r,i){throw new E.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function d(e,t){e||l(e,!0,t,"==",E.ok)}function p(e,t,n,u){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(x.isDate(e)&&x.isDate(t))return e.getTime()===t.getTime();if(x.isRegExp(e)&&x.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===(void 0===e?"undefined":_(e))||null!==t&&"object"===(void 0===t?"undefined":_(t))){if(a(e)&&a(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var f=(u=u||{actual:[],expected:[]}).actual.indexOf(e);return-1!==f&&f===u.expected.indexOf(t)||(u.actual.push(e),u.expected.push(t),h(e,t,n,u))}return n?e===t:e==t}function m(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function h(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(x.isPrimitive(e)||x.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=m(e),o=m(t);if(i&&!o||!i&&o)return!1;if(i)return e=A.call(e),t=A.call(t),p(e,t,n);var a,u,f=L(e),c=L(t);if(f.length!==c.length)return!1;for(f.sort(),c.sort(),u=f.length-1;u>=0;u--)if(f[u]!==c[u])return!1;for(u=f.length-1;u>=0;u--)if(a=f[u],!p(e[a],t[a],n,r))return!1;return!0}function v(e,t,n){p(e,t,!0)&&l(e,t,n,"notDeepStrictEqual",v)}function y(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function b(e){var t;try{e()}catch(e){t=e}return t}function g(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=b(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&l(i,n,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&x.isError(i),u=!e&&i&&!n;if((a&&o&&y(i,n)||u)&&l(i,n,"Got unwanted exception"+r),e&&i&&n&&!y(i,n)||!e&&i)throw i}var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x=e("util/"),S=Object.prototype.hasOwnProperty,A=Array.prototype.slice,O="foo"===function(){}.name,E=t.exports=d,w=/\s*function\s+([^\(\s]*)\s*/;E.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=s(this),this.generatedMessage=!0);var t=e.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=u(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},x.inherits(E.AssertionError,Error),E.fail=l,E.ok=d,E.equal=function(e,t,n){e!=t&&l(e,t,n,"==",E.equal)},E.notEqual=function(e,t,n){e==t&&l(e,t,n,"!=",E.notEqual)},E.deepEqual=function(e,t,n){p(e,t,!1)||l(e,t,n,"deepEqual",E.deepEqual)},E.deepStrictEqual=function(e,t,n){p(e,t,!0)||l(e,t,n,"deepStrictEqual",E.deepStrictEqual)},E.notDeepEqual=function(e,t,n){p(e,t,!1)&&l(e,t,n,"notDeepEqual",E.notDeepEqual)},E.notDeepStrictEqual=v,E.strictEqual=function(e,t,n){e!==t&&l(e,t,n,"===",E.strictEqual)},E.notStrictEqual=function(e,t,n){e===t&&l(e,t,n,"!==",E.notStrictEqual)},E.throws=function(e,t,n){g(!0,e,t,n)},E.doesNotThrow=function(e,t,n){g(!1,e,t,n)},E.ifError=function(e){if(e)throw e};var L=Object.keys||function(e){var t=[];for(var n in e)S.call(e,n)&&t.push(n);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":312}],124:[function(e,t,n){"use strict";function r(e,t,n){var r=i(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function i(e,t,n){var r,i,o,a,u,f=n.indexOf(e),c=n.indexOf(t,f+1),s=f;if(f>=0&&c>0){for(r=[],o=n.length;s<n.length&&s>=0&&!u;)s==f?(r.push(s),f=n.indexOf(e,s+1)):1==r.length?u=[r.pop(),c]:((i=r.pop())<o&&(o=i,a=c),c=n.indexOf(t,s+1)),s=f<c&&f>=0?f:c;r.length&&(u=[o,a])}return u}t.exports=r,r.range=i},{}],125:[function(e,t,n){"use strict";t.exports=function(e){var t=e.length;if(0===t)return[[],[]];for(var n=e[0].length,r=e[0].slice(),i=e[0].slice(),o=1;o<t;++o)for(var a=e[o],u=0;u<n;++u){var f=a[u];r[u]=Math.min(r[u],f),i[u]=Math.max(i[u],f)}return[r,i]}},{}],126:[function(e,t,n){"use strict"},{}],127:[function(e,t,n){"use strict";t.exports=function(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}},{}],128:[function(e,t,n){(function(r){"use strict";function i(){var e;try{e=n.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(n=t.exports=e("./debug")).log=function(){return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=i,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(i())}).call(this,e("_process"))},{"./debug":129,_process:300}],129:[function(e,t,n){"use strict";function r(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[Math.abs(r)%n.colors.length]}function i(e){function t(){if(t.enabled){var e=t,r=+new Date,i=r-(o||r);e.diff=i,e.prev=o,e.curr=r,o=r;for(var a=new Array(arguments.length),u=0;u<a.length;u++)a[u]=arguments[u];a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var f=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;f++;var i=n.formatters[r];if("function"==typeof i){var o=a[f];t=i.call(e,o),a.splice(f,1),f--}return t}),n.formatArgs.call(e,a),(t.log||n.log||console.log.bind(console)).apply(e,a)}}return t.namespace=e,t.enabled=n.enabled(e),t.useColors=n.useColors(),t.color=r(e),"function"==typeof n.init&&n.init(t),t}(n=t.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e),n.names=[],n.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),r=t.length,i=0;i<r;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var o},{ms:294}],130:[function(e,t,n){"use strict";t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],131:[function(e,t,n){"use strict";var r=e("synthetic-dom-events"),i=function(e,t,n,r){return e.addEventListener(t,n,r||!1)},o=function(e,t,n,r){return e.removeEventListener(t,n,r||!1)},a=function(e,t,n){var i=r(t,n);e.dispatchEvent(i)};document.addEventListener||(i=function(e,t,n){return e.attachEvent("on"+t,n)}),document.removeEventListener||(o=function(e,t,n){return e.detachEvent("on"+t,n)}),document.dispatchEvent||(a=function(e,t,n){var i=r(t,n);return e.fireEvent("on"+i.type,i)}),t.exports={on:i,off:o,once:function(e,t,n,r){function a(i){o(e,t,a,r),n(i)}i(e,t,a,r)},emit:a}},{"synthetic-dom-events":305}],132:[function(e,t,n){"use strict";function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"===(void 0===e?"undefined":f(e))&&null!==e}function u(e){return void 0===e}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,f,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(n=this._events[e],u(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,f=0;f<r;f++)c[f].apply(this,o);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,u;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(u=o;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],133:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},u=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t=i.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!n)return!1;var r;for(r in e);return void 0===r||i.call(e,r)};t.exports=function e(){var t,n,i,o,f,c,s=arguments[0],l=1,d=arguments.length,p=!1;for("boolean"==typeof s&&(p=s,s=arguments[1]||{},l=2),(null==s||"object"!==(void 0===s?"undefined":r(s))&&"function"!=typeof s)&&(s={});l<d;++l)if(null!=(t=arguments[l]))for(n in t)i=s[n],s!==(o=t[n])&&(p&&o&&(u(o)||(f=a(o)))?(f?(f=!1,c=i&&a(i)?i:[]):c=i&&u(i)?i:{},s[n]=e(p,c,o)):void 0!==o&&(s[n]=o));return s}},{}],134:[function(e,t,n){"use strict";var r=e("gl-mat4/invert"),i=new Float32Array(16);t.exports=function(e,t){return t||(t=[]),r(i,e),t[0]=i[12],t[1]=i[13],t[2]=i[14],t}},{"gl-mat4/invert":164}],135:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8];return e[0]=a*s-u*c,e[1]=i*c-r*s,e[2]=r*u-i*a,e[3]=u*f-o*s,e[4]=n*s-i*f,e[5]=i*o-n*u,e[6]=o*c-a*f,e[7]=r*f-n*c,e[8]=n*a-r*o,e}},{}],136:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}},{}],137:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}},{}],138:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},{}],139:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],f=e[7],c=e[8];return t*(c*o-a*f)+n*(a*u-c*i)+r*(f*i-o*u)}},{}],140:[function(e,t,n){"use strict";t.exports=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8])}},{}],141:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}},{}],142:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}},{}],143:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,u=r+r,f=i+i,c=n*a,s=r*a,l=r*u,d=i*a,p=i*u,m=i*f,h=o*a,v=o*u,y=o*f;return e[0]=1-l-m,e[3]=s-y,e[6]=d+v,e[1]=s+y,e[4]=1-c-m,e[7]=p-h,e[2]=d-v,e[5]=p+h,e[8]=1-c-l,e}},{}],144:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},{}],145:[function(e,t,n){"use strict";t.exports={adjoint:e("./adjoint"),clone:e("./clone"),copy:e("./copy"),create:e("./create"),determinant:e("./determinant"),frob:e("./frob"),fromMat2:e("./from-mat2"),fromMat4:e("./from-mat4"),fromQuat:e("./from-quat"),identity:e("./identity"),invert:e("./invert"),multiply:e("./multiply"),normalFromMat4:e("./normal-from-mat4"),rotate:e("./rotate"),scale:e("./scale"),str:e("./str"),translate:e("./translate"),transpose:e("./transpose")}},{"./adjoint":135,"./clone":136,"./copy":137,"./create":138,"./determinant":139,"./frob":140,"./from-mat2":141,"./from-mat4":142,"./from-quat":143,"./identity":144,"./invert":146,"./multiply":147,"./normal-from-mat4":148,"./rotate":149,"./scale":150,"./str":151,"./translate":152,"./transpose":153}],146:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=s*a-u*c,d=-s*o+u*f,p=c*o-a*f,m=n*l+r*d+i*p;return m?(m=1/m,e[0]=l*m,e[1]=(-s*r+i*c)*m,e[2]=(u*r-i*a)*m,e[3]=d*m,e[4]=(s*n-i*f)*m,e[5]=(-u*n+i*o)*m,e[6]=p*m,e[7]=(-c*n+r*f)*m,e[8]=(a*n-r*o)*m,e):null}},{}],147:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=n[0],p=n[1],m=n[2],h=n[3],v=n[4],y=n[5],b=n[6],g=n[7],_=n[8];return e[0]=d*r+p*a+m*c,e[1]=d*i+p*u+m*s,e[2]=d*o+p*f+m*l,e[3]=h*r+v*a+y*c,e[4]=h*i+v*u+y*s,e[5]=h*o+v*f+y*l,e[6]=b*r+g*a+_*c,e[7]=b*i+g*u+_*s,e[8]=b*o+g*f+_*l,e}},{}],148:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],d=t[10],p=t[11],m=t[12],h=t[13],v=t[14],y=t[15],b=n*u-r*a,g=n*f-i*a,_=n*c-o*a,x=r*f-i*u,S=r*c-o*u,A=i*c-o*f,O=s*h-l*m,E=s*v-d*m,w=s*y-p*m,L=l*v-d*h,M=l*y-p*h,j=d*y-p*v,T=b*j-g*M+_*L+x*w-S*E+A*O;return T?(T=1/T,e[0]=(u*j-f*M+c*L)*T,e[1]=(f*w-a*j-c*E)*T,e[2]=(a*M-u*w+c*O)*T,e[3]=(i*M-r*j-o*L)*T,e[4]=(n*j-i*w+o*E)*T,e[5]=(r*w-n*M-o*O)*T,e[6]=(h*A-v*S+y*x)*T,e[7]=(v*_-m*A-y*g)*T,e[8]=(m*S-h*_+y*b)*T,e):null}},{}],149:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=Math.sin(n),p=Math.cos(n);return e[0]=p*r+d*a,e[1]=p*i+d*u,e[2]=p*o+d*f,e[3]=p*a-d*r,e[4]=p*u-d*i,e[5]=p*f-d*o,e[6]=c,e[7]=s,e[8]=l,e}},{}],150:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}},{}],151:[function(e,t,n){"use strict";t.exports=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}},{}],152:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=u,e[5]=f,e[6]=d*r+p*a+c,e[7]=d*i+p*u+s,e[8]=d*o+p*f+l,e}},{}],153:[function(e,t,n){"use strict";t.exports=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}},{}],154:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],d=t[10],p=t[11],m=t[12],h=t[13],v=t[14],y=t[15];return e[0]=u*(d*y-p*v)-l*(f*y-c*v)+h*(f*p-c*d),e[1]=-(r*(d*y-p*v)-l*(i*y-o*v)+h*(i*p-o*d)),e[2]=r*(f*y-c*v)-u*(i*y-o*v)+h*(i*c-o*f),e[3]=-(r*(f*p-c*d)-u*(i*p-o*d)+l*(i*c-o*f)),e[4]=-(a*(d*y-p*v)-s*(f*y-c*v)+m*(f*p-c*d)),e[5]=n*(d*y-p*v)-s*(i*y-o*v)+m*(i*p-o*d),e[6]=-(n*(f*y-c*v)-a*(i*y-o*v)+m*(i*c-o*f)),e[7]=n*(f*p-c*d)-a*(i*p-o*d)+s*(i*c-o*f),e[8]=a*(l*y-p*h)-s*(u*y-c*h)+m*(u*p-c*l),e[9]=-(n*(l*y-p*h)-s*(r*y-o*h)+m*(r*p-o*l)),e[10]=n*(u*y-c*h)-a*(r*y-o*h)+m*(r*c-o*u),e[11]=-(n*(u*p-c*l)-a*(r*p-o*l)+s*(r*c-o*u)),e[12]=-(a*(l*v-d*h)-s*(u*v-f*h)+m*(u*d-f*l)),e[13]=n*(l*v-d*h)-s*(r*v-i*h)+m*(r*d-i*l),e[14]=-(n*(u*v-f*h)-a*(r*v-i*h)+m*(r*f-i*u)),e[15]=n*(u*d-f*l)-a*(r*d-i*l)+s*(r*f-i*u),e}},{}],155:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],156:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],157:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],158:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],f=e[7],c=e[8],s=e[9],l=e[10],d=e[11],p=e[12],m=e[13],h=e[14],v=e[15];return(t*a-n*o)*(l*v-d*h)-(t*u-r*o)*(s*v-d*m)+(t*f-i*o)*(s*h-l*m)+(n*u-r*a)*(c*v-d*p)-(n*f-i*a)*(c*h-l*p)+(r*f-i*u)*(c*m-s*p)}},{}],159:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,u=r+r,f=i+i,c=n*a,s=r*a,l=r*u,d=i*a,p=i*u,m=i*f,h=o*a,v=o*u,y=o*f;return e[0]=1-l-m,e[1]=s+y,e[2]=d-v,e[3]=0,e[4]=s-y,e[5]=1-c-m,e[6]=p+h,e[7]=0,e[8]=d+v,e[9]=p-h,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],160:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=r+r,f=i+i,c=o+o,s=r*u,l=r*f,d=r*c,p=i*f,m=i*c,h=o*c,v=a*u,y=a*f,b=a*c;return e[0]=1-(p+h),e[1]=l+b,e[2]=d-y,e[3]=0,e[4]=l-b,e[5]=1-(s+h),e[6]=m+v,e[7]=0,e[8]=d+y,e[9]=m-v,e[10]=1-(s+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],161:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i,o,a){var u=1/(n-t),f=1/(i-r),c=1/(o-a);return e[0]=2*o*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*f,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(i+r)*f,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}},{}],162:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],163:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":154,"./clone":155,"./copy":156,"./create":157,"./determinant":158,"./fromQuat":159,"./fromRotationTranslation":160,"./frustum":161,"./identity":162,"./invert":164,"./lookAt":165,"./multiply":166,"./ortho":167,"./perspective":168,"./perspectiveFromFieldOfView":169,"./rotate":170,"./rotateX":171,"./rotateY":172,"./rotateZ":173,"./scale":174,"./str":175,"./translate":176,"./transpose":177}],164:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],d=t[10],p=t[11],m=t[12],h=t[13],v=t[14],y=t[15],b=n*u-r*a,g=n*f-i*a,_=n*c-o*a,x=r*f-i*u,S=r*c-o*u,A=i*c-o*f,O=s*h-l*m,E=s*v-d*m,w=s*y-p*m,L=l*v-d*h,M=l*y-p*h,j=d*y-p*v,T=b*j-g*M+_*L+x*w-S*E+A*O;return T?(T=1/T,e[0]=(u*j-f*M+c*L)*T,e[1]=(i*M-r*j-o*L)*T,e[2]=(h*A-v*S+y*x)*T,e[3]=(d*S-l*A-p*x)*T,e[4]=(f*w-a*j-c*E)*T,e[5]=(n*j-i*w+o*E)*T,e[6]=(v*_-m*A-y*g)*T,e[7]=(s*A-d*_+p*g)*T,e[8]=(a*M-u*w+c*O)*T,e[9]=(r*w-n*M-o*O)*T,e[10]=(m*S-h*_+y*b)*T,e[11]=(l*_-s*S-p*b)*T,e[12]=(u*E-a*L-f*O)*T,e[13]=(n*L-r*E+i*O)*T,e[14]=(h*g-m*x-v*b)*T,e[15]=(s*x-l*g+d*b)*T,e):null}},{}],165:[function(e,t,n){"use strict";var r=e("./identity");t.exports=function(e,t,n,i){var o,a,u,f,c,s,l,d,p,m,h=t[0],v=t[1],y=t[2],b=i[0],g=i[1],_=i[2],x=n[0],S=n[1],A=n[2];return Math.abs(h-x)<1e-6&&Math.abs(v-S)<1e-6&&Math.abs(y-A)<1e-6?r(e):(l=h-x,d=v-S,p=y-A,m=1/Math.sqrt(l*l+d*d+p*p),l*=m,d*=m,p*=m,o=g*p-_*d,a=_*l-b*p,u=b*d-g*l,(m=Math.sqrt(o*o+a*a+u*u))?(o*=m=1/m,a*=m,u*=m):(o=0,a=0,u=0),f=d*u-p*a,c=p*o-l*u,s=l*a-d*o,(m=Math.sqrt(f*f+c*c+s*s))?(f*=m=1/m,c*=m,s*=m):(f=0,c=0,s=0),e[0]=o,e[1]=f,e[2]=l,e[3]=0,e[4]=a,e[5]=c,e[6]=d,e[7]=0,e[8]=u,e[9]=s,e[10]=p,e[11]=0,e[12]=-(o*h+a*v+u*y),e[13]=-(f*h+c*v+s*y),e[14]=-(l*h+d*v+p*y),e[15]=1,e)}},{"./identity":162}],166:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=t[9],p=t[10],m=t[11],h=t[12],v=t[13],y=t[14],b=t[15],g=n[0],_=n[1],x=n[2],S=n[3];return e[0]=g*r+_*u+x*l+S*h,e[1]=g*i+_*f+x*d+S*v,e[2]=g*o+_*c+x*p+S*y,e[3]=g*a+_*s+x*m+S*b,g=n[4],_=n[5],x=n[6],S=n[7],e[4]=g*r+_*u+x*l+S*h,e[5]=g*i+_*f+x*d+S*v,e[6]=g*o+_*c+x*p+S*y,e[7]=g*a+_*s+x*m+S*b,g=n[8],_=n[9],x=n[10],S=n[11],e[8]=g*r+_*u+x*l+S*h,e[9]=g*i+_*f+x*d+S*v,e[10]=g*o+_*c+x*p+S*y,e[11]=g*a+_*s+x*m+S*b,g=n[12],_=n[13],x=n[14],S=n[15],e[12]=g*r+_*u+x*l+S*h,e[13]=g*i+_*f+x*d+S*v,e[14]=g*o+_*c+x*p+S*y,e[15]=g*a+_*s+x*m+S*b,e}},{}],167:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i,o,a){var u=1/(t-n),f=1/(r-i),c=1/(o-a);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*u,e[13]=(i+r)*f,e[14]=(a+o)*c,e[15]=1,e}},{}],168:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}},{}],169:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),f=2/(a+u),c=2/(i+o);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-u)*f*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}},{}],170:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i,o,a,u,f,c,s,l,d,p,m,h,v,y,b,g,_,x,S,A,O,E,w,L,M=r[0],j=r[1],T=r[2],R=Math.sqrt(M*M+j*j+T*T);return Math.abs(R)<1e-6?null:(R=1/R,M*=R,j*=R,T*=R,i=Math.sin(n),o=Math.cos(n),a=1-o,u=t[0],f=t[1],c=t[2],s=t[3],l=t[4],d=t[5],p=t[6],m=t[7],h=t[8],v=t[9],y=t[10],b=t[11],g=M*M*a+o,_=j*M*a+T*i,x=T*M*a-j*i,S=M*j*a-T*i,A=j*j*a+o,O=T*j*a+M*i,E=M*T*a+j*i,w=j*T*a-M*i,L=T*T*a+o,e[0]=u*g+l*_+h*x,e[1]=f*g+d*_+v*x,e[2]=c*g+p*_+y*x,e[3]=s*g+m*_+b*x,e[4]=u*S+l*A+h*O,e[5]=f*S+d*A+v*O,e[6]=c*S+p*A+y*O,e[7]=s*S+m*A+b*O,e[8]=u*E+l*w+h*L,e[9]=f*E+d*w+v*L,e[10]=c*E+p*w+y*L,e[11]=s*E+m*w+b*L,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}},{}],171:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],u=t[6],f=t[7],c=t[8],s=t[9],l=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+s*r,e[6]=u*i+l*r,e[7]=f*i+d*r,e[8]=c*i-o*r,e[9]=s*i-a*r,e[10]=l*i-u*r,e[11]=d*i-f*r,e}},{}],172:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],u=t[2],f=t[3],c=t[8],s=t[9],l=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-s*r,e[2]=u*i-l*r,e[3]=f*i-d*r,e[8]=o*r+c*i,e[9]=a*r+s*i,e[10]=u*r+l*i,e[11]=f*r+d*i,e}},{}],173:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],u=t[2],f=t[3],c=t[4],s=t[5],l=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+s*r,e[2]=u*i+l*r,e[3]=f*i+d*r,e[4]=c*i-o*r,e[5]=s*i-a*r,e[6]=l*i-u*r,e[7]=d*i-f*r,e}},{}],174:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],175:[function(e,t,n){"use strict";t.exports=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],176:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r,i,o,a,u,f,c,s,l,d,p,m,h=n[0],v=n[1],y=n[2];return t===e?(e[12]=t[0]*h+t[4]*v+t[8]*y+t[12],e[13]=t[1]*h+t[5]*v+t[9]*y+t[13],e[14]=t[2]*h+t[6]*v+t[10]*y+t[14],e[15]=t[3]*h+t[7]*v+t[11]*y+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],d=t[9],p=t[10],m=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=u,e[5]=f,e[6]=c,e[7]=s,e[8]=l,e[9]=d,e[10]=p,e[11]=m,e[12]=r*h+u*v+l*y+t[12],e[13]=i*h+f*v+d*y+t[13],e[14]=o*h+c*v+p*y+t[14],e[15]=a*h+s*v+m*y+t[15]),e}},{}],177:[function(e,t,n){"use strict";t.exports=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],178:[function(e,t,n){"use strict";t.exports=e("gl-vec4/add")},{"gl-vec4/add":267}],179:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}},{}],180:[function(e,t,n){"use strict";t.exports=e("gl-vec4/clone")},{"gl-vec4/clone":268}],181:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}},{}],182:[function(e,t,n){"use strict";t.exports=e("gl-vec4/copy")},{"gl-vec4/copy":269}],183:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{}],184:[function(e,t,n){"use strict";t.exports=e("gl-vec4/dot")},{"gl-vec4/dot":270}],185:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}},{}],186:[function(e,t,n){"use strict";t.exports=e("gl-vec4/fromValues")},{"gl-vec4/fromValues":271}],187:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{}],188:[function(e,t,n){"use strict";t.exports={add:e("./add"),calculateW:e("./calculateW"),clone:e("./clone"),conjugate:e("./conjugate"),copy:e("./copy"),create:e("./create"),dot:e("./dot"),fromMat3:e("./fromMat3"),fromValues:e("./fromValues"),identity:e("./identity"),invert:e("./invert"),length:e("./length"),lerp:e("./lerp"),multiply:e("./multiply"),normalize:e("./normalize"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),rotationTo:e("./rotationTo"),scale:e("./scale"),set:e("./set"),setAxes:e("./setAxes"),setAxisAngle:e("./setAxisAngle"),slerp:e("./slerp"),sqlerp:e("./sqlerp"),squaredLength:e("./squaredLength")}},{"./add":178,"./calculateW":179,"./clone":180,"./conjugate":181,"./copy":182,"./create":183,"./dot":184,"./fromMat3":185,"./fromValues":186,"./identity":187,"./invert":189,"./length":190,"./lerp":191,"./multiply":192,"./normalize":193,"./rotateX":194,"./rotateY":195,"./rotateZ":196,"./rotationTo":197,"./scale":198,"./set":199,"./setAxes":200,"./setAxisAngle":201,"./slerp":202,"./sqlerp":203,"./squaredLength":204}],189:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=o*u,e}},{}],190:[function(e,t,n){"use strict";t.exports=e("gl-vec4/length")},{"gl-vec4/length":272}],191:[function(e,t,n){"use strict";t.exports=e("gl-vec4/lerp")},{"gl-vec4/lerp":273}],192:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],u=n[0],f=n[1],c=n[2],s=n[3];return e[0]=r*s+a*u+i*c-o*f,e[1]=i*s+a*f+o*u-r*c,e[2]=o*s+a*c+r*f-i*u,e[3]=a*s-r*u-i*f-o*c,e}},{}],193:[function(e,t,n){"use strict";t.exports=e("gl-vec4/normalize")},{"gl-vec4/normalize":274}],194:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f+a*u,e[1]=i*f+o*u,e[2]=o*f-i*u,e[3]=a*f-r*u,e}},{}],195:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f-o*u,e[1]=i*f+a*u,e[2]=o*f+r*u,e[3]=a*f-i*u,e}},{}],196:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f+i*u,e[1]=i*f-r*u,e[2]=o*f+a*u,e[3]=a*f-o*u,e}},{}],197:[function(e,t,n){"use strict";var r=e("gl-vec3/dot"),i=e("gl-vec3/cross"),o=e("gl-vec3/length"),a=e("gl-vec3/normalize"),u=e("./normalize"),f=e("./setAxisAngle");t.exports=function(e,t,n){var d=r(t,n);return d<-.999999?(i(c,s,t),o(c)<1e-6&&i(c,l,t),a(c,c),f(e,c,Math.PI),e):d>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(i(c,t,n),e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=1+d,u(e,e))};var c=[0,0,0],s=[1,0,0],l=[0,1,0]},{"./normalize":193,"./setAxisAngle":201,"gl-vec3/cross":239,"gl-vec3/dot":242,"gl-vec3/length":247,"gl-vec3/normalize":253}],198:[function(e,t,n){"use strict";t.exports=e("gl-vec4/scale")},{"gl-vec4/scale":275}],199:[function(e,t,n){"use strict";t.exports=e("gl-vec4/set")},{"gl-vec4/set":276}],200:[function(e,t,n){"use strict";var r=e("gl-mat3/create"),i=e("./fromMat3"),o=e("./normalize");t.exports=function(e,t,n,r){return a[0]=n[0],a[3]=n[1],a[6]=n[2],a[1]=r[0],a[4]=r[1],a[7]=r[2],a[2]=-t[0],a[5]=-t[1],a[8]=-t[2],o(e,i(e,a))};var a=r()},{"./fromMat3":185,"./normalize":193,"gl-mat3/create":138}],201:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}},{}],202:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i,o,a,u,f,c=t[0],s=t[1],l=t[2],d=t[3],p=n[0],m=n[1],h=n[2],v=n[3];return(o=c*p+s*m+l*h+d*v)<0&&(o=-o,p=-p,m=-m,h=-h,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,f=Math.sin(r*i)/a):(u=1-r,f=r),e[0]=u*c+f*p,e[1]=u*s+f*m,e[2]=u*l+f*h,e[3]=u*d+f*v,e}},{}],203:[function(e,t,n){"use strict";var r=e("./slerp");t.exports=function(e,t,n,a,u,f){return r(i,t,u,f),r(o,n,a,f),r(e,i,o,2*f*(1-f)),e};var i=[0,0,0,1],o=[0,0,0,1]},{"./slerp":202}],204:[function(e,t,n){"use strict";t.exports=e("gl-vec4/squaredLength")},{"gl-vec4/squaredLength":277}],205:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}},{}],206:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}},{}],207:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e}},{}],208:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e}},{}],209:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}},{}],210:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}},{}],211:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}},{}],212:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]}},{}],213:[function(e,t,n){"use strict";t.exports=function(e,t,n,i,o,a){var u,f;for(t||(t=2),n||(n=0),f=i?Math.min(i*t+n,e.length):e.length,u=n;u<f;u+=t)r[0]=e[u],r[1]=e[u+1],o(r,r,a),e[u]=r[0],e[u+1]=r[1];return e};var r=e("./create")()},{"./create":208}],214:[function(e,t,n){"use strict";t.exports=function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n}},{}],215:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat2:e("./transformMat2"),transformMat2d:e("./transformMat2d"),transformMat3:e("./transformMat3"),transformMat4:e("./transformMat4"),forEach:e("./forEach")}},{"./add":205,"./clone":206,"./copy":207,"./create":208,"./cross":209,"./distance":210,"./divide":211,"./dot":212,"./forEach":213,"./fromValues":214,"./length":216,"./lerp":217,"./max":218,"./min":219,"./multiply":220,"./negate":221,"./normalize":222,"./random":223,"./scale":224,"./scaleAndAdd":225,"./set":226,"./squaredDistance":227,"./squaredLength":228,"./subtract":229,"./transformMat2":230,"./transformMat2d":231,"./transformMat3":232,"./transformMat4":233}],216:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}},{}],217:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}},{}],218:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}},{}],219:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}},{}],220:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}},{}],221:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e}},{}],222:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}},{}],223:[function(e,t,n){"use strict";t.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}},{}],224:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}},{}],225:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}},{}],226:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t,e[1]=n,e}},{}],227:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}},{}],228:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1];return t*t+n*n}},{}],229:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}},{}],230:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}},{}],231:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}},{}],232:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}},{}],233:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}},{}],234:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],235:[function(e,t,n){"use strict";t.exports=function(e,t){var n=r(e[0],e[1],e[2]),a=r(t[0],t[1],t[2]);i(n,n),i(a,a);var u=o(n,a);return u>1?0:Math.acos(u)};var r=e("./fromValues"),i=e("./normalize"),o=e("./dot")},{"./dot":242,"./fromValues":244,"./normalize":253}],236:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],237:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],238:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],239:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],u=n[1],f=n[2];return e[0]=i*f-o*u,e[1]=o*a-r*f,e[2]=r*u-i*a,e}},{}],240:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},{}],241:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},{}],242:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],243:[function(e,t,n){"use strict";t.exports=function(e,t,n,i,o,a){var u,f;for(t||(t=3),n||(n=0),f=i?Math.min(i*t+n,e.length):e.length,u=n;u<f;u+=t)r[0]=e[u],r[1]=e[u+1],r[2]=e[u+2],o(r,r,a),e[u]=r[0],e[u+1]=r[1],e[u+2]=r[2];return e};var r=e("./create")()},{"./create":238}],244:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},{}],245:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":234,"./angle":235,"./clone":236,"./copy":237,"./create":238,"./cross":239,"./distance":240,"./divide":241,"./dot":242,"./forEach":243,"./fromValues":244,"./inverse":246,"./length":247,"./lerp":248,"./max":249,"./min":250,"./multiply":251,"./negate":252,"./normalize":253,"./random":254,"./rotateX":255,"./rotateY":256,"./rotateZ":257,"./scale":258,"./scaleAndAdd":259,"./set":260,"./squaredDistance":261,"./squaredLength":262,"./subtract":263,"./transformMat3":264,"./transformMat4":265,"./transformQuat":266}],246:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],247:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},{}],248:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}},{}],249:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},{}],250:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},{}],251:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},{}],252:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],253:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}},{}],254:[function(e,t,n){"use strict";t.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}},{}],255:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}},{}],256:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}},{}],257:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}},{}],258:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},{}],259:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},{}],260:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},{}],261:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}},{}],262:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},{}],263:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},{}],264:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}},{}],265:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}},{}],266:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],u=n[1],f=n[2],c=n[3],s=c*r+u*o-f*i,l=c*i+f*r-a*o,d=c*o+a*i-u*r,p=-a*r-u*i-f*o;return e[0]=s*c+p*-a+l*-f-d*-u,e[1]=l*c+p*-u+d*-a-s*-f,e[2]=d*c+p*-f+s*-u-l*-a,e}},{}],267:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}},{}],268:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],269:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],270:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],271:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}},{}],272:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}},{}],273:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],u=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=u+r*(n[3]-u),e}},{}],274:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e}},{}],275:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}},{}],276:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}},{}],277:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}},{}],278:[function(e,t,n){(function(n){"use strict";var r,i=void 0!==n?n:"undefined"!=typeof window?window:{},o=e("min-document");"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":126}],279:[function(e,t,n){(function(e){"use strict";var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],280:[function(e,t,n){"use strict";var r=e("glsl-tokenizer"),i=e("glsl-token-string"),o=e("glsl-token-inject-block");t.exports=function(e,t){if(!t)return e;var n=Object.keys(t);if(0===n.length)return e;for(var a=r(e),u=n.length-1;u>=0;u--){var f=n[u],c=String(t[f]);c&&(c=" "+c),o(a,{type:"preprocessor",data:"#define "+f+c})}return i(a)}},{"glsl-token-inject-block":282,"glsl-token-string":283,"glsl-tokenizer":290}],281:[function(e,t,n){"use strict";t.exports=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if("preprocessor"===r.type){var i=r.data.trim();if(!i.indexOf("#define")){var o=i.match(/#define\s+([^\s]+)(.+)?$/i);if(o){var a=(o[1]||"").trim(),u=(o[2]||"").trim();t[a]=u}}}}return t}},{}],282:[function(e,t,n){"use strict";function r(e){for(var t=-1,n=0;n<e.length;n++){var r=e[n];if("preprocessor"===r.type)/^#(extension|version)/.test(r.data)&&(t=Math.max(t,n));else if("keyword"===r.type&&"precision"===r.data){var o=i(e,n);if(-1===o)throw new Error("precision statement not followed by any semicolons!");t=Math.max(t,o)}}return t+1}function i(e,t){for(var n=t;n<e.length;n++)if("operator"===e[n].type&&";"===e[n].data)return n;return-1}t.exports=function(e,t){Array.isArray(t)||(t=[t]);var n=r(e),i=n>0?e[n-1]:null;i&&a.test(i.data)&&e.splice(n++,0,o),e.splice.apply(e,[n,0].concat(t));var u=n+t.length;return e[u]&&/[^\r\n]$/.test(e[u].data)&&e.splice(u,0,o),e};var o={data:"\n",type:"whitespace"},a=/[^\r\n]$/},{}],283:[function(e,t,n){"use strict";t.exports=function(e){for(var t=[],n=0;n<e.length;n++)"eof"!==e[n].type&&t.push(e[n].data);return t.join("")}},{}],284:[function(e,t,n){"use strict";t.exports=function(e){function t(e){e.length&&U.push({type:S[F],data:e,position:H,line:z,column:Y})}function n(e){G=0,V=(W+=e).length;for(var t;C=W[G],G<V;){switch(t=G,F){case s:G=M();break;case l:G=L();break;case d:G=w();break;case p:G=j();break;case m:G=k();break;case x:G=R();break;case h:G=I();break;case c:G=P();break;case g:G=E();break;case f:G=O()}if(t!==G)switch(W[t]){case"\n":Y=0,++z;break;default:++Y}}return N+=G,W=W.slice(G),U}function A(e){return B.length&&t(B.join("")),F=_,t("(eof)"),U}function O(){return B=B.length?[]:B,"/"===D&&"*"===C?(H=N+G-1,F=s,D=C,G+1):"/"===D&&"/"===C?(H=N+G-1,F=l,D=C,G+1):"#"===C?(F=d,H=N+G,G):/\s/.test(C)?(F=g,H=N+G,G):(q=/\d/.test(C),X=/[^\w_]/.test(C),H=N+G,F=q?m:X?p:c,G)}function E(){return/[^\s]/g.test(C)?(t(B.join("")),F=f,G):(B.push(C),D=C,G+1)}function w(){return"\r"!==C&&"\n"!==C||"\\"===D?(B.push(C),D=C,G+1):(t(B.join("")),F=f,G)}function L(){return w()}function M(){return"/"===C&&"*"===D?(B.push(C),t(B.join("")),F=f,G+1):(B.push(C),D=C,G+1)}function j(){if("."===D&&/\d/.test(C))return F=h,G;if("/"===D&&"*"===C)return F=s,G;if("/"===D&&"/"===C)return F=l,G;if("."===C&&B.length){for(;T(B););return F=h,G}if(";"===C||")"===C||"("===C){if(B.length)for(;T(B););return t(C),F=f,G+1}var e=2===B.length&&"="!==C;if(/[\w_\d\s]/.test(C)||e){for(;T(B););return F=f,G}return B.push(C),D=C,G+1}function T(e){for(var n,r,o=0;;){if(n=i.indexOf(e.slice(0,e.length+o).join("")),r=i[n],-1===n){if(o--+e.length>0)continue;r=e.slice(0,1).join("")}return t(r),H+=r.length,(B=B.slice(r.length)).length}}function R(){return/[^a-fA-F0-9]/.test(C)?(t(B.join("")),F=f,G):(B.push(C),D=C,G+1)}function k(){return"."===C?(B.push(C),F=h,D=C,G+1):/[eE]/.test(C)?(B.push(C),F=h,D=C,G+1):"x"===C&&1===B.length&&"0"===B[0]?(F=x,B.push(C),D=C,G+1):/[^\d]/.test(C)?(t(B.join("")),F=f,G):(B.push(C),D=C,G+1)}function I(){return"f"===C&&(B.push(C),D=C,G+=1),/[eE]/.test(C)?(B.push(C),D=C,G+1):"-"===C&&/[eE]/.test(D)?(B.push(C),D=C,G+1):/[^\d]/.test(C)?(t(B.join("")),F=f,G):(B.push(C),D=C,G+1)}function P(){if(/[^\d\w_]/.test(C)){var e=B.join("");return F=K.indexOf(e)>-1?b:$.indexOf(e)>-1?y:v,t(B.join("")),F=f,G}return B.push(C),D=C,G+1}var C,D,V,G=0,N=0,F=f,B=[],U=[],z=1,Y=0,H=0,q=!1,X=!1,W="",$=o,K=r;return"300 es"===(e=e||{}).version&&($=u,K=a),function(e){return U=[],null!==e?n(e.replace?e.replace(/\r\n/g,"\n"):e):A()}};var r=e("./lib/literals"),i=e("./lib/operators"),o=e("./lib/builtins"),a=e("./lib/literals-300es"),u=e("./lib/builtins-300es"),f=999,c=9999,s=0,l=1,d=2,p=3,m=4,h=5,v=6,y=7,b=8,g=9,_=10,x=11,S=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":286,"./lib/builtins-300es":285,"./lib/literals":288,"./lib/literals-300es":287,"./lib/operators":289}],285:[function(e,t,n){"use strict";var r=e("./builtins");r=r.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),t.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":286}],286:[function(e,t,n){"use strict";t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],287:[function(e,t,n){"use strict";var r=e("./literals");t.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":288}],288:[function(e,t,n){"use strict";t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],289:[function(e,t,n){"use strict";t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],290:[function(e,t,n){"use strict";var r=e("./index");t.exports=function(e,t){var n=r(t),i=[];return i=i.concat(n(e)),i=i.concat(n(null))}},{"./index":284}],291:[function(e,t,n){"use strict";t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],292:[function(e,t,n){"use strict";function r(e){return i(e)||o(e)}function i(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function o(e){return u[a.call(e)]}t.exports=r,r.strict=i,r.loose=o;var a=Object.prototype.toString,u={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0}},{}],293:[function(e,t,n){"use strict";t.exports=function(e){for(var t=[],n=[],r=0,i=0;r<e.length;)n.push([i++,i++,i++]),t.push([e[r++],e[r++],e[r++]],[e[r++],e[r++],e[r++]],[e[r++],e[r++],e[r++]]);return{positions:t,cells:n}}},{}],294:[function(e,t,n){"use strict";function r(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function i(e){return e>=l?Math.round(e/l)+"d":e>=s?Math.round(e/s)+"h":e>=c?Math.round(e/c)+"m":e>=f?Math.round(e/f)+"s":e+"ms"}function o(e){return a(e,l,"day")||a(e,s,"hour")||a(e,c,"minute")||a(e,f,"second")||e+" ms"}function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=1e3,c=60*f,s=60*c,l=24*s,d=365.25*l;t.exports=function(e,t){t=t||{};var n=void 0===e?"undefined":u(e);if("string"===n&&e.length>0)return r(e);if("number"===n&&!1===isNaN(e))return t.long?o(e):i(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],295:[function(e,t,n){"use strict";n.vertexNormals=function(e,t,n){for(var r=t.length,i=new Array(r),o=void 0===n?1e-6:n,a=0;a<r;++a)i[a]=[0,0,0];for(a=0;a<e.length;++a)for(var u=e[a],f=0,c=u[u.length-1],s=u[0],l=0;l<u.length;++l){f=c,c=s,s=u[(l+1)%u.length];for(var d=t[f],p=t[c],m=t[s],h=new Array(3),v=0,y=new Array(3),b=0,g=0;g<3;++g)h[g]=d[g]-p[g],v+=h[g]*h[g],y[g]=m[g]-p[g],b+=y[g]*y[g];if(v*b>o)for(var _=i[c],x=1/Math.sqrt(v*b),g=0;g<3;++g){var S=(g+1)%3,A=(g+2)%3;_[g]+=x*(y[S]*h[A]-y[A]*h[S])}}for(a=0;a<r;++a){for(var _=i[a],O=0,g=0;g<3;++g)O+=_[g]*_[g];if(O>o)for(var x=1/Math.sqrt(O),g=0;g<3;++g)_[g]*=x;else for(g=0;g<3;++g)_[g]=0}return i},n.faceNormals=function(e,t,n){for(var r=e.length,i=new Array(r),o=void 0===n?1e-6:n,a=0;a<r;++a){for(var u=e[a],f=new Array(3),c=0;c<3;++c)f[c]=t[u[c]];for(var s=new Array(3),l=new Array(3),c=0;c<3;++c)s[c]=f[1][c]-f[0][c],l[c]=f[2][c]-f[0][c];for(var d=new Array(3),p=0,c=0;c<3;++c){var m=(c+1)%3,h=(c+2)%3;d[c]=s[m]*l[h]-s[h]*l[m],p+=d[c]*d[c]}p=p>o?1/Math.sqrt(p):0;for(c=0;c<3;++c)d[c]*=p;i[a]=d}return i}},{}],296:[function(e,t,n){"use strict";function r(e,t){function n(e,t,r){for(var i,o=[],a=0;i=u.exec(e);){if(a++>1e4)throw Error("Circular references in parenthesis");o.push(e.slice(0,i.index)),o.push(n(t[i[1]],t)),e=e.slice(i.index+i[0].length)}return o.push(e),o}if("string"!=typeof e)return[e];var r=[e],i=(t=t||{}).brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],o=t.escape||"___",a=!!t.flat;i.forEach(function(e){function t(t,n,a){var u=r.push(t.slice(e[0].length,-e[1].length))-1;return i.push(u),o+u}var n=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),i=[];r.forEach(function(e,i){for(var o,a=0;e!=o;)if(o=e,e=e.replace(n,t),a++>1e4)throw Error("References have circular dependency. Please, check them.");r[i]=e}),i=i.reverse(),r=r.map(function(t){return i.forEach(function(n){t=t.replace(new RegExp("(\\"+o+n+"(?![0-9]))","g"),e[0]+"$1"+e[1])}),t})});var u=new RegExp("\\"+o+"([0-9]+)");return a?r:n(r[0],r)}function i(e,t){if(t&&t.flat){var n,r=t&&t.escape||"___",i=e[0];if(!i)return"";for(var o=new RegExp("\\"+r+"([0-9]+)"),a=0;i!=n;){if(a++>1e4)throw Error("Circular references in "+e);n=i,i=i.replace(o,function(t,n){if(null==e[n])throw Error("Reference "+n+"is undefined");return e[n]})}return i}return e.reduce(function e(t,n){return Array.isArray(n)&&(n=n.reduce(e,"")),t+n},"")}function o(e,t){return Array.isArray(e)?i(e,t):r(e,t)}o.parse=r,o.stringify=i,t.exports=o},{}],297:[function(e,t,n){(function(e){"use strict";function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return i.exec(e).slice(1)};n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,i="/"===a.charAt(0))}return n=t(r(n.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(e){var i=n.isAbsolute(e),o="/"===a(e,-1);return(e=t(r(e.split("/"),function(e){return!!e}),!i).join("/"))||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),o=r(t.split("/")),a=Math.min(i.length,o.length),u=a,f=0;f<a;f++)if(i[f]!==o[f]){u=f;break}for(var c=[],f=u;f<i.length;f++)c.push("..");return(c=c.concat(o.slice(u))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=o(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=o(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return o(e)[3]};var a=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:300}],298:[function(e,t,n){(function(e){"use strict";(function(){var n,r,i,o,a,u;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:void 0!==e&&null!==e&&e.hrtime?(t.exports=function(){return(n()-a)/1e6},r=e.hrtime,o=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),u=1e9*e.uptime(),a=o-u):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(void 0)}).call(this,e("_process"))},{_process:300}],299:[function(_dereq_,module,exports){"use strict";function preprocess(what,how){function process(e){if(!e)return"";var t=[],n=e,r=/#[A-Za-z0-9_$]+/gi.exec(e);r&&(n=n.slice(0,r.index),e=e.slice(r.index)),n=(n=escape(n,t)).replace(/\bdefined\s*([A-Za-z0-9_$]+)/g,"defined($1)");for(var i in macros)macros[i]instanceof Function&&(n=processFunction(n,i,macros[i]));n=escape(n,t);for(var i in macros)macros[i]instanceof Function||(n=processDefinition(n,i,macros[i]));if(n=unescape(n,t),r){if(/^#def/.test(r[0]))e=define(e);else if(/^#undef/.test(r[0]))e=undefine(e);else if(/^#if/.test(r[0]))e=processIf(e);else if(/^#line/.test(r[0])){o=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__LINE__=parseInt(o[1]),e=e.slice(o.index+o[0].length)}else if(/^#version/.test(r[0])){var o=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__VERSION__=parseInt(o[1]),e=e.slice(o.index+o[0].length)}else{var a=/\n/m.exec(e);n+=e.slice(0,a.index)+"\n",e=e.slice(a.index)}return n+process(e)}return n}function processFunction(e,t,n){var r=[];e=escape(e,r);var i=paren(e,{flat:!0,brackets:"()",escape:"___"}),o=new RegExp(t+"\\s*\\(___([0-9]+)\\)","g");return i=i.map(function(e){return e.replace(o,function(e,r){var o=i[r];if((o=o.trim().length?(o=o.split(/\s*,\s*/)).map(function(e){var t=i.slice();return t[0]=e,paren.stringify(t,{flat:!0,escape:"___"})}).map(function(e){return e}):[]).length!=n.length)throw Error('macro "'+t+'" requires '+n.length+" arguments, but "+o.length+" given");return n.apply(null,o)})}),e=paren.stringify(i,{flat:!0,escape:"___"}),e=unescape(e,r)}function processDefinition(e,t,n){var r=[];return e=escape(e,r),e=e.replace(new RegExp("([^#A-Za-z0-9_$]|^)"+t+"\\s*##\\s*([A-Za-z0-9_$]*)","g"),function(e,t,r){return t+n+r}),e=e.replace(new RegExp("([A-Za-z0-9_$]*)\\s*##\\s*"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t,r){return t+n+r}),e=e.replace(new RegExp("([^#A-Za-z0-9_$]|^)"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t,r){return null==macros[n]||macros[n]instanceof Function||(n=macros[n]),t+n+r}),e=e.replace(new RegExp("#"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t){return'"'+n+'"'+t}),e=unescape(e,r)}function escape(e,t){return e=e.replace(/\/\/[^\n]*$/gm,function(e){return" ___comment"+t.push(e)}),e=e.replace(/\/\*([^\*]|[\r\n]|(\*+([^\*\/]|[\r\n])))*\*+\//g,function(e){return" ___comment"+t.push(e)}),e=e.replace(/\'[^']*\'/g,function(e){return" ___string"+t.push(e)}),e=e.replace(/\"[^"]*\"/g,function(e){return" ___string"+t.push(e)}),e=e.replace(/\`[^`]*\`/g,function(e){return" ___string"+t.push(e)})}function unescape(e,t){return t.forEach(function(t,n){e=e.replace(" ___string"+(n+1),t)}),t.forEach(function(t,n){e=e.replace(" ___comment"+(n+1),t)}),e}function define(e){var t=/#[A-Za-z]+[ ]*([A-Za-z0-9_$]*)(?:\(([^\(\)]*)\))?[ \r]*([^\n]*)$/m.exec(e);e=e.slice(t.index+t[0].length);var n=t[1],r=t[2],i=t[3];if(!n||!i)throw Error('Macro definition "'+t[0]+'" is malformed');if(null!=r){var o=function(){for(var e=i,t=0;t<r.length;t++)e=processDefinition(e,r[t],arguments[t]);return e=process(e)};r=r.trim().length?r.split(/\s*,\s*/):[],Object.defineProperty(o,"length",{value:r.length}),macros[n]=o}else macros[n]=i;return e}function undefine(e){var t=/#[A-Za-z0-9_]+[ ]*([A-Za-z0-9_$]+)/.exec(e);return delete macros[t[1]],e.slice(t.index+t[0].length)}function processIf(str){var match=balanced("#if","#endif",str);if(!match)return str;var body=match.body,post=match.post,elseBody="",matchElse;if((matchElse=/^\s*#else[^\n\r]*$/m.exec(body))&&(elseBody=body.slice(matchElse.index+matchElse[0].length),body=body.slice(0,matchElse.index)),/^def/.test(body)){body=body.slice(3);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=process(null!=macros[name]?body:elseBody)}else if(/^ndef/.test(body)){body=body.slice(4);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=process(null==macros[name]?body:elseBody)}else{for(var clauses=body.split(/^\s*#elif\s+/m),result=!1,i=0;i<clauses.length;i++){var clause=clauses[i],exprMatch=/\s*(.*)/.exec(clause),expr=exprMatch[0];clause=clause.slice(expr.length+exprMatch.index),expr=process(expr);try{result=eval(expr)}catch(e){result=!1}if(result){str=process(clause);break}}result||(str=process(elseBody))}var match=/[\n\r]/.exec(post);return match&&(post=post.slice(match.index)),str+post}var source=what+"",macros=extend({__LINE__:0,__FILE__:"_",__VERSION__:100,defined:function(e){return[].slice.call(arguments).every(function(e){return null!=macros[e]})}},how);return process(source)}var paren=_dereq_("parenthesis"),balanced=_dereq_("balanced-match"),extend=_dereq_("xtend/mutable");module.exports=preprocess},{"balanced-match":124,parenthesis:296,"xtend/mutable":313}],300:[function(e,t,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function u(){v&&m&&(v=!1,m.length?h=m.concat(h):y=-1,h.length&&f())}function f(){if(!v){var e=o(u);v=!0;for(var t=h.length;t;){for(m=h,h=[];++y<t;)m&&m[y].run();y=-1,t=h.length}m=null,v=!1,a(e)}}function c(e,t){this.fun=e,this.array=t}function s(){}var l,d,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(e){d=i}}();var m,h=[],v=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new c(e,t)),1!==h.length||v||o(f)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=s,p.addListener=s,p.once=s,p.off=s,p.removeListener=s,p.removeAllListeners=s,p.emit=s,p.prependListener=s,p.prependOnceListener=s,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],301:[function(e,t,n){(function(n){"use strict";for(var r=e("performance-now"),i="undefined"==typeof window?n:window,o=["moz","webkit"],a="AnimationFrame",u=i["request"+a],f=i["cancel"+a]||i["cancelRequest"+a],c=0;!u&&c<o.length;c++)u=i[o[c]+"Request"+a],f=i[o[c]+"Cancel"+a]||i[o[c]+"CancelRequest"+a];if(!u||!f){var s=0,l=0,d=[];u=function(e){if(0===d.length){var t=r(),n=Math.max(0,1e3/60-(t-s));s=n+t,setTimeout(function(){var e=d.slice(0);d.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(s)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return d.push({handle:++l,callback:e,cancelled:!1}),l},f=function(e){for(var t=0;t<d.length;t++)d[t].handle===e&&(d[t].cancelled=!0)}}t.exports=function(e){return u.call(i,e)},t.exports.cancel=function(){f.apply(i,arguments)},t.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=u,e.cancelAnimationFrame=f}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":298}],302:[function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return l("function"==typeof e,"regl-combine: Expecting regl constructor function."),Object.assign(function(t){return Object.assign(e(a(t)),i({},d,t))},e)}function a(e){return Object.assign(c.command(e),{context:Object.assign({},e.context,Object.create(null,i({reglOptions:{get:function(){return this[d]}}},d,{configurable:!1,enumerable:!1,writable:!1,value:function(t){var n=c.command(t[d],e);return n.context&&d in n.context&&delete n.context[d],n}})))})}function u(e){function t(t){return e(t||{})}function n(){var e={},n=0;for(var r in h)n++,e[r]=h[r],delete h[r];return n&&v.push(t(e))}function i(e){return Object.assign(h,c.command(h,e[d]||e))}for(var a=arguments.length,u=Array(a>1?a-1:0),p=1;p<a;p++)u[p-1]=arguments[p];Array.isArray(u[0])&&(u=u[0]),l("function"==typeof e,"regl-combine: Expecting regl constructor function."),l(Array.isArray(u),"regl-combine: Expecting array of regl commands."),u=function(e){function t(t){return e.splice(e.indexOf(t),1)[0]}return e.map(function(e,n){return e&&Array.isArray(e.commands)?t(e).commands:e}).reduce(function(e,t){return e.concat(t)},[])}(u),e=o(e);var m=t(),h={},v=[];return Object.assign(function(e,t){function o(e,n){return e<v.length?v[e++](n,function(){return o(e,n)}):m(n,t)}function a(e){return e>=u.length?s.wrap(n()):s.lazy(function(){var t=u[e];return"object"==(void 0===t?"undefined":f(t))?i(t):"function"==typeof t&&(d in t?i(t):(n(),v.push(t))),a(++e)})}return"function"==typeof e&&(t=e,e=null),0==v.length&&a(0).run(),m(e,function(e,t){return r(e),o(0,t)})},{commands:u,groups:v,isCombined:!0})}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=e("regl-extend"),s=e("trampa"),l=e("assert"),d="__reglOptions";t.exports=u,Object.assign(t.exports,{combine:u,wrap:o})},{assert:123,"regl-extend":303,trampa:308}],303:[function(e,t,n){"use strict";function r(e){function t(n,r,o){var a,u,f,c,s,l;for(a in r)if(r.hasOwnProperty(a))if(u=r[a],f=(o.length>0?o+".":"")+a,-1!==e.indexOf(f))n[a]=u;else if(-1!==e.indexOf(f+".*")){(c=n[a])||(c=n[a]={});for(s in u)c[s]=u[s]}else"object"===(void 0===r?"undefined":i(r))&&"object"===(void 0===u?"undefined":i(u))&&("undefined"!==(l=i(n[a]))&&"object"===l||(n[a]={}),t(n[a],u,f))}return function(){for(var e={},n=0;n<arguments.length;n++)t(e,arguments[n],"");return e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=["vert","frag","uniforms.*","attributes.*","context.*","primitive","count","offset","instances","elements","framebuffer","profile","depth.enable","depth.mask","depth.range","depth.func","blend.enable","blend.equation.rgb","blend.equation.alpha","blend.func.srcRGB","blend.func.srcAlpha","blend.func.dstRGB","blend.func.dstAlpha","blend.color","stencil.enable","stencil.mask","stencil.func","stencil.opFront","stencil.opBack","stencil.op","polygonOffset.enable","polygonOffset.offset","cull.enable","cull.face","frontFace","dither","lineWidth","colorMask","sample.enable","sample.alpha","sample.coverage.value","sample.coverage.invert","scissor.enable","scissor.box.x","scissor.box.y","scissor.box.width","scissor.box.height","viewport.x","viewport.y","viewport.width","viewport.height"],a=["data","length","usage","type"],u=["data","usage","length","primitive","type","count","offset"],f=["width","height","mag","min","wrapS","wrapT","aniso","format","type","data","mipmap","flipY","alignment","premultiplyAlpha","colorSpace","channels"],c=["format","width","height","shape","radius"],s=["width","height","color","depth","stencil","depthStencil","colorFormat","colorType","colorCount","depthTexture"],l=["radius","color","colorFormat","colorType","colorCount","depth","stencil","depthStencil"];t.exports.command=r(o),t.exports.buffer=r(a),t.exports.element=r(u),t.exports.texture=r(f),t.exports.renderbuffer=r(c),t.exports.framebuffer=r(s),t.exports.framebufferCube=r(l)},{}],304:[function(e,t,n){"use strict";t.exports=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0}},{}],305:[function(e,t,n){"use strict";function r(e,t){return e.ctrlKey==(t.ctrlKey||!1)&&e.altKey==(t.altKey||!1)&&e.shiftKey==(t.shiftKey||!1)&&e.metaKey==(t.metaKey||!1)&&e.keyCode==(t.keyCode||0)&&e.charCode==(t.charCode||0)||((e=document.createEvent("Event")).initEvent(t.type,t.bubbles,t.cancelable),e.ctrlKey=t.ctrlKey||!1,e.altKey=t.altKey||!1,e.shiftKey=t.shiftKey||!1,e.metaKey=t.metaKey||!1,e.keyCode=t.keyCode||0,e.charCode=t.charCode||0),e}var i=document||{},o=!0;try{i.createEvent("KeyEvents")}catch(e){o=!1}t.exports=i.createEvent?function(e,t){t=t||{};var n=f(e),u=n;"KeyboardEvent"===n&&o&&(n="KeyEvents",u="KeyEvent");var c=i.createEvent(n),s="init"+u,l="function"==typeof c[s]?s:"initEvent",d=a[l],p=[],m={};t.type=e;for(var h=0;h<d.length;++h){var v=t[y=d[h]];void 0===v&&(v=c[y]),m[y]=!0,p.push(v)}c[l].apply(c,p),"KeyboardEvent"===n&&(c=r(c,t));for(var y in t)m[y]||(c[y]=t[y]);return c}:function(e,t){t=t||{};var n=i.createEventObject();n.type=e;for(var r in t)void 0!==t[r]&&(n[r]=t[r]);return n};var a=e("./init.json"),u=e("./types.json"),f=function(){var e={};for(var t in u)for(var n=u[t],r=0;r<n.length;r++)e[n[r]]=t;return function(t){return e[t]||"Event"}}()},{"./init.json":306,"./types.json":307}],306:[function(e,t,n){t.exports={initEvent:["type","bubbles","cancelable"],initUIEvent:["type","bubbles","cancelable","view","detail"],initMouseEvent:["type","bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"],initMutationEvent:["type","bubbles","cancelable","relatedNode","prevValue","newValue","attrName","attrChange"],initKeyboardEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"],initKeyEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"]}},{}],307:[function(e,t,n){t.exports={MouseEvent:["click","mousedown","mouseup","mouseover","mousemove","mouseout"],KeyboardEvent:["keydown","keyup","keypress"],MutationEvent:["DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMAttrModified","DOMCharacterDataModified"],HTMLEvents:["load","unload","abort","error","select","change","submit","reset","focus","blur","resize","scroll"],UIEvent:["DOMFocusIn","DOMFocusOut","DOMActivate"]}},{}],308:[function(e,t,n){"use strict";function r(e){this.x=e}function i(e,t){f("function"==typeof t),this.tramp=e,this.cont=t}function o(e){return e instanceof r||e instanceof i}function a(e){return o(e)?e:new r(e)}function u(e,t){for(var n=(t=t||{}).debug||!1,o=t.log||console.log,a=[];;)if(n&&o("trampoline execute: stack size "+a.length),e instanceof r){if(0===a.length)return e.x;e=a[a.length-1](e.x),a.pop()}else f(e instanceof i),a.push(e.cont),e=e.tramp}var f=e("assert");r.prototype.jump=function(e){return new i(this,function(t){return a(e(t))})},i.prototype.jump=r.prototype.jump,r.prototype.run=i.prototype.run=function(e){return u(this,e)},t.exports={isTrampoline:o,wrap:a,lazy:function(e){return f("function"==typeof e,"lazy: computation should be function"),a().jump(e)}}},{assert:123}],309:[function(e,t,n){"use strict";t.exports=function(e,t,n){e.positions&&e.cells&&(n=t,t=e.cells,e=e.positions);var r=e.length?e[0].length:0,i=t.length?t[0].length:0;if(n=n||new Float32Array(t.length*i*r),3===i&&2===r)for(var o=0,a=0,u=t.length;o<u;o+=1)f=t[o],n[a++]=e[f[0]][0],n[a++]=e[f[0]][1],n[a++]=e[f[1]][0],n[a++]=e[f[1]][1],n[a++]=e[f[2]][0],n[a++]=e[f[2]][1];else if(3===i&&3===r)for(var o=0,a=0,u=t.length;o<u;o+=1)f=t[o],n[a++]=e[f[0]][0],n[a++]=e[f[0]][1],n[a++]=e[f[0]][2],n[a++]=e[f[1]][0],n[a++]=e[f[1]][1],n[a++]=e[f[1]][2],n[a++]=e[f[2]][0],n[a++]=e[f[2]][1],n[a++]=e[f[2]][2];else for(var o=0,a=0,u=t.length;o<u;o+=1)for(var f=t[o],c=0;c<f.length;c++)for(var s=f[c],l=0;l<r;l++)n[a++]=e[s][l];return n}},{}],310:[function(e,t,n){"use strict";"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],311:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(e){return e&&"object"===(void 0===e?"undefined":r(e))&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],312:[function(e,t,n){(function(t,r){"use strict";function i(e,t){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),f(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function a(e,t){return e}function u(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function f(e,t,r){if(e.customInspect&&t&&O(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return b(i)||(i=f(e,i,r)),i}var o=c(e,t);if(o)return o;var a=Object.keys(t),h=u(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),A(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return s(t);if(0===a.length){if(O(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(S(t))return e.stylize(Date.prototype.toString.call(t),"date");if(A(t))return s(t)}var y="",g=!1,x=["{","}"];if(m(t)&&(g=!0,x=["[","]"]),O(t)&&(y=" [Function"+(t.name?": "+t.name:"")+"]"),_(t)&&(y=" "+RegExp.prototype.toString.call(t)),S(t)&&(y=" "+Date.prototype.toUTCString.call(t)),A(t)&&(y=" "+s(t)),0===a.length&&(!g||0==t.length))return x[0]+y+x[1];if(r<0)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return E=g?l(e,t,r,h,a):a.map(function(n){return d(e,t,r,h,n,g)}),e.seen.pop(),p(E,y,x)}function c(e,t){if(g(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function s(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,i){for(var o=[],a=0,u=t.length;a<u;++a)M(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))}),o}function d(e,t,n,r,i,o){var a,u,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),M(r,i)||(a="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=v(n)?f(e,c.value,null):f(e,c.value,n-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),g(a)){if(o&&i.match(/^\d+$/))return u;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function p(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function m(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function v(e){return null===e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function g(e){return void 0===e}function _(e){return x(e)&&"[object RegExp]"===E(e)}function x(e){return"object"===(void 0===e?"undefined":j(e))&&null!==e}function S(e){return x(e)&&"[object Date]"===E(e)}function A(e){return x(e)&&("[object Error]"===E(e)||e instanceof Error)}function O(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function w(e){return e<10?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),I[e.getMonth()],t].join(" ")}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=/%[sdj%]/g;n.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(e).replace(T,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),u=r[n];n<o;u=r[++n])v(u)||!x(u)?a+=" "+u:a+=" "+i(u);return a},n.deprecate=function(e,i){if(g(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var R,k={};n.debuglog=function(e){if(g(R)&&(R=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!k[e])if(new RegExp("\\b"+e+"\\b","i").test(R)){var r=t.pid;k[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else k[e]=function(){};return k[e]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=m,n.isBoolean=h,n.isNull=v,n.isNullOrUndefined=function(e){return null==e},n.isNumber=y,n.isString=b,n.isSymbol=function(e){return"symbol"===(void 0===e?"undefined":j(e))},n.isUndefined=g,n.isRegExp=_,n.isObject=x,n.isDate=S,n.isError=A,n.isFunction=O,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===(void 0===e?"undefined":j(e))||void 0===e},n.isBuffer=e("./support/isBuffer");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",L(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":311,_process:300,inherits:310}],313:[function(e,t,n){"use strict";t.exports=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)r.call(n,i)&&(e[i]=n[i])}return e};var r=Object.prototype.hasOwnProperty},{}]},{},[62])(62)});
